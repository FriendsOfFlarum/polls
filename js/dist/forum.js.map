{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/polls/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/typeof.js","webpack://@fof/polls/./node_modules/@babel/runtime/regenerator/index.js","webpack://@fof/polls/webpack/bootstrap","webpack://@fof/polls/webpack/runtime/compat get default export","webpack://@fof/polls/webpack/runtime/define property getters","webpack://@fof/polls/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/polls/webpack/runtime/make namespace object","webpack://@fof/polls/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@fof/polls/./src/forum/addDiscussionBadge.tsx","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/ReplyComposer']\"","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/construct.js","webpack://@fof/polls/./src/forum/components/form/FormError.tsx","webpack://@fof/polls/./src/forum/states/PollFormState.ts","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Page']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@fof/polls/./src/forum/components/ComposePollHero.tsx","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/listItems']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/SelectDropdown']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@fof/polls/./src/forum/components/ComposePollPage.tsx","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/SubtreeRetainer']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Dropdown']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Link']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/highlight']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/utils/slidable']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/abbreviateNumber']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@fof/polls/./src/forum/components/Poll/PollOption.tsx","webpack://@fof/polls/./src/forum/components/Poll/PollOptions.tsx","webpack://@fof/polls/./src/forum/components/Poll/PollImage.tsx","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@fof/polls/./src/forum/components/ListVotersModal.tsx","webpack://@fof/polls/./src/forum/states/PollState.ts","webpack://@fof/polls/./src/forum/components/Poll/PollSubmitButton.tsx","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/string']\"","webpack://@fof/polls/./src/forum/components/Poll/PollTitle.tsx","webpack://@fof/polls/./src/forum/components/Poll/PollSubtitle.tsx","webpack://@fof/polls/./src/forum/components/PollView.tsx","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://@fof/polls/./src/forum/components/PollPageHero.tsx","webpack://@fof/polls/./src/forum/components/AbstractPollPage.tsx","webpack://@fof/polls/./src/forum/components/PollViewPage.tsx","webpack://@fof/polls/./src/forum/components/Poll/PollListItem.tsx","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Placeholder']\"","webpack://@fof/polls/./src/forum/components/Poll/PollList.tsx","webpack://@fof/polls/external root \"flarum.core.compat['common/states/PaginatedListState']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/EventEmitter']\"","webpack://@fof/polls/./src/forum/states/PollListState.ts","webpack://@fof/polls/./src/forum/components/PollsPage.tsx","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Separator']\"","webpack://@fof/polls/./src/forum/utils/PollControls.tsx","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/polls/./src/forum/components/UploadPollImageButton.tsx","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/RequestError']\"","webpack://@fof/polls/./src/forum/components/PollForm.tsx","webpack://@fof/polls/./src/forum/components/CreatePollModal.tsx","webpack://@fof/polls/./src/forum/addComposerItems.tsx","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@fof/polls/./src/forum/components/EditPollModal.tsx","webpack://@fof/polls/./src/forum/components/PostPoll.tsx","webpack://@fof/polls/./src/forum/addPollsToPost.tsx","webpack://@fof/polls/external root \"flarum.core.compat['forum/utils/PostControls']\"","webpack://@fof/polls/./src/forum/components/PollShowcaseItem.tsx","webpack://@fof/polls/./src/forum/components/PollShowcase.tsx","webpack://@fof/polls/./src/forum/components/PollsShowcasePage.tsx","webpack://@fof/polls/./src/forum/components/index.ts","webpack://@fof/polls/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/computed']\"","webpack://@fof/polls/./src/forum/models/Poll.ts","webpack://@fof/polls/./src/forum/models/PollOption.ts","webpack://@fof/polls/./src/forum/models/PollVote.ts","webpack://@fof/polls/./src/forum/models/index.ts","webpack://@fof/polls/./src/forum/states/index.ts","webpack://@fof/polls/./src/forum/utils/index.ts","webpack://@fof/polls/external root \"flarum.core.compat['common/extenders']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Post']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Forum']\"","webpack://@fof/polls/./src/forum/extend.ts","webpack://@fof/polls/./src/forum/index.ts","webpack://@fof/polls/./src/forum/addPostControls.tsx","webpack://@fof/polls/./src/forum/addNavItem.ts"],"sourcesContent":["var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return e;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var t,\n    e = {},\n    r = Object.prototype,\n    n = r.hasOwnProperty,\n    o = Object.defineProperty || function (t, e, r) {\n      t[e] = r.value;\n    },\n    i = \"function\" == typeof Symbol ? Symbol : {},\n    a = i.iterator || \"@@iterator\",\n    c = i.asyncIterator || \"@@asyncIterator\",\n    u = i.toStringTag || \"@@toStringTag\";\n  function define(t, e, r) {\n    return Object.defineProperty(t, e, {\n      value: r,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), t[e];\n  }\n  try {\n    define({}, \"\");\n  } catch (t) {\n    define = function define(t, e, r) {\n      return t[e] = r;\n    };\n  }\n  function wrap(t, e, r, n) {\n    var i = e && e.prototype instanceof Generator ? e : Generator,\n      a = Object.create(i.prototype),\n      c = new Context(n || []);\n    return o(a, \"_invoke\", {\n      value: makeInvokeMethod(t, r, c)\n    }), a;\n  }\n  function tryCatch(t, e, r) {\n    try {\n      return {\n        type: \"normal\",\n        arg: t.call(e, r)\n      };\n    } catch (t) {\n      return {\n        type: \"throw\",\n        arg: t\n      };\n    }\n  }\n  e.wrap = wrap;\n  var h = \"suspendedStart\",\n    l = \"suspendedYield\",\n    f = \"executing\",\n    s = \"completed\",\n    y = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var p = {};\n  define(p, a, function () {\n    return this;\n  });\n  var d = Object.getPrototypeOf,\n    v = d && d(d(values([])));\n  v && v !== r && n.call(v, a) && (p = v);\n  var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p);\n  function defineIteratorMethods(t) {\n    [\"next\", \"throw\", \"return\"].forEach(function (e) {\n      define(t, e, function (t) {\n        return this._invoke(e, t);\n      });\n    });\n  }\n  function AsyncIterator(t, e) {\n    function invoke(r, o, i, a) {\n      var c = tryCatch(t[r], t, o);\n      if (\"throw\" !== c.type) {\n        var u = c.arg,\n          h = u.value;\n        return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) {\n          invoke(\"next\", t, i, a);\n        }, function (t) {\n          invoke(\"throw\", t, i, a);\n        }) : e.resolve(h).then(function (t) {\n          u.value = t, i(u);\n        }, function (t) {\n          return invoke(\"throw\", t, i, a);\n        });\n      }\n      a(c.arg);\n    }\n    var r;\n    o(this, \"_invoke\", {\n      value: function value(t, n) {\n        function callInvokeWithMethodAndArg() {\n          return new e(function (e, r) {\n            invoke(t, n, e, r);\n          });\n        }\n        return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(e, r, n) {\n    var o = h;\n    return function (i, a) {\n      if (o === f) throw Error(\"Generator is already running\");\n      if (o === s) {\n        if (\"throw\" === i) throw a;\n        return {\n          value: t,\n          done: !0\n        };\n      }\n      for (n.method = i, n.arg = a;;) {\n        var c = n.delegate;\n        if (c) {\n          var u = maybeInvokeDelegate(c, n);\n          if (u) {\n            if (u === y) continue;\n            return u;\n          }\n        }\n        if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) {\n          if (o === h) throw o = s, n.arg;\n          n.dispatchException(n.arg);\n        } else \"return\" === n.method && n.abrupt(\"return\", n.arg);\n        o = f;\n        var p = tryCatch(e, r, n);\n        if (\"normal\" === p.type) {\n          if (o = n.done ? s : l, p.arg === y) continue;\n          return {\n            value: p.arg,\n            done: n.done\n          };\n        }\n        \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(e, r) {\n    var n = r.method,\n      o = e.iterator[n];\n    if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y;\n    var i = tryCatch(o, e.iterator, r.arg);\n    if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y;\n    var a = i.arg;\n    return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y);\n  }\n  function pushTryEntry(t) {\n    var e = {\n      tryLoc: t[0]\n    };\n    1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e);\n  }\n  function resetTryEntry(t) {\n    var e = t.completion || {};\n    e.type = \"normal\", delete e.arg, t.completion = e;\n  }\n  function Context(t) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], t.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(e) {\n    if (e || \"\" === e) {\n      var r = e[a];\n      if (r) return r.call(e);\n      if (\"function\" == typeof e.next) return e;\n      if (!isNaN(e.length)) {\n        var o = -1,\n          i = function next() {\n            for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next;\n            return next.value = t, next.done = !0, next;\n          };\n        return i.next = i;\n      }\n    }\n    throw new TypeError(_typeof(e) + \" is not iterable\");\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), o(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) {\n    var e = \"function\" == typeof t && t.constructor;\n    return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name));\n  }, e.mark = function (t) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t;\n  }, e.awrap = function (t) {\n    return {\n      __await: t\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () {\n    return this;\n  }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) {\n    void 0 === i && (i = Promise);\n    var a = new AsyncIterator(wrap(t, r, n, o), i);\n    return e.isGeneratorFunction(r) ? a : a.next().then(function (t) {\n      return t.done ? t.value : a.next();\n    });\n  }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () {\n    return this;\n  }), define(g, \"toString\", function () {\n    return \"[object Generator]\";\n  }), e.keys = function (t) {\n    var e = Object(t),\n      r = [];\n    for (var n in e) r.push(n);\n    return r.reverse(), function next() {\n      for (; r.length;) {\n        var t = r.pop();\n        if (t in e) return next.value = t, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, e.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(e) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var t = this.tryEntries[0].completion;\n      if (\"throw\" === t.type) throw t.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(e) {\n      if (this.done) throw e;\n      var r = this;\n      function handle(n, o) {\n        return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o;\n      }\n      for (var o = this.tryEntries.length - 1; o >= 0; --o) {\n        var i = this.tryEntries[o],\n          a = i.completion;\n        if (\"root\" === i.tryLoc) return handle(\"end\");\n        if (i.tryLoc <= this.prev) {\n          var c = n.call(i, \"catchLoc\"),\n            u = n.call(i, \"finallyLoc\");\n          if (c && u) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          } else if (c) {\n            if (this.prev < i.catchLoc) return handle(i.catchLoc, !0);\n          } else {\n            if (!u) throw Error(\"try statement without catch or finally\");\n            if (this.prev < i.finallyLoc) return handle(i.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(t, e) {\n      for (var r = this.tryEntries.length - 1; r >= 0; --r) {\n        var o = this.tryEntries[r];\n        if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) {\n          var i = o;\n          break;\n        }\n      }\n      i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null);\n      var a = i ? i.completion : {};\n      return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a);\n    },\n    complete: function complete(t, e) {\n      if (\"throw\" === t.type) throw t.arg;\n      return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y;\n    },\n    finish: function finish(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y;\n      }\n    },\n    \"catch\": function _catch(t) {\n      for (var e = this.tryEntries.length - 1; e >= 0; --e) {\n        var r = this.tryEntries[e];\n        if (r.tryLoc === t) {\n          var n = r.completion;\n          if (\"throw\" === n.type) {\n            var o = n.arg;\n            resetTryEntry(r);\n          }\n          return o;\n        }\n      }\n      throw Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(e, r, n) {\n      return this.delegate = {\n        iterator: values(e),\n        resultName: r,\n        nextLoc: n\n      }, \"next\" === this.method && (this.arg = t), y;\n    }\n  }, e;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport Badge from 'flarum/common/components/Badge';\nimport DiscussionList from 'flarum/forum/components/DiscussionList';\nimport Discussion from 'flarum/common/models/Discussion';\nimport { PaginatedListRequestParams } from 'flarum/common/states/PaginatedListState';\n\nexport default () => {\n  // @ts-ignore\n  extend(DiscussionList.prototype, 'requestParams', (params: PaginatedListRequestParams) => {\n    (params.include as string[]).push('poll');\n  });\n\n  extend(Discussion.prototype, 'badges', function (badges) {\n    // @ts-ignore\n    if (this.hasPoll()) {\n      badges.add(\n        'poll',\n        Badge.component({\n          type: 'poll',\n          label: app.translator.trans('fof-polls.forum.tooltip.badge'),\n          icon: 'fas fa-poll',\n        }),\n        5\n      );\n    }\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ReplyComposer'];","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nexport { _asyncToGenerator as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","function _getPrototypeOf(t) {\n  return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, _getPrototypeOf(t);\n}\nexport { _getPrototypeOf as default };","function _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (_isNativeReflectConstruct = function _isNativeReflectConstruct() {\n    return !!t;\n  })();\n}\nexport { _isNativeReflectConstruct as default };","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeFunction from \"./isNativeFunction.js\";\nimport construct from \"./construct.js\";\nfunction _wrapNativeSuper(t) {\n  var r = \"function\" == typeof Map ? new Map() : void 0;\n  return _wrapNativeSuper = function _wrapNativeSuper(t) {\n    if (null === t || !isNativeFunction(t)) return t;\n    if (\"function\" != typeof t) throw new TypeError(\"Super expression must either be null or a function\");\n    if (void 0 !== r) {\n      if (r.has(t)) return r.get(t);\n      r.set(t, Wrapper);\n    }\n    function Wrapper() {\n      return construct(t, arguments, getPrototypeOf(this).constructor);\n    }\n    return Wrapper.prototype = Object.create(t.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    }), setPrototypeOf(Wrapper, t);\n  }, _wrapNativeSuper(t);\n}\nexport { _wrapNativeSuper as default };","function _isNativeFunction(t) {\n  try {\n    return -1 !== Function.toString.call(t).indexOf(\"[native code]\");\n  } catch (n) {\n    return \"function\" == typeof t;\n  }\n}\nexport { _isNativeFunction as default };","import isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nimport setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _construct(t, e, r) {\n  if (isNativeReflectConstruct()) return Reflect.construct.apply(null, arguments);\n  var o = [null];\n  o.push.apply(o, e);\n  var p = new (t.bind.apply(t, o))();\n  return r && setPrototypeOf(p, r.prototype), p;\n}\nexport { _construct as default };","import { NestedStringArray } from '@askvortsov/rich-icu-message-formatter';\n\nexport default class FormError extends Error {\n  constructor(props: NestedStringArray | string) {\n    super(props + '');\n  }\n}\n","import app from 'flarum/forum/app';\nimport Poll from '../models/Poll';\nimport PollOption from '../models/PollOption';\n\nexport default class PollFormState {\n  poll: Poll;\n  loading: boolean;\n  deleting: boolean;\n  expandedGroup: string;\n\n  static createNewPoll() {\n    const poll = app.store.createRecord<Poll>('polls');\n\n    poll.pushAttributes({\n      question: '',\n      endDate: '',\n      publicPoll: false,\n      allowMultipleVotes: false,\n      hideVotes: false,\n      allowChangeVote: false,\n      maxVotes: 0,\n    });\n\n    poll.tempOptions = [app.store.createRecord<PollOption>('poll_options'), app.store.createRecord<PollOption>('poll_options')];\n\n    return poll;\n  }\n\n  constructor(poll: Poll) {\n    if (!poll) {\n      poll = PollFormState.createNewPoll();\n    }\n\n    this.loading = false;\n    this.deleting = false;\n    this.poll = poll;\n    this.expandedGroup = 'setup';\n  }\n\n  isExpanded(groupKey: string) {\n    return this.expandedGroup === groupKey;\n  }\n\n  expand(groupKey: string) {\n    this.expandedGroup = groupKey;\n    m.redraw();\n  }\n\n  async save(data: any) {\n    this.loading = true;\n    m.redraw();\n\n    try {\n      this.poll = await this.poll.save(data);\n      /**\n       * Cleanup attributes:\n       * For the saving process, we add the options directly to the attributes.\n       * As we currently cannot add new PollOptions as relationships.\n       */\n      delete this.poll!.data!.attributes!.options;\n    } finally {\n      this.loading = false;\n      m.redraw();\n    }\n  }\n\n  async delete() {\n    this.loading = true;\n    m.redraw();\n\n    try {\n      await this.poll.delete();\n      this.deleting = true;\n    } finally {\n      this.loading = false;\n      m.redraw();\n    }\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","import Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport Poll from '../models/Poll';\nimport ItemList from 'flarum/common/utils/ItemList';\n\nexport interface ComposePollHeroAttrs extends ComponentAttrs {\n  poll: Poll;\n}\n\nexport default class ComposePollHero extends Component<ComposePollHeroAttrs> {\n  poll!: Poll;\n\n  oninit(vnode: Mithril.Vnode<ComposePollHeroAttrs>): void {\n    super.oninit(vnode);\n\n    this.poll = this.attrs.poll;\n  }\n\n  view(): Mithril.Children {\n    return (\n      <div className=\"ComposePollHero Hero\">\n        <div className=\"container\">\n          <div className=\"containerNarrow\">\n            <h2 className=\"Hero-title\">{app.translator.trans(`fof-polls.forum.compose.${!!this.poll.id() ? 'edit' : 'add'}_title`)}</h2>\n            <div className=\"ComposePollHero-controls\">{this.controlItems().toArray()}</div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  controlItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'edit',\n      <LinkButton\n        icon=\"far fa-edit\"\n        className=\"Button Button--secondary GlobalPollListLink\"\n        itemClassName=\"App-primaryControl\"\n        href={app.route('fof.polls.list')}\n      >\n        {app.translator.trans('fof-polls.forum.compose.polls_manager')}\n      </LinkButton>\n    );\n\n    if (this.poll.exists) {\n      items.add(\n        'view',\n        <LinkButton\n          icon=\"far fa-arrow-up-right-from-square\"\n          className=\"Button Button--secondary PollPreviewLink\"\n          itemClassName=\"App-primaryControl\"\n          href={app.route('fof.polls.view', { id: this.poll.id() })}\n        >\n          {app.translator.trans('fof-polls.forum.compose.polls_preview')}\n        </LinkButton>\n      );\n    }\n\n    return items;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/listItems'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/SelectDropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","import type Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport Poll from '../models/Poll';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport PollForm from './PollForm';\nimport PollFormState from '../states/PollFormState';\nimport ComposePollHero from './ComposePollHero';\nimport Button from 'flarum/common/components/Button';\nimport listItems from 'flarum/common/helpers/listItems';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport SelectDropdown from 'flarum/common/components/SelectDropdown';\nimport IndexPage from 'flarum/forum/components/IndexPage';\n\nexport default class ComposePollPage extends Page {\n  poll: Poll | null | undefined = null;\n\n  loading: boolean = false;\n\n  oninit(vnode: Mithril.Vnode) {\n    super.oninit(vnode);\n\n    // prevent users from accessing the page if they can't start global polls or if they are disabled altogether\n    if (!app.forum.attribute<boolean>('globalPollsEnabled') || !app.forum.attribute<boolean>('canStartGlobalPolls')) {\n      m.route.set('/');\n      return;\n    }\n\n    this.bodyClass = 'App--compose-poll';\n\n    // Get the `edit` parameter from the URL\n    const editId = m.route.param('id');\n\n    // either load the poll we're editing or create a new one\n    const pollPromise = editId ? this.loadEditingPoll(editId) : Promise.resolve(PollFormState.createNewPoll());\n\n    pollPromise.then((poll: Poll | null | undefined) => {\n      this.poll = poll;\n\n      if (poll?.exists && !poll.canEdit()) {\n        m.route.set('/');\n        return;\n      }\n\n      app.history.push('compose-poll', app.translator.trans(`fof-polls.forum.compose.${!!this.poll?.id() ? 'edit' : 'add'}_title`) as string);\n      app.setTitle(app.translator.trans(`fof-polls.forum.compose.${!!this.poll?.id() ? 'edit' : 'add'}_title`) as string);\n\n      m.redraw();\n    });\n  }\n\n  async loadEditingPoll(editId: string) {\n    const alreadyLoaded = app.store.getById<Poll>('poll', editId);\n\n    if (alreadyLoaded) return alreadyLoaded;\n\n    this.loading = true;\n\n    const poll = await app.store.find<Poll>('fof/polls', editId);\n\n    this.loading = false;\n\n    return poll;\n  }\n\n  view(): Mithril.Children {\n    if (this.loading || !this.poll) {\n      return <LoadingIndicator />;\n    }\n\n    return (\n      <div className=\"ComposePollPage\">\n        <ComposePollHero poll={this.poll} />\n        <div className=\"container\">\n          <div className=\"sideNavContainer\">\n            <nav className=\"PollsPage-nav sideNav\">\n              <ul>{listItems(this.sidebarItems().toArray())}</ul>\n            </nav>\n            <div className=\"sideNavOffset\">\n              <PollForm poll={this.poll} onsubmit={this.onsubmit.bind(this)} />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  async onsubmit(data: Object, state: PollFormState) {\n    const isNew = state.poll.id() === undefined;\n    await state.save(data);\n\n    const alertAttrs = isNew\n      ? {\n          type: 'success',\n          controls: [\n            <Button\n              className=\"Button Button--link\"\n              onclick={() =>\n                m.route.set(\n                  app.route('fof.polls.compose', {\n                    id: state.poll.id(),\n                  })\n                )\n              }\n            >\n              {app.translator.trans('fof-polls.forum.compose.continue_editing')}\n            </Button>,\n          ],\n        }\n      : {\n          type: 'success',\n        };\n\n    // Show success alert\n    const alertId = app.alerts.show(alertAttrs, app.translator.trans('fof-polls.forum.compose.success'));\n\n    // Hide alert after 10 seconds\n    setTimeout(() => app.alerts.dismiss(alertId), 10000);\n\n    if (isNew) {\n      m.route.set(app.route('fof.polls.list'));\n    }\n  }\n\n  sidebarItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'nav',\n      <SelectDropdown\n        buttonClassName=\"Button\"\n        className=\"App-titleControl\"\n        accessibleToggleLabel={app.translator.trans('core.forum.index.toggle_sidenav_dropdown_accessible_label')}\n      >\n        {this.navItems().toArray()}\n      </SelectDropdown>\n    );\n\n    return items;\n  }\n\n  navItems() {\n    return IndexPage.prototype.navItems();\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/SubtreeRetainer'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Dropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/highlight'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/slidable'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/abbreviateNumber'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","import app from 'flarum/forum/app';\nimport Mithril from 'mithril';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport PollOptionModel from '../../models/PollOption';\nimport PollState from '../../states/PollState';\nimport Tooltip, { TooltipAttrs } from 'flarum/common/components/Tooltip';\nimport icon from 'flarum/common/helpers/icon';\nimport classList from 'flarum/common/utils/classList';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Poll from '../../models/Poll';\n\ninterface PollOptionAttrs extends ComponentAttrs {\n  option: PollOptionModel;\n  name: string;\n  state: PollState;\n}\n\nexport default class PollOption extends Component<PollOptionAttrs, PollState> {\n  option!: PollOptionModel;\n  name!: string;\n  state!: PollState;\n  hasVoted: boolean = false;\n  totalVotes: number = 0;\n  votes: number = 0;\n  voted: boolean = false;\n  poll!: Poll;\n  canSeeVoteCount: boolean = false;\n  answer!: string;\n\n  oninit(vnode: Mithril.Vnode<PollOptionAttrs, PollState>) {\n    super.oninit(vnode);\n    this.option = this.attrs.option;\n    this.name = this.attrs.name;\n    this.state = this.attrs.state;\n    this.poll = this.state.poll;\n\n    // isNaN(null) is false, so we have to check type directly now that API always returns the field\n    this.canSeeVoteCount = typeof this.votes === 'number';\n\n    this.answer = this.option.answer();\n  }\n\n  percent(): number {\n    return this.totalVotes > 0 ? Math.round((this.votes / this.totalVotes) * 100) : 0;\n  }\n\n  view(): Mithril.Children {\n    // following values can be changed by ui interactions, so we need to update them on every render\n    this.hasVoted = this.state.hasVoted();\n    this.totalVotes = this.state.overallVoteCount();\n    this.votes = this.option.voteCount();\n    this.voted = this.state.hasVotedFor(this.option);\n\n    const isDisabled = this.state.loadingOptions || (this.hasVoted && !this.poll.canChangeVote());\n    const width = this.canSeeVoteCount ? this.percent() : (Number(this.voted) / (this.poll.myVotes()?.length || 1)) * 100;\n\n    const bar = (\n      <label className=\"PollBar\" data-selected={!!this.voted} style={`--poll-option-width: ${width}%`}>\n        {this.state.showCheckMarks && (\n          <div className=\"PollAnswer-checkbox\">\n            <input\n              className=\"PollAnswer-input sr-only\"\n              type=\"checkbox\"\n              id={this.option.id()}\n              name={this.name}\n              value={this.answer}\n              checked={this.voted}\n              disabled={isDisabled}\n              aria-labelledby={`${this.name}-${this.option.id()}-label`}\n              onchange={this.state.changeVote.bind(this.state, this.option)}\n            />\n            <span className=\"checkmark\" />\n          </div>\n        )}\n\n        <div className=\"PollAnswer-text\">{this.optionDisplayItems().toArray()}</div>\n\n        {this.option.imageUrl() ? <img className=\"PollAnswer-image\" src={this.option.imageUrl()} alt={this.option.answer()} loading=\"lazy\" /> : null}\n      </label>\n    );\n\n    return (\n      <div\n        className={classList('PollOption', this.hasVoted && 'PollVoted', this.option.imageUrl() && 'PollOption-hasImage')}\n        data-id={this.option.id()}\n      >\n        {this.canSeeVoteCount ? (\n          <Tooltip text={app.translator.trans('fof-polls.forum.tooltip.votes', { count: this.votes })} onremove={this.hideOptionTooltip}>\n            {bar}\n          </Tooltip>\n        ) : (\n          bar\n        )}\n      </div>\n    );\n  }\n\n  /**\n   * Attempting to use the `tooltipVisible` attr on the Tooltip component set to 'false' when no vote count\n   * caused the tooltip to break on click. This is a workaround to hide the tooltip when no vote count is available,\n   * called on 'onremove' of the Tooltip component. It doesn't always work as intended either, but it does the job.\n   */\n  hideOptionTooltip(vnode: Mithril.Vnode<TooltipAttrs, Tooltip>) {\n    vnode.attrs.tooltipVisible = false;\n\n    // @ts-ignore\n    vnode.state.updateVisibility();\n  }\n\n  optionDisplayItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'answer',\n      <span className=\"PollAnswer-text-answer\" id={`${this.name}-${this.option.id()}-label`}>\n        {this.answer}\n      </span>\n    );\n\n    this.voted && !this.state.showCheckMarks && items.add('check', icon('fas fa-check-circle', { className: 'PollAnswer-check' }));\n\n    this.canSeeVoteCount &&\n      items.add('percent', <span className={classList('PollPercent', this.percent() !== 100 && 'PollPercent--option')}>{this.percent()}%</span>);\n\n    return items;\n  }\n}\n","import type Mithril from 'mithril';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport PollOption from './PollOption';\nimport PollOptionModel from '../../models/PollOption';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport PollState from '../../states/PollState';\n\ninterface PollOptionsAttrs extends ComponentAttrs {\n  options: PollOptionModel[];\n  name: String;\n  state: PollState;\n}\n\nexport default class PollOptions extends Component<PollOptionsAttrs> {\n  view(): Mithril.Children {\n    return <div className=\"Poll-options list-layout\">{this.pollOptions().toArray()}</div>;\n  }\n\n  pollOptions(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    this.attrs.options.forEach((option: PollOptionModel): void => {\n      items.add('option' + option.id(), this.createOptionView(option));\n    });\n\n    return items;\n  }\n\n  createOptionView(option: PollOptionModel): Mithril.Children {\n    return <PollOption name={this.attrs.name} option={option} state={this.attrs.state} />;\n  }\n}\n","import type Mithril from 'mithril';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport Poll from 'src/forum/models/Poll';\nimport ItemList from 'flarum/common/utils/ItemList';\n\ninterface PollImageAttrs extends ComponentAttrs {\n  poll: Poll;\n}\n\nexport default class PollImage extends Component<PollImageAttrs> {\n  imageUrl: string | null = null;\n  imageAlt: string | null = null;\n\n  oninit(vnode: Mithril.Vnode<PollImageAttrs, this>) {\n    super.oninit(vnode);\n\n    this.imageUrl = this.attrs.poll.imageUrl();\n    this.imageAlt = this.attrs.poll.imageAlt();\n  }\n\n  view(): Mithril.Children {\n    if (!this.imageUrl) {\n      return;\n    }\n\n    return <div className=\"PollImage\">{this.imageItems().toArray()}</div>;\n  }\n\n  imageItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add('image', <img src={this.imageUrl} alt={this.imageAlt ?? ''} className=\"PollImage-image\" loading=\"lazy\" />);\n\n    return items;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","import type Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport Modal, { IInternalModalAttrs } from 'flarum/common/components/Modal';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport Link from 'flarum/common/components/Link';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport PollModel from '../models/Poll';\nimport PollVote from '../models/PollVote';\nimport User from 'flarum/common/models/User';\nimport PollOption from '../models/PollOption';\n\ninterface ListVotersModalAttrs extends IInternalModalAttrs {\n  poll: PollModel;\n  onsubmit: (data: object) => Promise<void>;\n}\n\nexport default class ListVotersModal extends Modal<ListVotersModalAttrs> {\n  oninit(vnode: Mithril.Vnode): void {\n    super.oninit(vnode);\n\n    this.loading = true;\n\n    app.store\n      .find('fof/polls', this.attrs.poll.id()!, {\n        include: 'votes,votes.user,votes.option',\n      })\n      .then(() => (this.loading = false))\n      .finally(() => m.redraw());\n  }\n\n  className(): string {\n    return 'Modal--medium VotesModal';\n  }\n\n  title(): Mithril.Children {\n    return app.translator.trans('fof-polls.forum.votes_modal.title');\n  }\n\n  content(): Mithril.Children {\n    const options = this.attrs.poll.options() as PollOption[];\n    return <div className=\"Modal-body\">{this.loading ? <LoadingIndicator /> : options.map(this.optionContent.bind(this))}</div>;\n  }\n\n  optionContent(opt: PollOption): Mithril.Children {\n    const votes = (this.attrs.poll.votes() || []).filter((v) => opt.id() === v!.option()!.id()) as PollVote[];\n\n    return (\n      <div className=\"VotesModal-option\">\n        <h3>{this.optionAnswer(opt)! + ':'}</h3>\n\n        {votes.length ? (\n          <div className=\"VotesModal-list\">{votes.map(this.voteContent.bind(this))}</div>\n        ) : (\n          <h4>{app.translator.trans('fof-polls.forum.modal.no_voters')}</h4>\n        )}\n      </div>\n    );\n  }\n\n  optionAnswer(opt: PollOption): string {\n    return opt.answer();\n  }\n\n  voteContent(vote: PollVote): Mithril.Children {\n    const user = vote.user() as User;\n    const attrs = user && { href: app.route.user(user) };\n\n    return (\n      <Link {...attrs}>\n        {avatar(user)} {username(user)}\n      </Link>\n    );\n  }\n}\n","import app from 'flarum/forum/app';\nimport Poll from '../models/Poll';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport PollOption from '../models/PollOption';\nimport PollVote from '../models/PollVote';\nimport ListVotersModal from '../components/ListVotersModal';\nimport { ApiPayloadSingle } from 'flarum/common/Store';\n\nexport default class PollState {\n  public poll: Poll;\n  protected pendingSubmit: boolean = false;\n  protected pendingOptions: Set<string> | null = null;\n  public loadingOptions: boolean = false;\n  public useSubmitUI: boolean;\n  public showCheckMarks: boolean;\n  public canSeeVoteCount: boolean;\n\n  constructor(poll: Poll) {\n    this.poll = poll;\n    this.useSubmitUI = !poll?.canChangeVote() && poll?.allowMultipleVotes();\n    this.showCheckMarks = !app.session.user || (!poll.hasEnded() && poll.canVote() && (!this.hasVoted() || poll.canChangeVote()));\n    this.canSeeVoteCount = typeof poll.voteCount() === 'number';\n    this.init();\n  }\n\n  /**\n   * used as en extendable entry point for init customizations\n   */\n  init(): void {}\n\n  isShowResult(): boolean {\n    return this.poll.hasEnded() || (this.canSeeVoteCount && !!app.session.user && this.hasVoted());\n  }\n\n  hasVoted(): boolean {\n    return this.poll.myVotes().length > 0;\n  }\n\n  overallVoteCount(): number {\n    return this.poll.voteCount();\n  }\n\n  hasVotedFor(option: PollOption): boolean {\n    return this.pendingOptions ? this.pendingOptions.has(option.id()!) : this.poll.myVotes().some((vote: PollVote) => vote.option() === option);\n  }\n\n  getMaxVotes(): number {\n    const poll = this.poll;\n    let maxVotes = poll.allowMultipleVotes() ? poll.maxVotes() : 1;\n    if (maxVotes === 0) maxVotes = poll.options().length;\n    return maxVotes;\n  }\n\n  showButton(): boolean {\n    return this.useSubmitUI && this.pendingSubmit;\n  }\n\n  changeVote(option: PollOption, evt: Event): void {\n    const target = evt.target as HTMLInputElement;\n\n    if (!app.session.user) {\n      app.modal.show(LogInModal);\n      target.checked = false;\n      return;\n    }\n\n    const optionIds = this.pendingOptions || new Set(this.poll.myVotes().map((v: PollVote) => v.option()!.id()!));\n    const isUnvoting = optionIds.delete(option.id()!);\n    const allowsMultiple = this.poll.allowMultipleVotes();\n\n    if (!allowsMultiple) {\n      optionIds.clear();\n    }\n\n    if (!isUnvoting) {\n      optionIds.add(option.id()!);\n    }\n\n    this.pendingOptions = optionIds.size ? optionIds : null;\n    this.pendingSubmit = !!this.pendingOptions;\n\n    if (this.useSubmitUI) {\n      this.pendingOptions = optionIds.size ? optionIds : null;\n      this.pendingSubmit = !!this.pendingOptions;\n      m.redraw();\n      return;\n    }\n\n    this.submit(optionIds, null, () => (target.checked = isUnvoting));\n  }\n\n  hasSelectedOptions(): boolean {\n    return this.pendingSubmit;\n  }\n\n  onsubmit(): Promise<void> {\n    return this.submit(this.pendingOptions!, () => {\n      this.pendingOptions = null;\n      this.pendingSubmit = false;\n    });\n  }\n\n  submit(optionIds: Set<string>, cb: Function | null, onerror: Function | null = null) {\n    this.loadingOptions = true;\n    m.redraw();\n\n    return app\n      .request<ApiPayloadSingle>({\n        method: 'PATCH',\n        url: `${app.forum.attribute('apiUrl')}/fof/polls/${this.poll.id()}/votes`,\n        body: {\n          data: {\n            optionIds: Array.from(optionIds),\n          },\n        },\n      })\n      .then((res: ApiPayloadSingle) => {\n        app.store.pushPayload(res);\n        cb?.();\n      })\n      .catch((err) => {\n        onerror?.(err);\n      })\n      .finally(() => {\n        this.loadingOptions = false;\n        this.canSeeVoteCount = typeof this.poll.voteCount() === 'number';\n        m.redraw();\n      });\n  }\n\n  showVoters = () => {\n    // Load all the votes only when opening the votes list\n    app.modal.show(ListVotersModal, {\n      poll: this.poll,\n    });\n  };\n}\n","import type Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport PollState from '../../states/PollState';\n\ninterface PollSubmitButtonAttrs extends ComponentAttrs {\n  state: PollState;\n}\n\nexport default class PollSubmitButton extends Component<PollSubmitButtonAttrs> {\n  view(): Mithril.Children {\n    const state = this.attrs.state;\n    return (\n      <Button\n        className=\"Button Button--primary Poll-submit\"\n        loading={state.loadingOptions}\n        onclick={(event: Event) => this.pollButtonSubmit(state, event)}\n        disabled={!state.hasSelectedOptions()}\n      >\n        {app.translator.trans('fof-polls.forum.poll.submit_button')}\n      </Button>\n    );\n  }\n\n  /**\n   * Event handler for submit button being clicked\n   */\n\n  pollButtonSubmit(state: PollState, event: Event): void {\n    state.onsubmit();\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/string'];","import Component, { ComponentAttrs } from 'flarum/common/Component';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Poll from 'src/forum/models/Poll';\nimport Mithril from 'mithril';\n\nexport interface PollTitleAttrs extends ComponentAttrs {\n  poll: Poll;\n}\n\nexport default class PollTitle extends Component<PollTitleAttrs> {\n  view() {\n    return <div className=\"Poll-title-component\">{this.pollTitleItems().toArray()}</div>;\n  }\n\n  pollTitleItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add('title', <h3 className=\"Poll-title\">{this.attrs.poll.question()}</h3>);\n\n    return items;\n  }\n}\n","import Component, { ComponentAttrs } from 'flarum/common/Component';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Poll from 'src/forum/models/Poll';\nimport Mithril from 'mithril';\n\nexport interface PollSubtitleAttrs extends ComponentAttrs {\n  poll: Poll;\n}\n\nexport default class PollSubtitle extends Component<PollSubtitleAttrs> {\n  view() {\n    if (!this.attrs.poll.subtitle()) {\n      return;\n    }\n\n    return <div className=\"Poll-subtitle-component\">{this.pollSubtitleItems().toArray()}</div>;\n  }\n\n  pollSubtitleItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add('subtitle', <p className=\"Poll-subtitle\">{this.attrs.poll.subtitle()}</p>);\n\n    return items;\n  }\n}\n","import Mithril from 'mithril';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport app from 'flarum/forum/app';\nimport PollOptions from './Poll/PollOptions';\nimport PollImage from './Poll/PollImage';\nimport PollModel from '../models/Poll';\nimport PollState from '../states/PollState';\nimport Button from 'flarum/common/components/Button';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport PollControls from '../utils/PollControls';\nimport Dropdown from 'flarum/common/components/Dropdown';\nimport PollSubmitButton from './Poll/PollSubmitButton';\nimport { slug } from 'flarum/common/utils/string';\nimport classList from 'flarum/common/utils/classList';\nimport PollTitle from './Poll/PollTitle';\nimport PollSubtitle from './Poll/PollSubtitle';\n\ninterface PollAttrs extends ComponentAttrs {\n  poll: PollModel;\n}\n\nexport default class PollView extends Component<PollAttrs, PollState> {\n  state!: PollState;\n\n  oninit(vnode: Mithril.Vnode<PollAttrs, this>) {\n    super.oninit(vnode);\n    this.state = new PollState(this.attrs.poll);\n  }\n\n  oncreate(vnode: Mithril.Vnode<PollAttrs, this>) {\n    super.oncreate(vnode);\n\n    this.preventClose = this.preventClose.bind(this);\n    window.addEventListener('beforeunload', this.preventClose);\n  }\n\n  onremove(vnode: Mithril.Vnode<PollAttrs, this>) {\n    super.onremove(vnode);\n\n    window.removeEventListener('beforeunload', this.preventClose);\n  }\n\n  view(): Mithril.Children {\n    const poll = this.attrs.poll;\n    const state = this.state;\n    const controls = PollControls.controls(poll, this);\n\n    (poll.publicPoll() || poll.canEdit()) &&\n      controls.add(\n        'view',\n        <Button onclick={state.showVoters} icon=\"fas fa-poll\">\n          {app.translator.trans('fof-polls.forum.public_poll')}\n        </Button>\n      );\n\n    return (\n      <div className={classList('Poll', poll.imageUrl() && 'Poll--image')} data-id={poll.id()}>\n        {this.controlsView(controls.toArray())}\n        <div className=\"Poll-wrapper\">{this.createMainView().toArray()}</div>\n      </div>\n    );\n  }\n\n  createMainView(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add('header', <div className=\"Poll-header\">{this.createPollHeader().toArray()}</div>);\n    items.add('content', <div className=\"Poll-content\">{this.createPollContent().toArray()}</div>);\n    items.add('footer', <div className=\"Poll-footer\">{this.createPollFooter().toArray()}</div>);\n\n    return items;\n  }\n\n  createPollHeader(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n    const poll = this.attrs.poll;\n\n    items.add('title', <PollTitle poll={poll} />);\n    if (poll.subtitle()) items.add('subtitle', <PollSubtitle poll={poll} />);\n\n    return items;\n  }\n\n  createPollContent(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n    const poll = this.attrs.poll;\n\n    if (poll.imageUrl()) {\n      items.add('image', <PollImage poll={poll} />);\n    }\n\n    items.add('form', <form className=\"Poll-form\">{this.createFormItems().toArray()}</form>);\n\n    return items;\n  }\n\n  createPollFooter(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n    const state = this.state;\n\n    const infoItems = this.infoItems(state.getMaxVotes());\n\n    items.add(\n      'sticky',\n      <div className=\"Poll-sticky\">\n        {!infoItems.isEmpty() && <div className=\"helpText PollInfoText\">{infoItems.toArray()}</div>}\n        {state.showButton() && <PollSubmitButton state={state} />}\n      </div>\n    );\n\n    return items;\n  }\n\n  createFormItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n    const poll = this.attrs.poll;\n    const state = this.state;\n    const questionSlug = slug(poll.question());\n\n    items.add(\n      'elements',\n      <fieldset>\n        <legend className=\"sr-only\">{poll.question()}</legend>\n        <PollOptions name={questionSlug} options={poll.options()} state={state} />\n      </fieldset>\n    );\n\n    return items;\n  }\n\n  controlsView(controls: Mithril.ChildArray): Mithril.Children {\n    return (\n      !!controls.length && (\n        <Dropdown\n          icon=\"fas fa-ellipsis-v\"\n          className=\"PollListItem-controls\"\n          menuClassName=\"Dropdown-menu--right\"\n          buttonClassName=\"Button Button--icon Button--flat\"\n          accessibleToggleLabel={app.translator.trans('fof-polls.forum.poll_controls.toggle_dropdown_accessible_label')}\n        >\n          {controls}\n        </Dropdown>\n      )\n    );\n  }\n\n  infoItems(maxVotes: number) {\n    const items = new ItemList<Mithril.Children>();\n    const poll = this.attrs.poll;\n\n    if (app.session.user && !poll.canVote() && !poll.hasEnded()) {\n      items.add(\n        'no-permission',\n        <span>\n          <i className=\"icon fas fa-times-circle fa-fw\" />\n          {app.translator.trans('fof-polls.forum.no_permission')}\n        </span>\n      );\n    }\n\n    if (poll.endDate()) {\n      items.add(\n        'end-date',\n        <span>\n          <i class=\"icon fas fa-clock fa-fw\" />\n          {poll.hasEnded()\n            ? app.translator.trans('fof-polls.forum.poll_ended')\n            : app.translator.trans('fof-polls.forum.days_remaining', { time: dayjs(poll.endDate()).fromNow() })}\n        </span>\n      );\n    }\n\n    if (poll.canVote()) {\n      items.add(\n        'max-votes',\n        <span>\n          <i className=\"icon fas fa-poll fa-fw\" />\n          {app.translator.trans('fof-polls.forum.max_votes_allowed', { max: maxVotes })}\n        </span>\n      );\n\n      if (!poll.canChangeVote()) {\n        items.add(\n          'cannot-change-vote',\n          <span>\n            <i className={`icon fas fa-${this.state.hasVoted() ? 'times' : 'exclamation'}-circle fa-fw`} />\n            {app.translator.trans('fof-polls.forum.poll.cannot_change_vote')}\n          </span>\n        );\n      }\n    }\n\n    return items;\n  }\n\n  /**\n   * Alert before navigating away using browser's 'beforeunload' event\n   */\n  preventClose = (e: Event): boolean | void => {\n    if (this.state.hasSelectedOptions()) {\n      e.preventDefault();\n      return true;\n    }\n  };\n}\n","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","import app from 'flarum/forum/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport classList from 'flarum/common/utils/classList';\nimport icon from 'flarum/common/helpers/icon';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport type Mithril from 'mithril';\n\ninterface PollPageHeroAttrs extends ComponentAttrs {\n  icon?: string;\n  title?: string;\n}\n\nexport default class PollPageHero extends Component<PollPageHeroAttrs> {\n  oninit(vnode: Mithril.Vnode) {\n    super.oninit(vnode);\n  }\n\n  get classNames(): string {\n    return classList({\n      PollPageHero: true,\n      Hero: true,\n    });\n  }\n\n  get wrapperClasses(): string {\n    return classList({\n      'PollPageHero--wrapper': true,\n    });\n  }\n\n  oncreate(vnode: Mithril.Vnode): void {\n    super.oncreate(vnode);\n  }\n\n  get title() {\n    return this.attrs.title || app.translator.trans('fof-polls.forum.polls_page.title');\n  }\n\n  get icon() {\n    return this.attrs.icon || 'fas fa-poll';\n  }\n\n  view() {\n    return (\n      <div className={this.wrapperClasses}>\n        <header className={this.classNames}>\n          <div className=\"container\">\n            <div className=\"containerNarrow\">{this.items().toArray()}</div>\n          </div>\n        </header>\n      </div>\n    );\n  }\n\n  items() {\n    const items = new ItemList();\n    items.add('title', <h2 className=\"Hero-title\">{[icon(this.icon), ' ', this.title]}</h2>, 50);\n\n    return items;\n  }\n}\n","import Page, { IPageAttrs } from 'flarum/common/components/Page';\nimport PollListState from '../states/PollListState';\nimport Poll from '../models/Poll';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport type Mithril from 'mithril';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport listItems from 'flarum/common/helpers/listItems';\nimport app from 'flarum/forum/app';\nimport SelectDropdown from 'flarum/common/components/SelectDropdown';\nimport IndexPageHero from './PollPageHero';\n\nexport abstract class AbstractPollPage extends Page<IPageAttrs, PollListState> {\n  loading: boolean = false;\n  poll: Poll | null | undefined = null;\n  polls: Poll[] = [];\n\n  view(): Mithril.Children {\n    return <div className=\"PollsPage\">{this.pageContent().toArray()}</div>;\n  }\n\n  pageContent(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add('hero', this.hero(), 100);\n    items.add('main', <div className=\"container\">{this.mainContent().toArray()}</div>, 10);\n\n    return items;\n  }\n\n  mainContent(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add('sidebar', this.sidebar(), 100);\n    items.add('content', this.content(), 10);\n\n    return items;\n  }\n\n  content(): Mithril.Children {\n    return <div className=\"PollsPage-content sideNavOffset\">{this.contentItems().toArray()}</div>;\n  }\n\n  contentItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    if (this.loading) {\n      items.add('loading', <LoadingIndicator />);\n    }\n\n    return items;\n  }\n\n  hero(): Mithril.Children {\n    return <IndexPageHero />;\n  }\n\n  sidebar(): Mithril.Children {\n    return (\n      <nav className=\"PollsPage-nav IndexPage-nav sideNav\">\n        <ul>{listItems(this.sidebarItems().toArray())}</ul>\n      </nav>\n    );\n  }\n\n  sidebarItems(): ItemList<Mithril.Children> {\n    const items = IndexPage.prototype.sidebarItems();\n\n    items.setContent(\n      'nav',\n      <SelectDropdown\n        buttonClassName=\"Button\"\n        className=\"App-titleControl\"\n        accessibleToggleLabel={app.translator.trans('core.forum.index.toggle_sidenav_dropdown_accessible_label')}\n      >\n        {this.navItems().toArray()}\n      </SelectDropdown>\n    );\n\n    return items;\n  }\n\n  navItems(): ItemList<Mithril.Children> {\n    const items = IndexPage.prototype.navItems();\n\n    if (app.initializers.has('flarum-tags')) {\n      // remove the tags from the nav items\n      items.remove('separator');\n      items.remove('moreTags');\n\n      // each tag is added using the key \"tag{id}\". We need to remove all of them\n      for (const key in items.toObject()) {\n        if (key.startsWith('tag') && key !== 'tags') {\n          items.remove(key);\n        }\n      }\n    }\n\n    return items;\n  }\n}\n","import type Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport PollModel from '../models/Poll';\nimport PollView from './PollView';\nimport { AbstractPollPage } from './AbstractPollPage';\nimport ItemList from 'flarum/common/utils/ItemList';\n\nexport default class PollViewPage extends AbstractPollPage {\n  oninit(vnode: Mithril.Vnode) {\n    super.oninit(vnode);\n\n    if (!app.forum.attribute<boolean>('globalPollsEnabled')) {\n      m.route.set('/');\n      return;\n    }\n\n    const editId = m.route.param('id');\n    this.poll = app.store.getById<PollModel>('poll', editId);\n\n    if (!this.poll) {\n      this.loading = true;\n\n      app.store.find<PollModel>('fof/polls', editId).then((item) => {\n        this.poll = item;\n        this.loading = false;\n        app.setTitle(this.poll.question());\n        m.redraw();\n      });\n    }\n  }\n\n  contentItems(): ItemList<Mithril.Children> {\n    const items = super.contentItems();\n\n    if (!this.loading) {\n      items.add('poll', <PollView poll={this.poll} />);\n    }\n\n    return items;\n  }\n}\n","import type Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport type { PollListParams } from '../../states/PollListState';\nimport SubtreeRetainer from 'flarum/common/utils/SubtreeRetainer';\nimport classList from 'flarum/common/utils/classList';\nimport Dropdown from 'flarum/common/components/Dropdown';\nimport Link from 'flarum/common/components/Link';\nimport highlight from 'flarum/common/helpers/highlight';\nimport slidable from 'flarum/forum/utils/slidable';\nimport icon from 'flarum/common/helpers/icon';\nimport abbreviateNumber from 'flarum/common/utils/abbreviateNumber';\nimport Poll from '../../models/Poll';\nimport PollControls from '../../utils/PollControls';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport listItems from 'flarum/common/helpers/listItems';\nimport PollViewPage from '../PollViewPage';\n\nexport interface IPollListItemAttrs extends ComponentAttrs {\n  poll: Poll;\n  params: PollListParams;\n}\n\n/**\n * The `PollListItem` component shows a single poll in the\n * poll list.\n */\nexport default class PollListItem<CustomAttrs extends IPollListItemAttrs = IPollListItemAttrs> extends Component<CustomAttrs> {\n  /**\n   * Ensures that the poll will not be redrawn\n   * unless new data comes in.\n   */\n  subtree!: SubtreeRetainer;\n  poll!: Poll;\n\n  highlightRegExp?: RegExp;\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.poll = this.attrs.poll;\n\n    this.subtree = new SubtreeRetainer(\n      () => this.poll.freshness,\n      () => {\n        const time = app.session.user && app.session.user.markedAllAsReadAt();\n        return time && time.getTime();\n      },\n      () => this.active()\n    );\n  }\n\n  elementAttrs() {\n    return {\n      className: classList('PollListItem', {\n        active: this.active(),\n        'PollListItem--hidden': this.poll.isHidden(),\n        Slidable: 'ontouchstart' in window,\n      }),\n    };\n  }\n\n  view() {\n    const controls = PollControls.controls(this.poll, this).toArray();\n    const attrs = this.elementAttrs();\n\n    return (\n      <div {...attrs}>\n        {this.controlsView(controls)}\n        {this.contentView()}\n        {this.slidableUnderneathView()}\n      </div>\n    );\n  }\n\n  controlsView(controls: Mithril.ChildArray): Mithril.Children {\n    return (\n      !!controls.length && (\n        <Dropdown\n          icon=\"fas fa-ellipsis-v\"\n          className=\"PollListItem-controls\"\n          menuClassName=\"Dropdown-menu--right\"\n          buttonClassName=\"Button Button--icon Button--flat\"\n          accessibleToggleLabel={app.translator.trans('fof-polls.forum.poll_controls.toggle_dropdown_accessible_label')}\n        >\n          {controls}\n        </Dropdown>\n      )\n    );\n  }\n\n  slidableUnderneathView(): Mithril.Children {\n    const isUnread = this.poll.isUnread();\n\n    return (\n      <span\n        className={classList('Slidable-underneath Slidable-underneath--left Slidable-underneath--elastic', { disabled: !isUnread })}\n        onclick={this.markAsRead.bind(this)}\n      >\n        {icon('fas fa-check')}\n      </span>\n    );\n  }\n\n  contentView(): Mithril.Children {\n    // const isUnread = this.poll.isUnread();\n    // const isRead = this.poll.isRead();\n\n    return (\n      //   <div className={classList('PollListItem-content', 'Slidable-content', { unread: isUnread, read: isRead })}>\n      <div className={classList('PollListItem-content')}>{this.mainView()}</div>\n    );\n  }\n\n  mainView(): Mithril.Children {\n    return (\n      <Link href={app.route('fof.polls.view', { id: this.poll.id() })} className=\"PollListItem-main\">\n        <h2 className=\"PollListItem-title\">{highlight(this.pollQuestion(this.poll), this.highlightRegExp)}</h2>\n        {this.poll.subtitle() && <p className=\"PollListItem-subtitle helpText\">{this.pollSubtitle(this.poll)}</p>}\n        <ul className=\"PollListItem-info\">{listItems(this.infoItems().toArray())}</ul>\n      </Link>\n    );\n  }\n\n  /**\n   * Allow extensions to revise the question string.\n   */\n  pollQuestion(poll: Poll): string {\n    return poll.question();\n  }\n\n  /**\n   * Allow extensions to revise the subtitle string.\n   */\n  pollSubtitle(poll: Poll): string | null {\n    return poll.subtitle();\n  }\n\n  oncreate(vnode: Mithril.VnodeDOM<CustomAttrs, this>) {\n    super.oncreate(vnode);\n\n    // If we're on a touch device, set up the discussion row to be slidable.\n    // This allows the user to drag the row to either side of the screen to\n    // reveal controls.\n    if ('ontouchstart' in window) {\n      const slidableInstance = slidable(this.element);\n\n      this.$('.PollListItem-controls').on('hidden.bs.dropdown', () => slidableInstance.reset());\n    }\n  }\n\n  onbeforeupdate(vnode: Mithril.VnodeDOM<CustomAttrs, this>) {\n    super.onbeforeupdate(vnode);\n\n    return this.subtree.needsRebuild();\n  }\n\n  /**\n   * Determine whether or not the discussion is currently being viewed.\n   */\n  active() {\n    return app.current.matches(PollViewPage, { poll: this.poll });\n  }\n\n  /**\n   * Mark the poll as read.\n   */\n  markAsRead() {\n    if (this.poll.isUnread()) {\n      this.poll.save({ lastVotedNumber: this.poll.voteCount() });\n      m.redraw();\n    }\n  }\n\n  infoItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n    const active = !this.poll.hasEnded();\n    const activeView = this.poll.endDate()\n      ? [\n          icon('fas fa-clock'),\n          ' ',\n          active\n            ? app.translator.trans('fof-polls.forum.days_remaining', { time: dayjs(this.poll.endDate()).fromNow() })\n            : app.translator.trans('fof-polls.forum.poll_ended'),\n        ]\n      : [icon('fas fa-infinity'), ' ', app.translator.trans('fof-polls.forum.poll_never_ends')];\n\n    items.add('active', <span className={classList('PollListItem-endStatus', { active })}>{activeView}</span>);\n\n    const voteCount = this.poll.voteCount();\n    if (voteCount !== undefined) {\n      items.add(\n        'voteCount',\n        <span>\n          {icon('fas fa-poll fa-fw')}\n          {[\n            ' ',\n            app.translator.trans('fof-polls.forum.polls_count', {\n              count: abbreviateNumber(voteCount),\n            }),\n          ]}\n        </span>,\n        70\n      );\n    }\n\n    return items;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Placeholder'];","import app from 'flarum/forum/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport PollListItem from './PollListItem';\nimport Button from 'flarum/common/components/Button';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Placeholder from 'flarum/common/components/Placeholder';\nimport classList from 'flarum/common/utils/classList';\nimport PollListState from '../../states/PollListState';\n\nexport interface PollListAttrs extends ComponentAttrs {\n  state: PollListState;\n}\n\n/**\n * The `PollList` component displays a list of polls.\n */\nexport default class PollList extends Component<PollListAttrs> {\n  view() {\n    const state = this.attrs.state;\n    const params = state.getParams();\n    const isLoading = state.isInitialLoading() || state.isLoadingNext();\n\n    let loading;\n\n    if (isLoading) {\n      loading = <LoadingIndicator />;\n    } else if (state.hasNext()) {\n      loading = (\n        <Button className=\"Button\" onclick={state.loadNext.bind(state)}>\n          {app.translator.trans('fof-polls.forum.polls_list.load_more_button')}\n        </Button>\n      );\n    }\n\n    if (state.isEmpty()) {\n      const text = app.translator.trans('fof-polls.forum.polls_list.empty_text');\n      return (\n        <div className=\"PollList\">\n          <Placeholder text={text} />\n        </div>\n      );\n    }\n\n    return (\n      <div className={classList('PollList', { 'PollList--searchResults': state.isSearchResults() })}>\n        <ul aria-busy={isLoading} className=\"PollList-polls\">\n          {state.getPages().map((pg) => {\n            return pg.items.map((poll) => (\n              <li key={poll.id()} data-id={poll.id()}>\n                <PollListItem poll={poll} params={params} />\n              </li>\n            ));\n          })}\n        </ul>\n        <div className=\"PollList-loadMore\">{loading}</div>\n      </div>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/states/PaginatedListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/EventEmitter'];","import app from 'flarum/forum/app';\nimport PaginatedListState, { Page, PaginatedListParams, PaginatedListRequestParams } from 'flarum/common/states/PaginatedListState';\nimport Poll from '../models/Poll';\nimport { ApiResponsePlural } from 'flarum/common/Store';\nimport EventEmitter from 'flarum/common/utils/EventEmitter';\n\nexport interface PollListParams extends PaginatedListParams {\n  sort?: string;\n}\n\nconst globalEventEmitter = new EventEmitter();\n\nexport default class PollListState<P extends PollListParams = PollListParams> extends PaginatedListState<Poll, P> {\n  protected extraPolls: Poll[] = [];\n  protected eventEmitter: EventEmitter;\n\n  constructor(params: P, page: number = 1) {\n    super(params, page, 20);\n\n    this.eventEmitter = globalEventEmitter.on('poll.deleted', this.deletePoll.bind(this));\n  }\n\n  get type(): string {\n    return 'fof/polls';\n  }\n\n  requestParams(): PaginatedListRequestParams {\n    const params = {\n      include: this.requestIncludes(),\n      filter: this.params.filter || {},\n      sort: this.sortMap()[this.params.sort ?? ''],\n    };\n\n    if (this.params.q) {\n      params.filter.q = this.params.q;\n    }\n\n    return params;\n  }\n\n  includes(): string[] {\n    return ['options', 'votes'];\n  }\n\n  private requestIncludes(): string {\n    const standard = this.includes();\n\n    // merge the standard includes with the custom includes\n    const merged = [...standard, ...(this.params.include || [])];\n\n    // return as a comma separated string\n    return merged.join(',');\n  }\n\n  protected loadPage(page: number = 1): Promise<ApiResponsePlural<Poll>> {\n    const preloadedPolls = app.preloadedApiDocument<Poll[]>();\n\n    if (preloadedPolls) {\n      this.initialLoading = false;\n\n      return Promise.resolve(preloadedPolls);\n    }\n\n    return super.loadPage(page);\n  }\n\n  clear(): void {\n    super.clear();\n\n    this.extraPolls = [];\n  }\n\n  /**\n   * Get a map of sort keys (which appear in the URL, and are used for\n   * translation) to the API sort value that they represent.\n   */\n  sortMap() {\n    const map: any = {};\n\n    if (this.params.q) {\n      map.relevance = '';\n    }\n    map.newest = '-createdAt';\n    map.oldest = 'createdAt';\n\n    return map;\n  }\n\n  /**\n   * In the last request, has the user searched for a poll?\n   */\n  isSearchResults(): boolean {\n    return !!this.params.q;\n  }\n\n  removePoll(poll: Poll): void {\n    this.eventEmitter.emit('poll.deleted', poll);\n  }\n\n  deletePoll(poll: Poll): void {\n    for (const page of this.pages) {\n      const index = page.items.indexOf(poll);\n\n      if (index !== -1) {\n        page.items.splice(index, 1);\n        break;\n      }\n    }\n\n    const index = this.extraPolls.indexOf(poll);\n\n    if (index !== -1) {\n      this.extraPolls.splice(index);\n    }\n\n    m.redraw();\n  }\n\n  /**\n   * Add a poll to the top of the list.\n   */\n  addPoll(poll: Poll): void {\n    this.removePoll(poll);\n    this.extraPolls.unshift(poll);\n\n    m.redraw();\n  }\n\n  protected getAllItems(): Poll[] {\n    return this.extraPolls.concat(super.getAllItems());\n  }\n\n  public getPages(): Page<Poll>[] {\n    const pages = super.getPages();\n\n    if (this.extraPolls.length) {\n      return [\n        {\n          number: -1,\n          items: this.extraPolls,\n        },\n        ...pages,\n      ];\n    }\n\n    return pages;\n  }\n}\n","import type Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport listItems from 'flarum/common/helpers/listItems';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport PollList from './Poll/PollList';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport extractText from 'flarum/common/utils/extractText';\nimport PollListState from '../states/PollListState';\nimport Button from 'flarum/common/components/Button';\nimport SelectDropdown from 'flarum/common/components/SelectDropdown';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport PollView from './PollView';\nimport { AbstractPollPage } from './AbstractPollPage';\n\nexport default class PollsPage extends AbstractPollPage {\n  oninit(vnode: Mithril.Vnode) {\n    super.oninit(vnode);\n\n    if (!app.forum.attribute<boolean>('globalPollsEnabled')) {\n      m.route.set('/');\n      return;\n    }\n\n    this.state = new PollListState({\n      sort: m.route.param('sort'),\n      filter: m.route.param('filter'),\n    });\n\n    this.state.refresh();\n\n    app.setTitle(extractText(app.translator.trans('fof-polls.forum.page.nav')));\n  }\n\n  view(): Mithril.Children {\n    if (this.loading) {\n      return <LoadingIndicator />;\n    }\n\n    if (this.poll) {\n      return (\n        <div className=\"PollsListPage\">\n          <div className=\"container\">\n            <PollView poll={this.poll} />\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"PollsListPage\">\n        {super.hero()}\n        <div className=\"container\">\n          <div className=\"sideNavContainer\">\n            <nav className=\"PollsListPage-nav sideNav\">\n              <ul>{listItems(this.sidebarItems().toArray())}</ul>\n            </nav>\n            <div className=\"PollsPage-results sideNavOffset\">\n              <div className=\"IndexPage-toolbar\">\n                <ul className=\"IndexPage-toolbar-view\">{listItems(this.viewItems().toArray())}</ul>\n                <ul className=\"IndexPage-toolbar-action\">{listItems(this.actionItems().toArray())}</ul>\n              </div>\n              <PollList state={this.state} />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  sidebarItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n    const canStartPoll = app.forum.attribute<boolean>('canStartGlobalPolls');\n\n    items.add(\n      'newGlobalPoll',\n      <Button\n        icon=\"fas fa-edit\"\n        className=\"Button Button--primary App-primaryControl PollsPage-newPoll\"\n        itemClassName=\"App-primaryControl\"\n        onclick={() => {\n          this.newPollAction();\n        }}\n        disabled={!canStartPoll}\n      >\n        {app.translator.trans(`fof-polls.forum.poll.${canStartPoll ? 'start_poll_button' : 'cannot_start_poll_button'}`)}\n      </Button>\n    );\n\n    items.add(\n      'nav',\n      <SelectDropdown\n        buttonClassName=\"Button\"\n        className=\"App-titleControl\"\n        accessibleToggleLabel={app.translator.trans('core.forum.index.toggle_sidenav_dropdown_accessible_label')}\n      >\n        {this.navItems().toArray()}\n      </SelectDropdown>\n    );\n\n    return items;\n  }\n\n  actionItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'refresh',\n      Button.component({\n        title: app.translator.trans('fof-polls.forum.page.refresh_tooltip'),\n        icon: 'fas fa-sync',\n        className: 'Button Button--icon',\n        onclick: () => {\n          this.state.refresh();\n        },\n      })\n    );\n\n    return items;\n  }\n\n  viewItems() {\n    return IndexPage.prototype.viewItems();\n  }\n\n  navItems() {\n    return IndexPage.prototype.navItems();\n  }\n\n  /**\n   * Change to create new poll page\n   */\n  newPollAction(): void {\n    if (!app.session.user) {\n      app.modal.show(LogInModal);\n      return;\n    }\n\n    m.route.set(app.route('fof.polls.compose'));\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Separator'];","import type Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport Poll from '../models/Poll';\nimport Component from 'flarum/common/Component';\nimport ComposePollPage from '../components/ComposePollPage';\nimport PollsPage from '../components/PollsPage';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Separator from 'flarum/common/components/Separator';\nimport Button from 'flarum/common/components/Button';\n\n/**\n * The `UserControls` utility constructs a list of buttons for a user which\n * perform actions on it.\n */\nexport default {\n  /**\n   * Get a list of controls for a user.\n   */\n  controls(poll: Poll, context: Component): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    ['poll', 'moderation', 'destructive'].forEach((section) => {\n      const controls = (this[section + 'Controls'](poll, context) as ItemList<Mithril.Children>).toArray();\n      if (controls.length) {\n        controls.forEach((item) => items.add(item.itemName, item));\n        items.add(section + 'Separator', <Separator />);\n      }\n    });\n\n    return items;\n  },\n\n  /**\n   * Get controls for direct modifcation actions on polls (e.g. vote, view voters).\n   */\n  pollControls(poll: Poll, context: Component): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    return items;\n  },\n\n  /**\n   * Get controls for a user pertaining to moderation (e.g. suspend, edit).\n   */\n  moderationControls(poll: Poll, context: Component): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    if (poll.canEdit()) {\n      items.add(\n        'edit',\n        <Button icon=\"fas fa-pencil-alt\" onclick={this.editAction.bind(this, poll)}>\n          {app.translator.trans(`fof-polls.forum.poll_controls.edit_label`)}\n        </Button>\n      );\n    }\n\n    return items;\n  },\n\n  /**\n   * Get controls for a user which are destructive (e.g. delete).\n   * @protected\n   */\n  destructiveControls(poll: Poll, context: Component): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    if (poll.canDelete()) {\n      items.add(\n        'delete',\n        <Button icon=\"far fa-trash-alt\" onclick={this.deleteAction.bind(this, poll)}>\n          {app.translator.trans(`fof-polls.forum.poll_controls.delete_label`)}\n        </Button>\n      );\n    }\n\n    return items;\n  },\n\n  /**\n   * Delete the poll.\n   */\n  async deleteAction(poll: Poll): Promise<void> {\n    if (!confirm(app.translator.trans(`fof-polls.forum.poll_controls.delete_confirmation`) as string)) {\n      return;\n    }\n\n    return poll\n      .delete()\n      .then(() => {\n        this.showDeletionAlert(poll, 'success');\n        if (app.current.matches(ComposePollPage, { id: poll.id() }) || app.current.matches(PollsPage, { id: poll.id() })) {\n          app.history.back();\n        } else {\n          window.location.reload();\n        }\n      })\n      .catch(() => this.showDeletionAlert(poll, 'error'));\n  },\n\n  /**\n   * Show deletion alert of poll\n   */\n  showDeletionAlert(poll: Poll, type: string): void {\n    const message = {\n      success: `fof-polls.forum.poll_controls.delete_success_message`,\n      error: `fof-polls.forum.poll_controls.delete_error_message`,\n    }[type]!;\n\n    app.alerts.show({ type }, app.translator.trans(message, { poll: poll }));\n  },\n\n  /**\n   * Edit the poll.\n   */\n  editAction(poll: Poll): void {\n    m.route.set(app.route('fof.polls.compose', { id: poll.id() }));\n  },\n};\n","function _extends() {\n  return _extends = Object.assign ? Object.assign.bind() : function (n) {\n    for (var e = 1; e < arguments.length; e++) {\n      var t = arguments[e];\n      for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]);\n    }\n    return n;\n  }, _extends.apply(null, arguments);\n}\nexport { _extends as default };","import app from 'flarum/forum/app';\nimport Button, { IButtonAttrs } from 'flarum/common/components/Button';\nimport classList from 'flarum/common/utils/classList';\nimport Mithril from 'mithril';\nimport Poll from '../models/Poll';\nimport PollOption from '../models/PollOption';\n\nexport interface UploadPollImageButtonAttrs extends IButtonAttrs {\n  className?: string;\n  loading?: boolean;\n  name: string;\n  onclick: () => void;\n  poll?: Poll | null;\n  option?: PollOption | null;\n  onUpload: (fileName: string | null | undefined) => void;\n}\n\nexport interface PollUploadObject {\n  fileUrl: string;\n  fileName: string;\n}\n\nexport default class UploadPollImageButton extends Button<UploadPollImageButtonAttrs> {\n  loading: boolean = false;\n  uploadedImageUrl: string | undefined | false = false;\n  fileName: string | undefined = undefined;\n  $input: JQuery<HTMLElement> | undefined;\n\n  view(vnode: Mithril.Vnode<UploadPollImageButtonAttrs>) {\n    this.attrs.loading = this.loading;\n    this.attrs.className = classList(this.attrs.className, 'Button', 'Button--inverted');\n\n    const imageUrl = this.getImageUrl();\n    const canUpload = app.forum.attribute<boolean>('canUploadPollImages');\n\n    if (imageUrl) {\n      this.attrs.onclick = this.remove.bind(this);\n\n      return (\n        <div>\n          <p>\n            <img src={imageUrl} alt=\"\" />\n          </p>\n          <p>\n            {super.view({\n              ...vnode,\n              children: app.translator.trans('fof-polls.forum.upload_image.remove_button'),\n            })}\n          </p>\n        </div>\n      );\n    } else {\n      this.attrs.onclick = this.upload.bind(this);\n    }\n\n    return canUpload && super.view({ ...vnode, poll: undefined, children: app.translator.trans('fof-polls.forum.upload_image.upload_button') });\n  }\n\n  /**\n   * Prompt the user to upload an image.\n   */\n  upload() {\n    if (this.loading) return;\n\n    this.$input = $('<input type=\"file\">');\n\n    this.$input\n      .appendTo('body')\n      .hide()\n      .trigger('click')\n      .on('change', (e) => {\n        const body = new FormData();\n        body.append(this.attrs.name, $(e.target)[0].files[0]);\n\n        this.loading = true;\n        m.redraw();\n\n        app\n          .request<PollUploadObject>({\n            method: 'POST',\n            url: this.resourceUrl(),\n            serialize: (raw) => raw,\n            body,\n          })\n          .then(this.success.bind(this), this.failure.bind(this));\n      });\n  }\n\n  /**\n   * Remove the image.\n   */\n  remove() {\n    this.loading = true;\n    m.redraw();\n\n    let fileName = undefined;\n\n    if (!this.attrs.poll?.exists && !this.attrs.option?.exists) {\n      fileName = this.fileName;\n    }\n\n    app\n      .request<PollUploadObject>({\n        method: 'DELETE',\n        url: this.resourceUrl(fileName),\n      })\n      .then((upload) => {\n        if (this.attrs.poll?.exists) {\n          this.attrs.poll.pushAttributes({ image: null, imageUrl: null, isImageUpload: false });\n        }\n\n        if (this.attrs.option?.exists) {\n          this.attrs.option.pushAttributes({ imageUrl: false });\n        }\n\n        return upload;\n      })\n      .then(this.success.bind(this), this.failure.bind(this));\n  }\n\n  resourceUrl(fileName: string | undefined = undefined) {\n    let url = app.forum.attribute('apiUrl') + '/fof/polls/' + this.attrs.name;\n    const poll = this.attrs.poll;\n    const option = this.attrs.option;\n\n    if (fileName) {\n      url += '/name/' + fileName;\n    } else {\n      if (poll?.exists) url += '/' + poll?.id();\n      if (option?.exists) url += '/' + option?.id();\n    }\n\n    return url;\n  }\n\n  getImageUrl() {\n    if (this.uploadedImageUrl !== false) {\n      return this.uploadedImageUrl;\n    }\n\n    return this.attrs.poll?.imageUrl() || this.attrs.option?.imageUrl();\n  }\n\n  /**\n   * After a successful upload/removal, redraw the page.\n   *\n   * @param {PollUploadObject} response\n   * @protected\n   */\n  success(response: PollUploadObject | null) {\n    this.loading = false;\n    this.uploadedImageUrl = response?.fileUrl;\n    this.fileName = response?.fileName;\n\n    this.attrs.onUpload?.(response?.fileName);\n    m.redraw();\n    this.$input?.remove();\n  }\n\n  /**\n   * If upload/removal fails, stop loading.\n   *\n   * @param {object} response\n   * @protected\n   */\n  failure(response: object) {\n    this.loading = false;\n    m.redraw();\n    this.$input?.remove();\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/RequestError'];","import Component, { ComponentAttrs } from 'flarum/common/Component';\nimport Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport Switch from 'flarum/common/components/Switch';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Stream from 'flarum/common/utils/Stream';\nimport extractText from 'flarum/common/utils/extractText';\nimport FormError from './form/FormError';\nimport PollFormState from '../states/PollFormState';\nimport PollControls from '../utils/PollControls';\nimport PollModel from '../models/Poll';\nimport PollOption from '../models/PollOption';\nimport UploadPollImageButton from './UploadPollImageButton';\nimport Poll from '../models/Poll';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport RequestError from 'flarum/common/utils/RequestError';\n\ninterface PollFormAttrs extends ComponentAttrs {\n  poll: PollModel;\n  onsubmit: (data: object, state: PollFormState) => Promise<void>;\n}\n\nexport default class PollForm extends Component<PollFormAttrs, PollFormState> {\n  protected options: PollOption[] = [];\n  protected optionAnswers: Stream<string>[] = [];\n  protected optionImageUrls: Stream<string>[] = [];\n  protected question: Stream<string>;\n  protected subtitle: Stream<string>;\n  protected image: Stream<string | null>;\n  protected imageAlt: Stream<string | null>;\n  protected endDate: Stream<string | null>;\n  protected publicPoll: Stream<boolean>;\n  protected allowMultipleVotes: Stream<boolean>;\n  protected hideVotes: Stream<boolean>;\n  protected allowChangeVote: Stream<boolean>;\n  protected maxVotes: Stream<number>;\n  protected datepickerMinDate: string = '';\n\n  oninit(vnode: Mithril.Vnode): void {\n    super.oninit(vnode);\n    this.state = new PollFormState(this.attrs.poll);\n\n    // state handles poll initialization\n    const poll = this.state.poll;\n\n    this.options = (poll.tempOptions ?? poll.options()) as PollOption[];\n    this.optionAnswers = this.options.map((o) => Stream(o.answer()));\n    this.optionImageUrls = this.options.map((o) => Stream(o.imageUrl()));\n\n    this.question = Stream(poll.question());\n    this.subtitle = Stream(poll.subtitle());\n    this.image = Stream(poll.image());\n    this.imageAlt = Stream(poll.imageAlt());\n    this.endDate = Stream(this.formatDate(poll.endDate()));\n    this.publicPoll = Stream(poll.publicPoll());\n    this.allowMultipleVotes = Stream(poll.allowMultipleVotes());\n    this.hideVotes = Stream(poll.hideVotes());\n    this.allowChangeVote = Stream(poll.allowChangeVote());\n    this.maxVotes = Stream(poll.maxVotes() || 0);\n\n    // Set minimum date for datepicker to current date\n    this.datepickerMinDate = this.formatDate() as string;\n\n    // Replace minimum of 'today' for poll end date only if the poll is not already closed\n    if (this.endDate() && dayjs(poll.endDate).isAfter(dayjs())) {\n      // We know that endDate is set, so we can safely cast the result to string\n      this.datepickerMinDate = this.formatDate(poll.endDate()) as string;\n    }\n  }\n\n  view(): Mithril.Children {\n    return (\n      <form onsubmit={this.onsubmit.bind(this)}>\n        <div className=\"PollDiscussionModal-form\">{this.fields().toArray()}</div>\n      </form>\n    );\n  }\n\n  fields(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'question',\n      <div className=\"Form-group\">\n        <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.question_placeholder')}</label>\n\n        <input type=\"text\" name=\"question\" className=\"FormControl\" bidi={this.question} />\n      </div>,\n      100\n    );\n\n    items.add(\n      'subtitle',\n      <div className=\"Form-group\">\n        <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.subtitle_placeholder')}</label>\n\n        <input type=\"text\" name=\"subtitle\" className=\"FormControl\" bidi={this.subtitle} />\n      </div>,\n      95\n    );\n\n    const hasImage = this.image();\n\n    items.add(\n      'poll_image',\n      <div className=\"Form-group\">\n        <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.poll_image.label')}</label>\n        {this.uploadConditional(\n          hasImage,\n          this.state.poll?.isImageUpload(),\n          <>\n            <p className=\"helpText\">{app.translator.trans('fof-polls.forum.modal.poll_image.help')}</p>\n            <input type=\"hidden\" name=\"pollImage\" bidi={this.image} />\n          </>,\n          <UploadPollImageButton name=\"pollImage\" poll={this.state.poll} onUpload={this.pollImageUploadSuccess.bind(this)} />,\n          <input\n            type=\"text\"\n            name=\"pollImage\"\n            className=\"FormControl\"\n            bidi={this.image}\n            placeholder={app.translator.trans('fof-polls.forum.modal.image_option_placeholder')}\n          />\n        )}\n      </div>,\n      90\n    );\n\n    if (hasImage) {\n      items.add(\n        'poll_image_alt',\n        <div className=\"Form-group\">\n          <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.poll_image.alt_label')}</label>\n\n          <input type=\"text\" required name=\"imageAlt\" className=\"FormControl\" bidi={this.imageAlt} />\n\n          <p className=\"helpText\">{app.translator.trans('fof-polls.forum.modal.poll_image.alt_help_text')}</p>\n        </div>,\n        90\n      );\n    }\n\n    items.add(\n      'answers',\n      <div className=\"PollModal--answers Form-group\">\n        <label className=\"label PollModal--answers-title\">\n          <span>{app.translator.trans('fof-polls.forum.modal.options_label')}</span>\n        </label>\n\n        {this.displayOptions().toArray()}\n\n        <Tooltip text={app.translator.trans('fof-polls.forum.modal.tooltip.options.add-button')}>\n          <Button className=\"Button PollModal--button Button--icon PollModal--add-button\" icon=\"fas fa-plus\" onclick={this.addOption.bind(this)} />\n        </Tooltip>\n      </div>,\n      80\n    );\n\n    items.add(\n      'date',\n      <div className=\"Form-group\">\n        <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.date_placeholder')}</label>\n\n        <div className=\"PollModal--date\">\n          <input\n            className=\"FormControl\"\n            type=\"datetime-local\"\n            name=\"date\"\n            bidi={this.endDate}\n            min={this.datepickerMinDate}\n            max={this.formatDate('2038')}\n          />\n          {Button.component({\n            className: 'Button PollModal--button Button--icon',\n            icon: 'fas fa-times',\n            onclick: this.endDate.bind(this, null),\n          })}\n        </div>\n\n        {this.endDate() && (\n          <p className=\"helpText\">\n            <i class=\"icon fas fa-clock\" />\n            &nbsp;\n            {dayjs(this.endDate()).isBefore(dayjs())\n              ? app.translator.trans('fof-polls.forum.poll_ended')\n              : app.translator.trans('fof-polls.forum.days_remaining', { time: dayjs(this.endDate()).fromNow() })}\n          </p>\n        )}\n      </div>,\n      40\n    );\n\n    items.add(\n      'public',\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: this.publicPoll() || false,\n            onchange: this.publicPoll,\n          },\n          app.translator.trans('fof-polls.forum.modal.public_poll_label')\n        )}\n      </div>,\n      20\n    );\n\n    items.add(\n      'hide-votes',\n      <div className=\"Form-group\">\n        <Switch state={this.endDate() && this.hideVotes()} onchange={this.hideVotes} disabled={!this.endDate()}>\n          {app.translator.trans('fof-polls.forum.modal.hide_votes_label')}\n        </Switch>\n      </div>,\n      20\n    );\n\n    items.add(\n      'allow-change-vote',\n      <div className=\"Form-group\">\n        <Switch state={this.allowChangeVote()} onchange={this.allowChangeVote}>\n          {app.translator.trans('fof-polls.forum.modal.allow_change_vote_label')}\n        </Switch>\n      </div>,\n      20\n    );\n\n    items.add(\n      'allow-multiple-votes',\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: this.allowMultipleVotes() || false,\n            onchange: this.allowMultipleVotes,\n          },\n          app.translator.trans('fof-polls.forum.modal.allow_multiple_votes_label')\n        )}\n      </div>,\n      15\n    );\n\n    if (this.allowMultipleVotes()) {\n      items.add(\n        'max-votes',\n        <div className=\"Form-group\">\n          <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.max_votes_label')}</label>\n\n          <input type=\"number\" min=\"0\" max={this.options.length} name=\"maxVotes\" className=\"FormControl\" bidi={this.maxVotes} />\n\n          <p className=\"helpText\">{app.translator.trans('fof-polls.forum.modal.max_votes_help')}</p>\n        </div>,\n        15\n      );\n    }\n\n    items.add(\n      'submit',\n      <div className=\"Form-group\">\n        <Button type=\"submit\" className=\"Button Button--primary PollModal-SubmitButton\" icon=\"fas fa-save\" loading={this.state.loading}>\n          {app.translator.trans('fof-polls.forum.modal.submit')}\n        </Button>\n        {this.state.poll.exists && (\n          <Button\n            className=\"Button Button--secondary PollModal-deleteButton\"\n            icon=\"fas fa-trash-alt\"\n            loading={this.state.deleting}\n            onclick={this.delete.bind(this)}\n          >\n            {app.translator.trans('fof-polls.forum.modal.delete')}\n          </Button>\n        )}\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  displayOptions(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n    const canUpload = app.forum.attribute<boolean>('canUploadPollImages');\n\n    this.options.forEach((option, i) => {\n      const imgFunc = this.optionImageUrls[i];\n\n      items.add(\n        'option-' + i,\n        <div className=\"Form-group\">\n          <fieldset className=\"Poll-answer-input\">\n            <input\n              className=\"FormControl\"\n              type=\"text\"\n              name={'answer' + (i + 1)}\n              bidi={this.optionAnswers[i]}\n              placeholder={app.translator.trans('fof-polls.forum.modal.option_placeholder') + ' #' + (i + 1)}\n            />\n            {app.forum.attribute<boolean>('allowPollOptionImage') && (\n              <div className=\"Poll-answer-image\">\n                {this.uploadConditional(\n                  !!imgFunc(),\n                  option?.isImageUpload(),\n                  <>\n                    <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.poll_option_image.label')}</label>\n                    <p className=\"helpText\">{app.translator.trans('fof-polls.forum.modal.poll_option_image.help')}</p>\n                    <input type=\"hidden\" name={'answerImage' + (i + 1)} value={imgFunc()} />\n                  </>,\n\n                  <UploadPollImageButton name=\"pollOptionImage\" option={option} onUpload={this.pollOptionImageUploadSuccess.bind(this, i)} />,\n\n                  <input\n                    type=\"text\"\n                    name={'answerImage' + (i + 1)}\n                    className=\"FormControl\"\n                    bidi={imgFunc}\n                    placeholder={app.translator.trans('fof-polls.forum.modal.image_option_placeholder')}\n                  />\n                )}\n              </div>\n            )}\n          </fieldset>\n          {i >= 2\n            ? Button.component({\n                type: 'button',\n                className: 'Button PollModal--button Button--icon',\n                icon: 'fas fa-minus',\n                onclick: i >= 2 ? this.removeOption.bind(this, i) : '',\n              })\n            : ''}\n        </div>\n      );\n    });\n\n    return items;\n  }\n\n  addOption() {\n    const max = Math.max(app.forum.attribute('pollMaxOptions'), 2);\n\n    if (this.options.length < max) {\n      this.options.push(app.store.createRecord('poll_options'));\n      this.optionAnswers.push(Stream(''));\n      this.optionImageUrls.push(Stream(''));\n    } else {\n      alert(extractText(app.translator.trans('fof-polls.forum.modal.max', { max })));\n    }\n  }\n\n  removeOption(i: number): void {\n    this.options.splice(i, 1);\n    this.optionAnswers.splice(i, 1);\n    this.optionImageUrls.splice(i, 1);\n  }\n\n  data(): object {\n    if (this.question() === '') {\n      throw new FormError(app.translator.trans('fof-polls.forum.modal.include_question'));\n    }\n\n    if (this.options.length < 2) {\n      throw new FormError(app.translator.trans('fof-polls.forum.modal.min'));\n    }\n\n    const pollExists = this.state.poll.exists;\n    const options = this.options.map((option, i) => {\n      option.pushAttributes({\n        answer: this.optionAnswers[i](),\n        imageUrl: this.optionImageUrls[i](),\n      });\n\n      return pollExists ? option.data : option.data.attributes;\n    });\n\n    return {\n      question: this.question(),\n      subtitle: this.subtitle(),\n      pollImage: this.image(),\n      imageAlt: this.imageAlt(),\n      endDate: this.dateToTimestamp(this.endDate()) ?? false,\n      publicPoll: this.publicPoll(),\n      hideVotes: this.hideVotes(),\n      allowChangeVote: this.allowChangeVote(),\n      allowMultipleVotes: this.allowMultipleVotes(),\n      maxVotes: this.maxVotes(),\n      options,\n    };\n  }\n\n  async onsubmit(event: Event) {\n    event.preventDefault();\n\n    try {\n      await this.attrs.onsubmit(this.data(), this.state);\n    } catch (error) {\n      if (error instanceof FormError) {\n        app.alerts.show({ type: 'error' }, error.message);\n      } else if (error instanceof RequestError) {\n        console.error(error);\n        app.alerts.show({ type: 'error' }, app.translator.trans('fof-polls.forum.modal.error'));\n      }\n    }\n  }\n\n  async delete(): Promise<void> {\n    this.state.loading = true;\n    try {\n      await PollControls.deleteAction(this.state.poll);\n      this.state.deleting = true;\n    } finally {\n      this.state.loading = false;\n      m.redraw();\n    }\n  }\n\n  formatDate(date: Date | string | false | undefined | null = undefined, def: Date | false = false): string | false {\n    const dayjsDate = dayjs(date);\n\n    if (date === false || !dayjsDate.isValid()) return def !== false ? this.formatDate(def) : false;\n\n    return dayjsDate.format('YYYY-MM-DDTHH:mm');\n  }\n\n  dateToTimestamp(date: Date | false): string | null {\n    const dayjsDate = dayjs(date);\n\n    if (!date || !dayjsDate.isValid()) return null;\n\n    return dayjsDate.format();\n  }\n\n  pollImageUploadSuccess(fileName: string | null | undefined): void {\n    this.image(fileName);\n  }\n\n  pollOptionImageUploadSuccess(index: number, fileName: string | null | undefined): void {\n    this.optionImageUrls[index] = Stream(fileName);\n  }\n\n  uploadConditional(hasImage: boolean, isUpload: boolean, ifCanUpload: JSX.Element, uploadButton: JSX.Element, imageUrlInput: JSX.Element) {\n    const canUpload = app.forum.attribute<boolean>('canUploadPollImages');\n    const canUploadNow = this.state.poll?.exists || (app.forum.attribute('canStartPolls') && app.forum.attribute('canStartGlobalPolls'));\n\n    // if can upload OR image is already uploaded\n    if (canUpload || isUpload) {\n      // may not have enough permissions to upload before creating poll\n      if (!canUploadNow && !isUpload) {\n        return (\n          <>\n            {imageUrlInput}\n            <p class=\"helpText\">{app.translator.trans('fof-polls.forum.modal.poll_image.later_help')}</p>\n          </>\n        );\n      }\n\n      return (\n        <>\n          {ifCanUpload}\n          <div class=\"Poll-image-inputs\">\n            {!hasImage && imageUrlInput}\n            {uploadButton}\n          </div>\n        </>\n      );\n    }\n\n    return imageUrlInput;\n  }\n}\n","import type Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport Modal, { IInternalModalAttrs } from 'flarum/common/components/Modal';\nimport PollForm from './PollForm';\nimport PollModel from '../models/Poll';\nimport PollFormState from '../states/PollFormState';\n\ninterface CreatePollModalAttrs extends IInternalModalAttrs {\n  poll: PollModel;\n  onsubmit: (data: object) => Promise<void>;\n}\n\nexport default class CreatePollModal extends Modal<CreatePollModalAttrs> {\n  title(): Mithril.Children {\n    return app.translator.trans('fof-polls.forum.modal.add_title');\n  }\n\n  className(): string {\n    return 'PollDiscussionModal Modal--medium';\n  }\n\n  content(): Mithril.Children {\n    return [\n      <div className=\"Modal-body\">\n        <PollForm poll={this.attrs.poll} onsubmit={this.onFormSubmit.bind(this)}></PollForm>\n      </div>,\n    ];\n  }\n\n  async onFormSubmit(data: object, state: PollFormState): Promise<void> {\n    this.hide();\n    await this.attrs.onsubmit(data);\n  }\n}\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport classList from 'flarum/common/utils/classList';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\nimport ReplyComposer from 'flarum/forum/components/ReplyComposer';\nimport CreatePollModal from './components/CreatePollModal';\nimport Poll from './models/Poll';\nimport PollOption from './models/PollOption';\nimport { ModelAttributes } from 'flarum/common/Model';\nimport PollModelAttributes from './models/PollModelAttributes';\n\nfunction toPoll(data: PollModelAttributes) {\n  if (data) {\n    const poll = app.store.createRecord<Poll>('polls');\n\n    poll.tempOptions = data.options.map((option: ModelAttributes) => {\n      const pollOption = app.store.createRecord<PollOption>('poll_options');\n      pollOption.pushAttributes(option);\n      return pollOption;\n    });\n    poll.pushAttributes(data);\n\n    return poll;\n  }\n  return data;\n}\n\nexport const addToComposer = (composer: ComponentClass) => {\n  // @ts-ignore\n  composer.prototype.addPoll = function () {\n    app.modal.show(CreatePollModal, {\n      poll: toPoll(this.composer.fields.poll),\n      onsubmit: (poll: PollModelAttributes) => (this.composer.fields.poll = poll),\n    });\n  };\n\n  // Add button to DiscussionComposer header\n  extend(composer.prototype, 'headerItems', function (items) {\n    const discussion = this.composer.body?.attrs?.discussion;\n\n    // @ts-ignore\n    const canStartPoll = discussion?.canStartPoll() ?? app.forum.canStartPolls();\n\n    if (canStartPoll) {\n      items.add(\n        'polls',\n        <a className=\"ComposerBody-poll\" onclick={this.addPoll.bind(this)}>\n          <span className={classList('PollLabel', !this.composer.fields.poll && 'none')}>\n            {app.translator.trans(`fof-polls.forum.composer_discussion.${this.composer.fields.poll ? 'edit' : 'add'}_poll`)}\n          </span>\n        </a>,\n        1\n      );\n    }\n  });\n\n  extend(composer.prototype, 'data', function (data) {\n    if (this.composer.fields.poll) {\n      data.poll = this.composer.fields.poll;\n    }\n  });\n};\n\nexport default () => {\n  addToComposer(DiscussionComposer);\n  addToComposer(ReplyComposer);\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","import type Mithril from 'mithril';\nimport app from 'flarum/forum/app';\nimport CreatePollModal from './CreatePollModal';\nimport PollFormState from '../states/PollFormState';\n\nexport default class EditPollModal extends CreatePollModal {\n  title(): Mithril.Children {\n    return app.translator.trans('fof-polls.forum.modal.edit_title');\n  }\n\n  async onFormSubmit(data: object, state: PollFormState): Promise<void> {\n    await state.save(data);\n\n    // Show success alert\n    const alertId = app.alerts.show(\n      {\n        type: 'success',\n      },\n      app.translator.trans('fof-polls.forum.compose.success')\n    );\n\n    // Hide alert after 10 seconds\n    setTimeout(() => app.alerts.dismiss(alertId), 10000);\n  }\n}\n","import app from 'flarum/forum/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport ListVotersModal from './ListVotersModal';\nimport classList from 'flarum/common/utils/classList';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport icon from 'flarum/common/helpers/icon';\nimport EditPollModal from './EditPollModal';\nimport Poll from '../models/Poll';\nimport type Mithril from 'mithril';\nimport PollOption from '../models/PollOption';\nimport Post from 'flarum/common/models/Post';\nimport extractText from 'flarum/common/utils/extractText';\nimport PollImage from './Poll/PollImage';\n\nexport interface PostPollAttrs extends ComponentAttrs {\n  poll: Poll;\n  post?: Post;\n}\n\nexport default class PostPoll extends Component<PostPollAttrs> {\n  loadingOptions: boolean = false;\n  useSubmitUI!: boolean;\n  pendingSubmit: boolean = false;\n  pendingOptions: any;\n\n  oninit(vnode: Mithril.Vnode<PostPollAttrs, this>) {\n    super.oninit(vnode);\n\n    this.useSubmitUI = !this.attrs.poll?.canChangeVote() && this.attrs.poll?.allowMultipleVotes();\n    this.pendingOptions = null;\n  }\n\n  oncreate(vnode: Mithril.Vnode<PostPollAttrs, this>) {\n    super.oncreate(vnode);\n\n    this.preventClose = this.preventClose.bind(this);\n    window.addEventListener('beforeunload', this.preventClose);\n  }\n\n  onremove(vnode: Mithril.Vnode<PostPollAttrs, this>) {\n    super.onremove(vnode);\n\n    window.removeEventListener('beforeunload', this.preventClose);\n  }\n\n  view() {\n    const poll = this.attrs.poll;\n    const options = poll.options() || [];\n    let maxVotes = poll.allowMultipleVotes() ? poll.maxVotes() : 1;\n\n    if (maxVotes === 0) maxVotes = options.length;\n\n    const infoItems = this.infoItems(maxVotes);\n\n    return (\n      <div className=\"Post-poll\" data-id={poll.id()}>\n        <div className=\"PollHeading\">\n          <div className=\"PollHeading-title-container\">\n            <h3 className=\"PollHeading-title\">{poll.question()}</h3>\n            {poll.subtitle() && <p className=\"helpText PollHeading-subtitle\">{poll.subtitle()}</p>}\n          </div>\n\n          <div className=\"PollHeading-actions\">\n            {poll.canSeeVoters() && (\n              <Tooltip text={app.translator.trans('fof-polls.forum.public_poll')}>\n                <Button className=\"Button PollHeading-voters\" onclick={this.showVoters.bind(this)} icon=\"fas fa-poll\" />\n              </Tooltip>\n            )}\n\n            {poll.canEdit() && (\n              <Tooltip text={app.translator.trans('fof-polls.forum.moderation.edit')}>\n                <Button className=\"Button PollHeading-edit\" onclick={app.modal.show.bind(app.modal, EditPollModal, { poll })} icon=\"fas fa-pen\" />\n              </Tooltip>\n            )}\n            {poll.canDelete() && (\n              <Tooltip text={app.translator.trans('fof-polls.forum.moderation.delete')}>\n                <Button className=\"Button PollHeading-delete\" onclick={this.deletePoll.bind(this)} icon=\"fas fa-trash\" />\n              </Tooltip>\n            )}\n          </div>\n        </div>\n\n        {!!poll.imageUrl() && <PollImage poll={poll} />}\n\n        <div>\n          <div className=\"PollOptions\">{options.map(this.viewOption.bind(this))}</div>\n\n          <div className=\"Poll-sticky\">\n            {!infoItems.isEmpty() && <div className=\"helpText PollInfoText\">{infoItems.toArray()}</div>}\n\n            {this.useSubmitUI && this.pendingSubmit && (\n              <Button className=\"Button Button--primary Poll-submit\" loading={this.loadingOptions} onclick={this.onsubmit.bind(this)}>\n                {app.translator.trans('fof-polls.forum.poll.submit_button')}\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  infoItems(maxVotes: number) {\n    const items = new ItemList();\n    const poll = this.attrs.poll;\n    const hasVoted = poll.myVotes()?.length > 0;\n\n    if (app.session.user && !poll.canVote() && !poll.hasEnded()) {\n      items.add(\n        'no-permission',\n        <span>\n          <i className=\"icon fas fa-times-circle fa-fw\" />\n          {app.translator.trans('fof-polls.forum.no_permission')}\n        </span>\n      );\n    }\n\n    if (poll.endDate()) {\n      items.add(\n        'end-date',\n        <span>\n          <i class=\"icon fas fa-clock fa-fw\" />\n          {poll.hasEnded()\n            ? app.translator.trans('fof-polls.forum.poll_ended')\n            : app.translator.trans('fof-polls.forum.days_remaining', { time: dayjs(poll.endDate()).fromNow() })}\n        </span>\n      );\n    }\n\n    if (poll.canVote()) {\n      items.add(\n        'max-votes',\n        <span>\n          <i className=\"icon fas fa-poll fa-fw\" />\n          {app.translator.trans('fof-polls.forum.max_votes_allowed', { max: maxVotes })}\n        </span>\n      );\n\n      if (!poll.canChangeVote()) {\n        items.add(\n          'cannot-change-vote',\n          <span>\n            <i className={`icon fas fa-${hasVoted ? 'times' : 'exclamation'}-circle fa-fw`} />\n            {app.translator.trans('fof-polls.forum.poll.cannot_change_vote')}\n          </span>\n        );\n      }\n    }\n\n    return items;\n  }\n\n  viewOption(opt: PollOption) {\n    const poll = this.attrs.poll;\n    const hasVoted = poll.myVotes()?.length > 0;\n    const totalVotes = poll.voteCount();\n\n    const voted = this.pendingOptions ? this.pendingOptions.has(opt.id()) : poll.myVotes()?.some?.((vote) => vote.option() === opt);\n    const votes = opt.voteCount();\n    const percent = totalVotes > 0 ? Math.round((votes / totalVotes) * 100) : 0;\n\n    // isNaN(null) is false, so we have to check type directly now that API always returns the field\n    const canSeeVoteCount = typeof votes === 'number';\n    const isDisabled = this.loadingOptions || (hasVoted && !poll.canChangeVote());\n    const width = canSeeVoteCount ? percent : (Number(voted) / (poll.myVotes()?.length || 1)) * 100;\n\n    const showCheckmark = !app.session.user || (!poll.hasEnded() && poll.canVote() && (!hasVoted || poll.canChangeVote()));\n\n    const bar = (\n      <div className=\"PollBar\" data-selected={!!voted} style={`--poll-option-width: ${width}%`}>\n        {showCheckmark && (\n          <label className=\"PollAnswer-checkbox\">\n            <input onchange={this.changeVote.bind(this, opt)} type=\"checkbox\" checked={voted} disabled={isDisabled} />\n            <span className=\"checkmark\" />\n          </label>\n        )}\n\n        <div className=\"PollAnswer-text\">\n          <span className=\"PollAnswer-text-answer\">{opt.answer()}</span>\n          {voted && !showCheckmark && icon('fas fa-check-circle', { className: 'PollAnswer-check' })}\n          {canSeeVoteCount && <span className={classList('PollPercent', percent !== 100 && 'PollPercent--option')}>{percent}%</span>}\n        </div>\n\n        {opt.imageUrl() ? <img className=\"PollAnswer-image\" src={opt.imageUrl()} alt={opt.answer()} loading=\"lazy\" /> : null}\n      </div>\n    );\n\n    return (\n      <div\n        className={classList('PollOption', hasVoted && 'PollVoted', poll.hasEnded() && 'PollEnded', opt.imageUrl() && 'PollOption-hasImage')}\n        data-id={opt.id()}\n      >\n        {canSeeVoteCount ? (\n          <Tooltip text={app.translator.trans('fof-polls.forum.tooltip.votes', { count: votes })} onremove={this.hideOptionTooltip}>\n            {bar}\n          </Tooltip>\n        ) : (\n          bar\n        )}\n      </div>\n    );\n  }\n\n  changeVote(option: PollOption, evt: Event) {\n    if (!app.session.user) {\n      app.modal.show(LogInModal);\n      evt.target.checked = false;\n      return;\n    }\n\n    const optionIds = this.pendingOptions || new Set(this.attrs.poll.myVotes().map?.((v) => v.option().id()));\n    const isUnvoting = optionIds.delete(option.id());\n    const allowsMultiple = this.attrs.poll.allowMultipleVotes();\n\n    if (!allowsMultiple) {\n      optionIds.clear();\n    }\n\n    if (!isUnvoting) {\n      optionIds.add(option.id());\n    }\n\n    if (this.useSubmitUI) {\n      this.pendingOptions = optionIds.size ? optionIds : null;\n      this.pendingSubmit = !!this.pendingOptions;\n      return;\n    }\n\n    return this.submit(optionIds, null, () => (evt.target.checked = isUnvoting));\n  }\n\n  onsubmit() {\n    return this.submit(this.pendingOptions, () => {\n      this.pendingOptions = null;\n      this.pendingSubmit = false;\n    });\n  }\n\n  submit(optionIds, cb, onerror) {\n    this.loadingOptions = true;\n    m.redraw();\n\n    return app\n      .request({\n        method: 'PATCH',\n        url: `${app.forum.attribute('apiUrl')}/fof/polls/${this.attrs.poll.id()}/votes`,\n        body: {\n          data: {\n            optionIds: Array.from(optionIds),\n          },\n        },\n      })\n      .then((res) => {\n        app.store.pushPayload(res);\n        cb?.();\n      })\n      .catch((err) => {\n        onerror?.(err);\n      })\n      .finally(() => {\n        this.loadingOptions = false;\n\n        m.redraw();\n      });\n  }\n\n  showVoters() {\n    // Load all the votes only when opening the votes list\n    app.modal.show(ListVotersModal, {\n      poll: this.attrs.poll,\n      post: this.attrs.post,\n    });\n  }\n\n  deletePoll() {\n    if (confirm(extractText(app.translator.trans('fof-polls.forum.moderation.delete_confirm')))) {\n      this.attrs.poll.delete().then(() => {\n        m.redraw.sync();\n      });\n    }\n  }\n\n  /**\n   * Attempting to use the `tooltipVisible` attr on the Tooltip component set to 'false' when no vote count\n   * caused the tooltip to break on click. This is a workaround to hide the tooltip when no vote count is available,\n   * called on 'onremove' of the Tooltip component. It doesn't always work as intended either, but it does the job.\n   */\n  hideOptionTooltip(vnode: Mithril.Vnode<PostPollAttrs, this>) {\n    vnode.attrs.tooltipVisible = false;\n    vnode.state.updateVisibility();\n  }\n\n  /**\n   * Alert before navigating away using browser's 'beforeunload' event\n   */\n  preventClose(e) {\n    if (this.pendingOptions) {\n      e.preventDefault();\n      return true;\n    }\n  }\n}\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport PollView from './components/PollView';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\nimport Poll from './models/Poll';\nimport PollOption from './models/PollOption';\nimport PostPoll from './components/PostPoll';\n\ninterface PusherPollDto {\n  pollId: string;\n  pollVoteCount: number;\n  options: { [key: string]: number };\n}\n\nexport default () => {\n  extend(CommentPost.prototype, 'content', function (content) {\n    const post = this.attrs.post;\n\n    if ((!post.isHidden() || this.revealContent) && post.polls()) {\n      for (const poll of post.polls()) {\n        if (poll) {\n          content.push(<PostPoll post={post} poll={poll} />);\n        }\n      }\n    }\n  });\n\n  extend(CommentPost.prototype, 'oninit', function () {\n    this.subtree.check(() => {\n      const polls = this.attrs.post.polls();\n\n      const checks = polls?.map?.(\n        (poll) =>\n          poll && [\n            poll.data?.attributes,\n            poll.options().map?.((option) => option?.data?.attributes),\n            poll.myVotes().map?.((vote) => vote.option()?.id()),\n          ]\n      );\n\n      return JSON.stringify(checks);\n    });\n  });\n\n  extend(DiscussionPage.prototype, 'oncreate', function () {\n    // @ts-ignore\n    if (app.pusher) {\n      // @ts-ignore\n      app.pusher.then((binding) => {\n        // We will listen for updates to all polls and options\n        // Even if that model is not in the current discussion, it doesn't really matter\n        binding.channels.main.bind('updatedPollOptions', (data: PusherPollDto) => {\n          const poll = app.store.getById<Poll>('polls', data['pollId']);\n\n          if (poll) {\n            poll.pushAttributes({\n              voteCount: data['pollVoteCount'],\n            });\n\n            // Not redrawing here, as the option below should trigger the redraw already\n          }\n\n          const changedOptions = data['options'];\n\n          for (const optionId in changedOptions) {\n            const option = app.store.getById<PollOption>('poll_options', optionId);\n\n            if (option && option.voteCount() !== undefined) {\n              option.pushAttributes({\n                voteCount: changedOptions[optionId],\n              });\n            }\n          }\n\n          m.redraw();\n        });\n      });\n    }\n  });\n\n  extend(DiscussionPage.prototype, 'onremove', function () {\n    // @ts-ignore\n    if (app.pusher) {\n      // @ts-ignore\n      app.pusher.then((binding) => {\n        binding.channels.main.unbind('updatedPollOptions');\n      });\n    }\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/PostControls'];","import Component, { ComponentAttrs } from 'flarum/common/Component';\nimport Poll from '../models/Poll';\nimport type Mithril from 'mithril';\nimport PollView from './PollView';\n\nexport interface PollShowcaseItemAttrs extends ComponentAttrs {\n  poll: Poll;\n}\n\nexport default class PollShowcaseItem extends Component<PollShowcaseItemAttrs> {\n  poll!: Poll;\n\n  oninit(vnode: Mithril.Vnode) {\n    super.oninit(vnode);\n\n    this.poll = this.attrs.poll;\n  }\n\n  view() {\n    return (\n      <div className=\"PollShowcase--item\">\n        <PollView poll={this.poll} />\n      </div>\n    );\n  }\n}\n","import Component, { ComponentAttrs } from 'flarum/common/Component';\nimport PollListState from '../states/PollListState';\nimport type Mithril from 'mithril';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport PollShowcaseItem from './PollShowcaseItem';\nimport Placeholder from 'flarum/common/components/Placeholder';\nimport app from 'flarum/forum/app';\n\nexport interface PollListAttrs extends ComponentAttrs {\n  state: PollListState;\n}\n\nexport default class PollShowcase extends Component<PollListAttrs, PollListState> {\n  oninit(vnode: Mithril.Vnode) {\n    super.oninit(vnode);\n\n    this.attrs.state.refresh();\n  }\n\n  view(): Mithril.Children {\n    return (\n      <div className=\"PollShowcase\">\n        <div className=\"PollShowcase--active\">\n          <h2 className=\"PollShowcase-title PollShowcase-title--active\">{app.translator.trans('fof-polls.forum.showcase.active-polls')}</h2>\n          {this.showcaseItems().toArray()}\n          {this.showcaseItems().toArray().length === 0 && <Placeholder text={app.translator.trans('fof-polls.forum.showcase.no-active-polls')} />}\n        </div>\n        <div className=\"PollShowcase--ended\">\n          <h2 className=\"PollShowcase-title PollShowcase-title--ended\">{app.translator.trans('fof-polls.forum.showcase.ended-polls')}</h2>\n          {this.endedItems().toArray()}\n          {this.endedItems().toArray().length === 0 && <Placeholder text={app.translator.trans('fof-polls.forum.showcase.no-recent-polls')} />}\n        </div>\n      </div>\n    );\n  }\n\n  showcaseItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    this.attrs.state.getPages().map((page) => {\n      page.items.map((poll) => {\n        if (!poll.hasEnded()) {\n          items.add('poll-active-' + poll.id(), <PollShowcaseItem poll={poll} />);\n        }\n      });\n    });\n\n    return items;\n  }\n\n  endedItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    this.attrs.state.getPages().map((page) => {\n      page.items.map((poll) => {\n        if (poll.hasEnded()) {\n          items.add('poll-ended-' + poll.id(), <PollShowcaseItem poll={poll} />);\n        }\n      });\n    });\n\n    return items;\n  }\n}\n","import app from 'flarum/forum/app';\nimport { IPageAttrs } from 'flarum/common/components/Page';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Mithril from 'mithril';\nimport PollListState from '../states/PollListState';\nimport extractText from 'flarum/common/utils/extractText';\nimport Button from 'flarum/common/components/Button';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport { AbstractPollPage } from './AbstractPollPage';\nimport PollShowcase from './PollShowcase';\n\nexport default class PollsShowcasePage extends AbstractPollPage {\n  oninit(vnode: Mithril.Vnode<IPageAttrs, PollListState>) {\n    super.oninit(vnode);\n\n    if (!app.forum.attribute<boolean>('globalPollsEnabled')) {\n      m.route.set('/');\n      return;\n    }\n\n    this.state = new PollListState({\n      sort: m.route.param('sort'),\n      filter: m.route.param('filter'),\n      include: this.includeParams(),\n    });\n\n    this.state.refresh();\n\n    app.setTitle(extractText(app.translator.trans('fof-polls.forum.page.nav')));\n  }\n\n  includeParams(): string[] {\n    return ['options', 'votes', 'myVotes', 'myVotes.option'];\n  }\n\n  contentItems(): ItemList<Mithril.Children> {\n    const items = super.contentItems();\n\n    if (!this.loading) {\n      items.add('poll-showcase', <PollShowcase state={this.state} />);\n    }\n\n    return items;\n  }\n\n  sidebarItems(): ItemList<Mithril.Children> {\n    const items = super.sidebarItems();\n    const canStartPoll = app.forum.attribute<boolean>('canStartGlobalPolls');\n\n    if (canStartPoll) {\n      items.remove('newDiscussion');\n      items.add(\n        'newGlobalPoll',\n        <Button\n          icon=\"fas fa-edit\"\n          className=\"Button Button--primary App-primaryControl PollsPage-newPoll\"\n          itemClassName=\"App-primaryControl\"\n          onclick={() => {\n            this.newPollAction();\n          }}\n          disabled={!canStartPoll}\n        >\n          {app.translator.trans(`fof-polls.forum.poll.${canStartPoll ? 'start_poll_button' : 'cannot_start_poll_button'}`)}\n        </Button>,\n        100\n      );\n    }\n\n    return items;\n  }\n\n  newPollAction(): void {\n    if (!app.session.user) {\n      app.modal.show(LogInModal);\n      return;\n    }\n\n    m.route.set(app.route('fof.polls.compose'));\n  }\n}\n","import CreatePollModal from './CreatePollModal';\nimport PostPoll from './PostPoll';\nimport EditPollModal from './EditPollModal';\nimport ListVotersModal from './ListVotersModal';\nimport PollForm from './PollForm';\nimport ComposePollHero from './ComposePollHero';\nimport ComposePollPage from './ComposePollPage';\nimport PollsPage from './PollsPage';\nimport PollView from './PollView';\nimport PollViewPage from './PollViewPage';\nimport PollSubmitButton from './Poll/PollSubmitButton';\nimport PollOption from './Poll/PollOption';\nimport PollOptions from './Poll/PollOptions';\nimport PollsShowcasePage from './PollsShowcasePage';\nimport PollShowcase from './PollShowcase';\nimport PollShowcaseItem from './PollShowcaseItem';\nimport { AbstractPollPage } from './AbstractPollPage';\nimport PollTitle from './Poll/PollTitle';\nimport PollSubtitle from './Poll/PollSubtitle';\nimport PollImage from './Poll/PollImage';\nimport PollListItem from './Poll/PollListItem';\nimport PollList from './Poll/PollList';\n\nexport const components = {\n  CreatePollModal,\n  PostPoll,\n  EditPollModal,\n  ListVotersModal,\n  PollForm,\n  ComposePollHero,\n  ComposePollPage,\n  PollsPage,\n  PollView,\n  PollViewPage,\n  PollSubmitButton,\n  PollOption,\n  PollOptions,\n  PollsShowcasePage,\n  PollShowcase,\n  PollShowcaseItem,\n  AbstractPollPage,\n  PollTitle,\n  PollSubtitle,\n  PollImage,\n  PollListItem,\n  PollList,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/computed'];","import Model from 'flarum/common/Model';\nimport PollOption from './PollOption';\nimport PollVote from './PollVote';\nimport computed from 'flarum/common/utils/computed';\n\nexport default class Poll extends Model {\n  public tempOptions: PollOption[] | undefined;\n\n  question() {\n    return Model.attribute<string>('question').call(this);\n  }\n\n  subtitle() {\n    return Model.attribute<string | null>('subtitle').call(this);\n  }\n\n  image() {\n    return Model.attribute<string | null>('image').call(this);\n  }\n\n  imageUrl() {\n    return Model.attribute<string | null>('imageUrl').call(this);\n  }\n\n  imageAlt() {\n    return Model.attribute<string | null>('imageAlt').call(this);\n  }\n\n  isImageUpload() {\n    return Model.attribute<boolean>('isImageUpload').call(this);\n  }\n\n  hasEnded() {\n    return Model.attribute<boolean>('hasEnded').call(this);\n  }\n\n  endDate() {\n    return Model.attribute('endDate', Model.transformDate).call(this);\n  }\n\n  publicPoll() {\n    return Model.attribute<boolean>('publicPoll').call(this);\n  }\n\n  hideVotes() {\n    return Model.attribute<boolean>('hideVotes').call(this);\n  }\n\n  allowChangeVote() {\n    return Model.attribute<boolean>('allowChangeVote').call(this);\n  }\n\n  allowMultipleVotes() {\n    return Model.attribute<boolean>('allowMultipleVotes').call(this);\n  }\n\n  maxVotes() {\n    return Model.attribute<number>('maxVotes').call(this);\n  }\n\n  voteCount() {\n    return Model.attribute<number>('voteCount').call(this);\n  }\n\n  canVote() {\n    return Model.attribute<boolean>('canVote').call(this);\n  }\n\n  canEdit() {\n    return Model.attribute<boolean>('canEdit').call(this);\n  }\n\n  canDelete() {\n    return Model.attribute<boolean>('canDelete').call(this);\n  }\n\n  canSeeVoters() {\n    return Model.attribute<boolean>('canSeeVoters').call(this);\n  }\n\n  canChangeVote() {\n    return Model.attribute<boolean>('canChangeVote').call(this);\n  }\n\n  options() {\n    const options = Model.hasMany<PollOption>('options').call(this);\n    return options ? (options as PollOption[]) : [];\n  }\n\n  votes() {\n    return Model.hasMany<PollVote>('votes').call(this);\n  }\n\n  myVotes(): PollVote[] {\n    const myVotes = Model.hasMany<PollVote>('myVotes').call(this);\n    return myVotes ? (myVotes as PollVote[]) : [];\n  }\n\n  isGlobal() {\n    return Model.attribute<boolean>('isGlobal').call(this);\n  }\n\n  isHidden() {\n    return computed<boolean, this>('hiddenAt', (hiddenAt) => !!hiddenAt).call(this);\n  }\n\n  // TODO: These two don't make sense as of now\n  isUnread() {\n    return false;\n  }\n\n  apiEndpoint() {\n    /** @ts-ignore */\n    return `/fof/polls${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\nimport Poll from './Poll';\nimport PollVote from './PollVote';\n\nexport default class PollOption extends Model {\n  answer() {\n    return Model.attribute<string>('answer').call(this);\n  }\n\n  imageUrl() {\n    return Model.attribute<string | null>('imageUrl').call(this);\n  }\n\n  isImageUpload() {\n    return Model.attribute<boolean>('isImageUpload').call(this);\n  }\n\n  voteCount() {\n    return Model.attribute<number>('voteCount').call(this);\n  }\n\n  poll() {\n    return Model.hasOne<Poll>('polls').call(this);\n  }\n\n  votes() {\n    return Model.hasMany<PollVote>('votes').call(this);\n  }\n\n  apiEndpoint() {\n    /** @ts-ignore */\n    return `/fof/polls/answers${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\nimport Poll from './Poll';\nimport PollOption from './PollOption';\nimport User from 'flarum/common/models/User';\n\nexport default class PollVote extends Model {\n  poll() {\n    return Model.hasOne<Poll>('poll').call(this);\n  }\n\n  option() {\n    const result = Model.hasOne<PollOption>('option').call(this);\n    return result === false ? null : result;\n  }\n\n  user() {\n    return Model.hasOne<User>('user').call(this);\n  }\n\n  pollId() {\n    return Model.attribute<number>('pollId').call(this);\n  }\n\n  optionId() {\n    return Model.attribute<number>('optionId').call(this);\n  }\n\n  apiEndpoint() {\n    return `/fof/polls/${this.pollId()}/vote`;\n  }\n}\n","import Poll from './Poll';\nimport PollOption from './PollOption';\nimport PollVote from './PollVote';\n\nexport const models = {\n  Poll,\n  PollOption,\n  PollVote,\n};\n","import PollFormState from './PollFormState';\nimport PollListState from './PollListState';\nimport PollState from './PollState';\n\nexport const states = {\n  PollFormState,\n  PollListState,\n  PollState,\n};\n","import PollControls from './PollControls';\n\nexport const utils = {\n  PollControls,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Forum'];","import Extend from 'flarum/common/extenders';\nimport Post from 'flarum/common/models/Post';\nimport Forum from 'flarum/common/models/Forum';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Poll from './models/Poll';\nimport PollOption from './models/PollOption';\nimport PollVote from './models/PollVote';\nimport PollsPage from './components/PollsPage';\nimport ComposePollPage from './components/ComposePollPage';\nimport PollViewPage from './components/PollViewPage';\nimport PollsShowcasePage from './components/PollsShowcasePage';\n\nexport default [\n  new Extend.Routes() //\n    .add('fof.polls.showcase', '/polls', PollsShowcasePage)\n    .add('fof.polls.list', '/polls/all', PollsPage)\n    .add('fof.polls.view', '/polls/view/:id', PollViewPage)\n    .add('fof.polls.compose', '/polls/composer', ComposePollPage),\n\n  new Extend.Store() //\n    .add('polls', Poll)\n    .add('poll_options', PollOption)\n    .add('poll_votes', PollVote),\n\n  new Extend.Model(Post) //\n    .hasMany<Poll>('polls')\n    .attribute<boolean>('canStartPoll'),\n\n  new Extend.Model(Forum) //\n    .attribute<boolean>('canStartPolls'),\n\n  new Extend.Model(Discussion) //\n    .attribute<boolean>('hasPoll')\n    .attribute<boolean>('canStartPoll'),\n];\n","import app from 'flarum/forum/app';\n\nimport addDiscussionBadge from './addDiscussionBadge';\nimport addComposerItems from './addComposerItems';\nimport addPollsToPost from './addPollsToPost';\nimport addPostControls from './addPostControls';\nimport addNavItem from './addNavItem';\n\nexport * from './components';\nexport * from './models';\nexport * from './states';\nexport * from './utils';\n\napp.initializers.add('fof/polls', () => {\n  addDiscussionBadge();\n  addComposerItems();\n  addPollsToPost();\n  addPostControls();\n  addNavItem();\n});\n\nexport { default as extend } from './extend';\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport PostControls from 'flarum/forum/utils/PostControls';\nimport CreatePollModal from './components/CreatePollModal';\nimport Button from 'flarum/common/components/Button';\nimport Post from 'flarum/common/models/Post';\nimport PollModelAttributes from './models/PollModelAttributes';\n\nexport default () => {\n  const createPoll = (post: Post) =>\n    app.modal.show(CreatePollModal, {\n      onsubmit: (data: PollModelAttributes) =>\n        app.store\n          .createRecord('polls')\n          .save(\n            {\n              ...data,\n              relationships: {\n                post,\n              },\n            },\n            {\n              data: {\n                include: 'options,myVotes,myVotes.option',\n              },\n            }\n          )\n          .then((poll) => {\n            // @ts-ignore\n            post.rawRelationship('polls')?.push?.({ type: 'polls', id: poll.id() });\n\n            return poll;\n          }),\n    });\n\n  extend(PostControls, 'moderationControls', function (items, post) {\n    // @ts-ignore\n    if (!post.isHidden() && post.canStartPoll()) {\n      items.add(\n        'addPoll',\n        <Button icon=\"fas fa-poll\" onclick={createPoll.bind(this, post)}>\n          {app.translator.trans('fof-polls.forum.moderation.add')}\n        </Button>\n      );\n    }\n  });\n};\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\n\nexport default function addNavItem() {\n  extend(IndexPage.prototype, 'navItems', (items) => {\n    if (!app.forum.attribute<boolean>('globalPollsEnabled')) {\n      return;\n    }\n\n    items.add(\n      'fof-polls-showcase',\n      LinkButton.component(\n        {\n          href: app.route('fof.polls.showcase'),\n          icon: 'fas fa-poll',\n        },\n        app.translator.trans('fof-polls.forum.page.nav')\n      ),\n      35\n    );\n\n    const showAllGlobalPolls = app.forum.attribute<boolean>('canStartGlobalPolls');\n\n    if (showAllGlobalPolls) {\n      items.add(\n        'fof-polls-list',\n        LinkButton.component(\n          {\n            href: app.route('fof.polls.list'),\n            icon: 'fas fa-list',\n          },\n          app.translator.trans('fof-polls.forum.page.nav-all')\n        ),\n        32\n      );\n    }\n  });\n}\n"],"names":["_typeof","require","_regeneratorRuntime","module","exports","e","__esModule","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","value","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","this","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","length","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","definition","key","get","obj","prop","flarum","core","compat","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","_setPrototypeOf","bind","_inheritsLoose","_getPrototypeOf","_isNativeReflectConstruct","Boolean","valueOf","Reflect","construct","_wrapNativeSuper","Map","toString","indexOf","isNativeFunction","has","set","Wrapper","isNativeReflectConstruct","FormError","_Error","props","PollFormState","poll","loading","deleting","expandedGroup","createNewPoll","app","createRecord","pushAttributes","question","endDate","publicPoll","allowMultipleVotes","hideVotes","allowChangeVote","maxVotes","tempOptions","_proto","isExpanded","groupKey","expand","m","redraw","save","_save","_callee","data","_context","attributes","options","_x","_delete2","_callee2","_context2","ComposePollHero","_Component","_this","_len","args","Array","_key","concat","oninit","vnode","attrs","view","className","trans","id","controlItems","toArray","items","ItemList","add","LinkButton","icon","itemClassName","href","exists","Component","ComposePollPage","_Page","_this2","attribute","bodyClass","editId","route","param","loadEditingPoll","_this2$poll","_this2$poll2","canEdit","_loadEditingPoll","alreadyLoaded","getById","find","LoadingIndicator","listItems","sidebarItems","PollForm","onsubmit","_onsubmit","state","isNew","alertAttrs","alertId","controls","Button","onclick","show","setTimeout","dismiss","_x2","_x3","SelectDropdown","buttonClassName","accessibleToggleLabel","navItems","IndexPage","Page","PollOption","option","hasVoted","totalVotes","votes","voted","canSeeVoteCount","answer","percent","Math","round","_this$poll$myVotes","overallVoteCount","voteCount","hasVotedFor","isDisabled","loadingOptions","canChangeVote","width","Number","myVotes","bar","style","showCheckMarks","checked","disabled","onchange","changeVote","optionDisplayItems","imageUrl","src","alt","classList","Tooltip","text","count","onremove","hideOptionTooltip","tooltipVisible","updateVisibility","PollOptions","pollOptions","createOptionView","PollImage","imageAlt","imageItems","_this$imageAlt","ListVotersModal","_Modal","include","title","content","map","optionContent","opt","filter","optionAnswer","voteContent","vote","user","Link","avatar","username","Modal","PollState","pendingSubmit","pendingOptions","useSubmitUI","showVoters","hasEnded","canVote","init","isShowResult","some","getMaxVotes","showButton","evt","target","LogInModal","optionIds","Set","isUnvoting","clear","size","submit","hasSelectedOptions","cb","onerror","_this3","url","body","from","res","pushPayload","err","PollSubmitButton","event","pollButtonSubmit","PollTitle","pollTitleItems","PollSubtitle","subtitle","pollSubtitleItems","PollView","preventClose","preventDefault","oncreate","window","addEventListener","removeEventListener","PollControls","controlsView","createMainView","createPollHeader","createPollContent","createPollFooter","createFormItems","infoItems","isEmpty","questionSlug","slug","Dropdown","menuClassName","class","time","dayjs","fromNow","max","toPropertyKey","toPrimitive","String","_defineProperties","_createClass","PollPageHero","wrapperClasses","classNames","Hero","AbstractPollPage","polls","pageContent","hero","mainContent","sidebar","contentItems","IndexPageHero","setContent","remove","toObject","startsWith","PollViewPage","_AbstractPollPage","item","PollListItem","subtree","highlightRegExp","SubtreeRetainer","freshness","markedAllAsReadAt","getTime","active","elementAttrs","isHidden","Slidable","contentView","slidableUnderneathView","isUnread","markAsRead","mainView","highlight","pollQuestion","pollSubtitle","slidableInstance","slidable","element","$","on","onbeforeupdate","needsRebuild","matches","lastVotedNumber","activeView","abbreviateNumber","PollList","params","getParams","isLoading","isInitialLoading","isLoadingNext","hasNext","loadNext","Placeholder","isSearchResults","getPages","pg","globalEventEmitter","EventEmitter","PollListState","_PaginatedListState","page","extraPolls","eventEmitter","deletePoll","requestParams","_this$params$sort","requestIncludes","sort","sortMap","q","includes","standard","join","loadPage","preloadedPolls","initialLoading","relevance","newest","oldest","removePoll","emit","_step","_iterator","_createForOfIteratorHelperLoose","pages","index","splice","addPoll","unshift","getAllItems","number","PaginatedListState","PollsPage","refresh","extractText","viewItems","actionItems","canStartPoll","newPollAction","context","section","itemName","Separator","pollControls","moderationControls","editAction","destructiveControls","canDelete","deleteAction","confirm","showDeletionAlert","back","location","reload","message","success","error","_extends","assign","UploadPollImageButton","_Button","uploadedImageUrl","fileName","$input","getImageUrl","canUpload","children","upload","appendTo","hide","trigger","FormData","append","files","resourceUrl","serialize","raw","failure","_this$attrs$poll","_this$attrs$option","_this3$attrs$poll","_this3$attrs$option","image","isImageUpload","_this$attrs$poll2","_this$attrs$option2","response","_this$attrs$onUpload","_this$attrs","_this$$input","fileUrl","onUpload","_this$$input2","optionAnswers","optionImageUrls","datepickerMinDate","_poll$tempOptions","Stream","formatDate","isAfter","fields","_this$state$poll","bidi","hasImage","uploadConditional","'['","pollImageUploadSuccess","placeholder","required","displayOptions","addOption","min","isBefore","Switch","imgFunc","pollOptionImageUploadSuccess","removeOption","alert","_this$dateToTimestamp","pollExists","pollImage","dateToTimestamp","t0","RequestError","console","date","def","dayjsDate","isValid","format","isUpload","ifCanUpload","uploadButton","imageUrlInput","_this$state$poll2","canUploadNow","CreatePollModal","onFormSubmit","_onFormSubmit","toPoll","pollOption","addToComposer","composer","extend","_this$composer$body","_discussion$canStartP","discussion","canStartPolls","EditPollModal","_CreatePollModal","PostPoll","canSeeVoters","viewOption","_poll$myVotes","_poll$myVotes2","_poll$myVotes3","_poll$myVotes4","showCheckmark","_this$attrs$poll$myVo","_this$attrs$poll$myVo2","post","sync","PollShowcaseItem","PollShowcase","showcaseItems","endedItems","PollsShowcasePage","includeParams","components","Poll","_Model","Model","isGlobal","computed","hiddenAt","apiEndpoint","PollVote","result","pollId","optionId","models","states","utils","Extend","Post","hasMany","Forum","Discussion","createPoll","DiscussionList","badges","hasPoll","Badge","label","DiscussionComposer","ReplyComposer","CommentPost","revealContent","check","checks","_poll$data","_poll$options$map","_poll$options","_poll$myVotes$map","_option$data","_vote$option","JSON","stringify","DiscussionPage","binding","channels","main","changedOptions","unbind","relationships","_post$rawRelationship","rawRelationship","PostControls"],"sourceRoot":""}