{"version":3,"file":"forum.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDR,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFf,EAAyBM,IACH,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,GAAO,G,sFCL9D,MAAM,EAA+BC,OAAOC,KAAKC,OAAO,a,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,iBCAlD,EAA+BF,OAAOC,KAAKC,OAAO,2B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,mC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCOxD,MCPM,EAA+BF,OAAOC,KAAKC,OAAO,0B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,uC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,kC,aCAzC,SAASC,EAAgBhB,EAAGiB,GAKzC,OAJAD,EAAkBf,OAAOiB,eAAiBjB,OAAOiB,eAAeC,OAAS,SAAyBnB,EAAGiB,GAEnG,OADAjB,EAAEoB,UAAYH,EACPjB,CACT,EACOgB,EAAgBhB,EAAGiB,EAC5B,CCLe,SAASI,EAAeC,EAAUC,GAC/CD,EAASf,UAAYN,OAAOuB,OAAOD,EAAWhB,WAC9Ce,EAASf,UAAUkB,YAAcH,EACjCJ,EAAeI,EAAUC,EAC3B,CCLA,MAAM,EAA+BV,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,2B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,yB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,uB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCSnCW,EAAe,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAAC,MAAA,KAAAC,YAAA,KAAAR,EAAAK,EAAAC,GAAA,IAAAG,EAAAJ,EAAAnB,UA0UjC,OA1UiCuB,EAClCC,OAAA,SAAOC,GAAO,IAAAC,EAAA,KACZN,EAAApB,UAAMwB,OAAMtB,KAAC,KAAAuB,GAEbE,KAAKC,QAAU,CAACC,IAAO,IAAKA,IAAO,KACnCF,KAAKG,gBAAkB,CAACD,IAAO,IAAKA,IAAO,KAE3CF,KAAKI,SAAWF,IAAO,IAEvBF,KAAKK,QAAUH,MAEfF,KAAKM,WAAaJ,KAAO,GACzBF,KAAKO,UAAYL,KAAO,GACxBF,KAAKQ,gBAAkBN,KAAO,GAC9BF,KAAKS,mBAAqBP,KAAO,GACjCF,KAAKU,SAAWR,IAAO,GAEvBF,KAAKW,kBAAoBX,KAAKY,gBAAWC,GAEzC,IAAQC,EAASd,KAAKe,MAAdD,KAGJA,GAAQE,MAAMC,QAAQH,EAAKb,WAC7BD,KAAKC,QAAU,GACfD,KAAKG,gBAAkB,GACvBW,EAAKb,QAAQiB,SAAQ,SAACC,GACpBpB,EAAKE,QAAQmB,KAAKlB,IAAOiB,EAAOE,SAChCtB,EAAKI,gBAAgBiB,KAAKlB,IAAOiB,EAAOG,UAC1C,IAEAtB,KAAKI,SAASU,EAAKV,UACnBJ,KAAKM,WAAWQ,EAAKR,YACrBN,KAAKO,UAAUO,EAAKP,WACpBP,KAAKQ,gBAAgBM,EAAKN,iBAC1BR,KAAKS,mBAAmBK,EAAKL,oBAC7BT,KAAKU,SAASI,EAAKJ,UAAY,GAE/BV,KAAKK,QAAQL,KAAKY,WAAWE,EAAKT,UAG9BL,KAAKK,WAAakB,MAAMT,EAAKT,SAASmB,QAAQD,WAChDvB,KAAKW,kBAAoBX,KAAKY,WAAWE,EAAKT,UAGpD,EAACT,EAED6B,MAAA,WACE,OAAOC,IAAAA,WAAeC,MAAM,kCAC9B,EAAC/B,EAEDgC,UAAA,WACE,MAAO,mCACT,EAAChC,EAEDiC,QAAA,WACE,MAAO,CACLC,EAAA,OAAKF,UAAU,cACbE,EAAA,OAAKF,UAAU,4BAA4B5B,KAAK+B,SAASC,YAG/D,EAACpC,EAEDmC,OAAA,WACE,IAAME,EAAQ,IAAIC,KA6IlB,OA3IAD,EAAME,IACJ,WACAL,EAAA,OAAKF,UAAU,cACbE,EAAA,SAAOF,UAAU,SAASF,IAAAA,WAAeC,MAAM,+CAE/CG,EAAA,SAAOM,KAAK,OAAOC,KAAK,WAAWT,UAAU,cAAcU,KAAMtC,KAAKI,YAExE,KAGF6B,EAAME,IACJ,UACAL,EAAA,OAAKF,UAAU,iCACbE,EAAA,SAAOF,UAAU,kCACfE,EAAA,YAAOJ,IAAAA,WAAeC,MAAM,wCAE3BY,IAAAA,UAAiB,CAChBX,UAAW,iCACXY,KAAM,cACNC,QAASzC,KAAK0C,UAAUzD,KAAKe,SAIhCA,KAAK2C,kBAER,IAGFV,EAAME,IACJ,OACAL,EAAA,OAAKF,UAAU,cACbE,EAAA,SAAOF,UAAU,SAASF,IAAAA,WAAeC,MAAM,2CAE/CG,EAAA,OAAKF,UAAU,mBACbE,EAAA,SACEF,UAAU,cACVQ,KAAK,iBACLC,KAAK,OACLC,KAAMtC,KAAKK,QACXuC,IAAK5C,KAAKW,kBACVkC,IAAK7C,KAAKY,WAAW,UAEtB2B,IAAAA,UAAiB,CAChBX,UAAW,2BACXY,KAAM,eACNC,QAASzC,KAAKK,QAAQpB,KAAKe,KAAM,SAIpCA,KAAKK,WACJyB,EAAA,KAAGF,UAAU,YACXE,EAAA,KAAGgB,MAAM,sBAAsB,IAE9BvB,MAAMvB,KAAKK,WAAW0C,SAASxB,SAC5BG,IAAAA,WAAeC,MAAM,8BACrBD,IAAAA,WAAeC,MAAM,iCAAkC,CAAEqB,KAAMzB,MAAMvB,KAAKK,WAAW4C,cAI/F,IAGFhB,EAAME,IACJ,SACAL,EAAA,OAAKF,UAAU,cACZsB,IAAAA,UACC,CACEC,MAAOnD,KAAKM,eAAgB,EAC5B8C,SAAUpD,KAAKM,YAEjBoB,IAAAA,WAAeC,MAAM,6CAGzB,IAGFM,EAAME,IACJ,aACAL,EAAA,OAAKF,UAAU,cACbE,EAACoB,IAAM,CAACC,MAAOnD,KAAKK,WAAaL,KAAKO,YAAa6C,SAAUpD,KAAKO,UAAW8C,UAAWrD,KAAKK,WAC1FqB,IAAAA,WAAeC,MAAM,4CAG1B,IAGFM,EAAME,IACJ,oBACAL,EAAA,OAAKF,UAAU,cACbE,EAACoB,IAAM,CAACC,MAAOnD,KAAKQ,kBAAmB4C,SAAUpD,KAAKQ,iBACnDkB,IAAAA,WAAeC,MAAM,mDAG1B,IAGFM,EAAME,IACJ,uBACAL,EAAA,OAAKF,UAAU,cACZsB,IAAAA,UACC,CACEC,MAAOnD,KAAKS,uBAAwB,EACpC2C,SAAUpD,KAAKS,oBAEjBiB,IAAAA,WAAeC,MAAM,sDAGzB,IAGE3B,KAAKS,sBACPwB,EAAME,IACJ,YACAL,EAAA,OAAKF,UAAU,cACbE,EAAA,SAAOF,UAAU,SAASF,IAAAA,WAAeC,MAAM,0CAE/CG,EAAA,SAAOM,KAAK,SAASQ,IAAI,IAAIC,IAAK7C,KAAKC,QAAQqD,OAAQjB,KAAK,WAAWT,UAAU,cAAcU,KAAMtC,KAAKU,WAE1GoB,EAAA,KAAGF,UAAU,YAAYF,IAAAA,WAAeC,MAAM,0CAEhD,IAIJM,EAAME,IACJ,SACAL,EAAA,OAAKF,UAAU,cACZW,IAAAA,UACC,CACEH,KAAM,SACNR,UAAW,gDACX2B,QAASvD,KAAKuD,SAEhB7B,IAAAA,WAAeC,MAAM,mCAGxB,IAGIM,CACT,EAACrC,EAED+C,eAAA,WAAiB,IAAAa,EAAA,KACf,OAAOzF,OAAO0F,KAAKzD,KAAKC,SAASyD,KAAI,SAACC,EAAIC,GAAC,OACzC9B,EAAA,OAAKF,UAAU,cACbE,EAAA,YAAUF,UAAU,qBAClBE,EAAA,SACEF,UAAU,cACVQ,KAAK,OACLC,KAAM,UAAYuB,EAAI,GACtBtB,KAAMkB,EAAKvD,QAAQ2D,GACnBC,YAAanC,IAAAA,WAAeC,MAAM,4CAA8C,MAAQiC,EAAI,KAE7FlC,IAAAA,MAAUoC,UAAU,wBACnBhC,EAAA,SACEF,UAAU,cACVQ,KAAK,OACLC,KAAM,eAAiBuB,EAAI,GAC3BtB,KAAMkB,EAAKrD,gBAAgByD,GAC3BC,YAAanC,IAAAA,WAAeC,MAAM,kDAAoD,MAAQiC,EAAI,KAElG,MAELA,GAAK,EACFrB,IAAAA,UAAiB,CACfH,KAAM,SACNR,UAAW,2CACXY,KAAM,eACNC,QAASmB,GAAK,EAAIJ,EAAKO,aAAa9E,KAAKuE,EAAMI,GAAK,KAEtD,GACA,GAEV,EAAChE,EAED8C,UAAA,WACE,IAAMG,EAAMmB,KAAKnB,IAAInB,IAAAA,MAAUoC,UAAU,kBAAmB,GAExD9D,KAAKC,QAAQqD,OAAST,GACxB7C,KAAKC,QAAQmB,KAAKlB,IAAO,KACzBF,KAAKG,gBAAgBiB,KAAKlB,IAAO,MAEjC+D,MAAMC,IAAYxC,IAAAA,WAAeC,MAAM,4BAA6B,CAAEkB,IAAAA,KAE1E,EAACjD,EAEDmE,aAAA,SAAa5C,GACXnB,KAAKC,QAAQkE,OAAOhD,EAAQ,GAC5BnB,KAAKG,gBAAgBgE,OAAOhD,EAAQ,EACtC,EAACvB,EAEDwE,KAAA,WAAO,IAAAC,EAAA,KACCvD,EAAO,CACXV,SAAUJ,KAAKI,WACfC,QAASL,KAAKsE,gBAAgBtE,KAAKK,WACnCC,WAAYN,KAAKM,aACjBC,UAAWP,KAAKO,YAChBC,gBAAiBR,KAAKQ,kBACtBC,mBAAoBT,KAAKS,qBACzBC,SAAUV,KAAKU,WACfT,QAAS,IAYX,OATAD,KAAKC,QAAQiB,SAAQ,SAACG,EAAQkD,GACxBlD,KACFP,EAAKb,QAAQmB,KAAK,CAChBC,OAAQA,IACRC,SAAU+C,EAAKlE,gBAAgBoE,MAGrC,IAEwB,KAApBvE,KAAKI,YACP6D,MAAMvC,IAAAA,WAAeC,MAAM,2CAEpB,MAGLb,EAAKb,QAAQqD,OAAS,GACxBW,MAAMvC,IAAAA,WAAeC,MAAM,8BAEpB,MAGFb,CACT,EAAClB,EAED4E,SAAA,SAASC,GAAG,IAAAC,EAAA,KACVD,EAAEE,iBAEF,IAAMP,EAAOpE,KAAKoE,OAElB,GAAa,OAATA,EAAJ,CAIA,IAAMQ,EAAU5E,KAAKe,MAAMyD,SAASJ,GAEhCQ,aAAmBC,SACrB7E,KAAKuD,SAAU,EAEfqB,EAAQE,KAAK9E,KAAK+E,KAAK9F,KAAKe,OAAO,SAACgF,GAClCC,QAAQC,MAAMF,GACdN,EAAKS,QAAQH,GACbN,EAAKU,QACP,KAEA1D,IAAAA,MAAU2D,OAbZ,CAeF,EAACzF,EAEDgB,WAAA,SAAW0E,EAAMC,QAAG,IAAHA,IAAAA,GAAM,GACrB,IAAMC,EAAYjE,MAAM+D,GAExB,OAAa,IAATA,GAAmBE,EAAUC,UAE1BD,EAAUE,OAAO,qBAFmC,IAARH,EAAgBvF,KAAKY,WAAW2E,GAAO,IAG5F,EAAC3F,EAED0E,gBAAA,SAAgBgB,GACd,IAAME,EAAYjE,MAAM+D,GAExB,SAAKA,IAASE,EAAUC,YAEjBD,EAAUE,QACnB,EAAClG,CAAA,CA1UiC,CAASmG,KCAhCC,EAAgB,SAACC,GAC5BA,EAASxH,UAAUyH,QAAU,WAAY,IAAA/F,EAAA,KACvC2B,IAAAA,MAAUqE,KAAKvG,EAAiB,CAC9BsB,KAAMd,KAAK6F,SAAS9D,OAAOjB,KAC3B0D,SAAU,SAAC1D,GAAI,OAAMf,EAAK8F,SAAS9D,OAAOjB,KAAOA,CAAI,GAEzD,GAGAkF,EAAAA,EAAAA,QAAOH,EAASxH,UAAW,eAAe,SAAU4D,GAAO,IAAAgE,EAAAC,EAAAC,EACnDC,EAA+B,OAArBH,EAAGjG,KAAK6F,SAASQ,OAAW,OAAPH,EAAlBD,EAAoBlF,YAAF,EAAlBmF,EAA2BE,YACC,OAA7BD,EAAa,MAAVC,OAAU,EAAVA,EAAYE,gBAAcH,EAAIzE,IAAAA,MAAU6E,kBAG3DtE,EAAME,IACJ,QACAL,EAAA,KAAGF,UAAU,oBAAoBa,QAASzC,KAAK8F,QAAQ7G,KAAKe,OAC1D8B,EAAA,QAAMF,UAAW4E,IAAU,aAAcxG,KAAK6F,SAAS9D,OAAOjB,MAAQ,SACnEY,IAAAA,WAAeC,MAAM,wCAAuC3B,KAAK6F,SAAS9D,OAAOjB,KAAO,OAAS,OAAK,WAG3G,EAGN,KAEAkF,EAAAA,EAAAA,QAAOH,EAASxH,UAAW,QAAQ,SAAU+F,GACvCpE,KAAK6F,SAAS9D,OAAOjB,OACvBsD,EAAKtD,KAAOd,KAAK6F,SAAS9D,OAAOjB,KAErC,GACF,EAEA,MC1CM,EAA+BnC,OAAOC,KAAKC,OAAO,gC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,oB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,+B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,yB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,2B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,0B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,sC,aCSnC4H,EAAe,SAAAhH,GAAA,SAAAgH,IAAA,OAAAhH,EAAAC,MAAA,KAAAC,YAAA,KAAAR,EAAAsH,EAAAhH,GAAA,IAAAG,EAAA6G,EAAApI,UAmDjC,OAnDiCuB,EAClCC,OAAA,SAAOC,GAAO,IAAAC,EAAA,KACZN,EAAApB,UAAMwB,OAAMtB,KAAC,KAAAuB,GAEbE,KAAKuD,QAAUrD,KAAO,GAEtBwB,IAAAA,MACGgF,KAAK,YAAa1G,KAAKe,MAAMD,KAAK6F,KAAM,CACvCC,QAAS,kCAEV9B,MAAK,kBAAM/E,EAAKwD,SAAQ,EAAM,IAAC,SACvB,kBAAMzB,EAAE+E,QAAQ,GAC7B,EAACjH,EAEDgC,UAAA,WACE,MAAO,0BACT,EAAChC,EAED6B,MAAA,WACE,OAAOC,IAAAA,WAAeC,MAAM,oCAC9B,EAAC/B,EAEDiC,QAAA,WACE,OAAOC,EAAA,OAAKF,UAAU,cAAc5B,KAAKuD,UAAYzB,EAACgF,IAAgB,MAAM9G,KAAKe,MAAMD,KAAKb,UAAUyD,IAAI1D,KAAK+G,cAAc9H,KAAKe,OACpI,EAACJ,EAEDmH,cAAA,SAAcC,GACZ,IAAMC,GAASjH,KAAKe,MAAMD,KAAKmG,SAAW,IAAIC,QAAO,SAACC,GAAC,OAAKH,EAAIL,OAASQ,EAAEhG,SAASwF,IAAI,IAExF,OACE7E,EAAA,OAAKF,UAAU,qBACbE,EAAA,UAAKkF,EAAI3F,SAAW,KAEnB4F,EAAM3D,OACLxB,EAAA,OAAKF,UAAU,mBAAmBqF,EAAMvD,IAAI1D,KAAKoH,YAAYnI,KAAKe,QAElE8B,EAAA,UAAKJ,IAAAA,WAAeC,MAAM,oCAIlC,EAAC/B,EAEDwH,YAAA,SAAYC,GACV,IAAMC,EAAOD,EAAKC,OACZvG,EAAQuG,GAAQ,CAAEC,KAAM7F,IAAAA,MAAU4F,KAAKA,IAE7C,OACExF,EAAC0F,IAASzG,EACP0G,IAAOH,GAAM,IAAEI,IAASJ,GAG/B,EAACb,CAAA,CAnDiC,CAASd,KCT7C,MAAM,EAA+BhH,OAAOC,KAAKC,OAAO,6B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,uB,aCOnC8I,EAAa,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAAlI,MAAA,KAAAC,YAAA,KAAAR,EAAAwI,EAAAC,GAAA,IAAAhI,EAAA+H,EAAAtJ,UAqH/B,OArH+BuB,EAChCC,OAAA,SAAOC,GACL8H,EAAAvJ,UAAMwB,OAAMtB,KAAC,KAAAuB,GAEbE,KAAKc,KAAOd,KAAKe,MAAMD,KAEvBd,KAAKC,QAAUD,KAAKc,KAAKb,UACzBD,KAAK6H,cAAgB7H,KAAKC,QAAQyD,KAAI,SAAC5F,GAAC,OAAKoC,IAAOpC,EAAEuD,SAAS,IAC/DrB,KAAKG,gBAAkBH,KAAKC,QAAQyD,KAAI,SAAC5F,GAAC,OAAKoC,IAAOpC,EAAEwD,WAAW,IACnEtB,KAAKI,SAAWF,IAAOF,KAAKc,KAAKV,YACjCJ,KAAKK,QAAUH,IAAOF,KAAKY,WAAWZ,KAAKc,KAAKT,YAChDL,KAAKM,WAAaJ,IAAOF,KAAKc,KAAKR,cACnCN,KAAKS,mBAAqBP,IAAOF,KAAKc,KAAKL,sBAC3CT,KAAKO,UAAYL,IAAOF,KAAKc,KAAKP,aAClCP,KAAKQ,gBAAkBN,IAAOF,KAAKc,KAAKN,mBACxCR,KAAKU,SAAWR,IAAOF,KAAKc,KAAKJ,YAAc,GAE3CV,KAAKK,WAAakB,MAAMvB,KAAKc,KAAKT,WAAWmB,QAAQD,WACvDvB,KAAKW,kBAAoBX,KAAKY,WAAWZ,KAAKK,WAElD,EAACT,EAED6B,MAAA,WACE,OAAOC,IAAAA,WAAeC,MAAM,mCAC9B,EAAC/B,EAED+C,eAAA,WAAiB,IAAA5C,EAAA,KACf,OAAOC,KAAKC,QAAQyD,KAAI,SAACsD,EAAKpD,GAAC,OAC7B9B,EAAA,OAAKF,UAAU,cACbE,EAAA,YAAUF,UAAU,qBAClBE,EAAA,SACEF,UAAU,cACVQ,KAAK,OACLC,KAAM,UAAYuB,EAAI,GACtBtB,KAAMvC,EAAK8H,cAAcjE,GACzBC,YAAanC,IAAAA,WAAeC,MAAM,4CAA8C,MAAQiC,EAAI,KAE7FlC,IAAAA,MAAUoC,UAAU,wBACnBhC,EAAA,SACEF,UAAU,cACVQ,KAAK,OACLC,KAAM,eAAiBuB,EAAI,GAC3BtB,KAAMvC,EAAKI,gBAAgByD,GAC3BC,YAAanC,IAAAA,WAAeC,MAAM,kDAAoD,MAAQiC,EAAI,KAElG,MAGLA,GAAK,EACFrB,IAAAA,UAAiB,CACfH,KAAM,SACNR,UAAW,2BACXY,KAAM,eACNC,QAASmB,GAAK,EAAI7D,EAAKgE,aAAa9E,KAAKc,EAAM6D,GAAK,KAEtD,GACA,GAEV,EAAChE,EAED8C,UAAA,WACE,IAAMG,EAAMmB,KAAKnB,IAAInB,IAAAA,MAAUoC,UAAU,kBAAmB,GAExD9D,KAAKC,QAAQqD,OAAST,GACxB7C,KAAKC,QAAQmB,KAAKM,IAAAA,MAAUoG,aAAa,iBACzC9H,KAAK6H,cAAczG,KAAKlB,IAAO,KAC/BF,KAAKG,gBAAgBiB,KAAKlB,IAAO,MAEjC+D,MAAMC,IAAYxC,IAAAA,WAAeC,MAAM,4BAA6B,CAAEkB,IAAAA,KAE1E,EAACjD,EAEDmE,aAAA,SAAaH,GACX5D,KAAKC,QAAQkE,OAAOP,EAAG,GACvB5D,KAAK6H,cAAc1D,OAAOP,EAAG,GAC7B5D,KAAKG,gBAAgBgE,OAAOP,EAAG,EACjC,EAAChE,EAEDwE,KAAA,WAAO,IAAAZ,EAAA,KACCvD,EAAUD,KAAKC,QAAQyD,KAAI,SAAC5F,EAAG8F,GAMnC,OALK9F,EAAEsG,KAAK2D,aAAYjK,EAAEsG,KAAK2D,WAAa,CAAC,GAE7CjK,EAAEsG,KAAK2D,WAAW1G,OAASmC,EAAKqE,cAAcjE,KAC9C9F,EAAEsG,KAAK2D,WAAWzG,SAAWkC,EAAKrD,gBAAgByD,KAE3C9F,EAAEsG,IACX,IAEA,MAAO,CACLhE,SAAUJ,KAAKI,WACfC,QAASL,KAAKsE,gBAAgBtE,KAAKK,WACnCC,WAAYN,KAAKM,aACjBC,UAAWP,KAAKO,YAChBC,gBAAiBR,KAAKQ,kBACtBC,mBAAoBT,KAAKS,qBACzBC,SAAUV,KAAKU,WACfT,QAAAA,EAEJ,EAACL,EAED4E,SAAA,SAASC,GAAG,IAAAJ,EAAA,KAGV,GAFAI,EAAEE,kBAEE3E,KAAKuD,QAIT,OAFAvD,KAAKuD,SAAU,EAERvD,KAAKc,KACTkH,KAAKhI,KAAKoE,QACVU,MAAK,WACJT,EAAKU,OACLjD,EAAE+E,QACJ,IAAE,OACK,SAACpC,GACNJ,EAAKe,SACLf,EAAKc,QAAQV,EACf,GACJ,EAACkD,CAAA,CArH+B,CAASnI,GCKtByI,GAAQ,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAAxI,MAAA,KAAAC,YAAA,KAAAR,EAAA8I,EAAAC,GAAA,IAAAtI,EAAAqI,EAAA5J,UA+Q1B,OA/Q0BuB,EAC3BC,OAAA,SAAOC,GAAO,IAAAqI,EAAAC,EACZF,EAAA7J,UAAMwB,OAAMtB,KAAC,KAAAuB,GAEbE,KAAKqI,gBAAiB,EAEtBrI,KAAKsI,cAA8B,OAAhBH,EAACnI,KAAKe,MAAMD,OAAXqH,EAAiBI,mBAAkC,OAAnBH,EAAIpI,KAAKe,MAAMD,WAAI,EAAfsH,EAAiB3H,sBACzET,KAAKwI,eAAgB,EACrBxI,KAAKyI,eAAiB,IACxB,EAAC7I,EAED8I,SAAA,SAAS5I,GACPoI,EAAA7J,UAAMqK,SAAQnK,KAAC,KAAAuB,GAEfE,KAAK2I,aAAe3I,KAAK2I,aAAa1J,KAAKe,MAC3C4I,OAAOC,iBAAiB,eAAgB7I,KAAK2I,aAC/C,EAAC/I,EAEDkJ,SAAA,SAAShJ,GACPoI,EAAA7J,UAAMyK,SAAQvK,KAAC,KAAAuB,GAEf8I,OAAOG,oBAAoB,eAAgB/I,KAAK2I,aAClD,EAAC/I,EAEDoJ,KAAA,WACE,IAAMlI,EAAOd,KAAKe,MAAMD,KAClBb,EAAUa,EAAKb,WAAa,GAC9BS,EAAWI,EAAKL,qBAAuBK,EAAKJ,WAAa,EAE5C,IAAbA,IAAgBA,EAAWT,EAAQqD,QAEvC,IAAM2F,EAAYjJ,KAAKiJ,UAAUvI,GAEjC,OACEoB,EAAA,OAAKF,UAAU,YAAY,UAASd,EAAK6F,MACvC7E,EAAA,OAAKF,UAAU,eACbE,EAAA,MAAIF,UAAU,qBAAqBd,EAAKV,YAEvCU,EAAKoI,gBACJpH,EAACqH,IAAO,CAACC,KAAM1H,IAAAA,WAAeC,MAAM,gCAClCG,EAACS,IAAM,CAACX,UAAU,4BAA4Ba,QAASzC,KAAKqJ,WAAWpK,KAAKe,MAAOwC,KAAK,iBAI3F1B,EAAKwI,WACJxH,EAACqH,IAAO,CAACC,KAAM1H,IAAAA,WAAeC,MAAM,oCAClCG,EAACS,IAAM,CAACX,UAAU,0BAA0Ba,QAASf,IAAAA,MAAUqE,KAAK9G,KAAKyC,IAAAA,MAAWiG,EAAe,CAAE7G,KAAAA,IAAS0B,KAAK,gBAGtH1B,EAAKyI,aACJzH,EAACqH,IAAO,CAACC,KAAM1H,IAAAA,WAAeC,MAAM,sCAClCG,EAACS,IAAM,CAACX,UAAU,4BAA4Ba,QAASzC,KAAKwJ,WAAWvK,KAAKe,MAAOwC,KAAK,mBAK9FV,EAAA,WACEA,EAAA,OAAKF,UAAU,eAAe3B,EAAQyD,IAAI1D,KAAKyJ,WAAWxK,KAAKe,QAE/D8B,EAAA,OAAKF,UAAU,gBACXqH,EAAUS,WAAa5H,EAAA,OAAKF,UAAU,yBAAyBqH,EAAUjH,WAE1EhC,KAAKsI,aAAetI,KAAKwI,eACxB1G,EAACS,IAAM,CAACX,UAAU,qCAAqC2B,QAASvD,KAAKqI,eAAgB5F,QAASzC,KAAKwE,SAASvF,KAAKe,OAC9G0B,IAAAA,WAAeC,MAAM,yCAOpC,EAAC/B,EAEDqJ,UAAA,SAAUvI,GAAU,IAAAiJ,EACZ1H,EAAQ,IAAIC,KACZpB,EAAOd,KAAKe,MAAMD,KAClB8I,GAAyB,OAAdD,EAAA7I,EAAK+I,gBAAS,EAAdF,EAAgBrG,QAAS,EA4C1C,OA1CI5B,IAAAA,QAAY4F,MAASxG,EAAKgJ,WAAchJ,EAAKiJ,YAC/C9H,EAAME,IACJ,gBACAL,EAAA,YACEA,EAAA,KAAGF,UAAU,mCACZF,IAAAA,WAAeC,MAAM,mCAKxBb,EAAKT,WACP4B,EAAME,IACJ,WACAL,EAAA,YACEA,EAAA,KAAGgB,MAAM,4BACRhC,EAAKiJ,WACFrI,IAAAA,WAAeC,MAAM,8BACrBD,IAAAA,WAAeC,MAAM,iCAAkC,CAAEqB,KAAMzB,MAAMT,EAAKT,WAAW4C,cAK3FnC,EAAKgJ,YACP7H,EAAME,IACJ,YACAL,EAAA,YACEA,EAAA,KAAGF,UAAU,2BACZF,IAAAA,WAAeC,MAAM,oCAAqC,CAAEkB,IAAKnC,MAIjEI,EAAKyH,iBACRtG,EAAME,IACJ,qBACAL,EAAA,YACEA,EAAA,KAAGF,UAAS,gBAAiBgI,EAAW,QAAU,eAAa,kBAC9DlI,IAAAA,WAAeC,MAAM,8CAMvBM,CACT,EAACrC,EAED6J,WAAA,SAAWzC,GAAK,IAAAgD,EAAAC,EAAAC,EACRpJ,EAAOd,KAAKe,MAAMD,KAClB8I,GAAyB,OAAdI,EAAAlJ,EAAK+I,gBAAS,EAAdG,EAAgB1G,QAAS,EACpC6G,EAAarJ,EAAKsJ,YAElBC,EAAQrK,KAAKyI,eAAiBzI,KAAKyI,eAAe6B,IAAItD,EAAIL,MAAsB,OAAjBsD,EAAGnJ,EAAK+I,YAAe,MAApBI,EAAgBM,UAAF,EAAdN,EAAgBM,MAAO,SAAClD,GAAI,OAAKA,EAAKlG,WAAa6F,CAAG,IACxHC,EAAQD,EAAIoD,YACZI,EAAUL,EAAa,EAAInG,KAAKyG,MAAOxD,EAAQkD,EAAc,KAAO,EAGpEO,EAAmC,iBAAVzD,EACzB0D,EAAa3K,KAAKqI,gBAAmBuB,IAAa9I,EAAKyH,gBACvDqC,EAAQF,EAAkBF,EAAWK,OAAOR,KAAwB,OAAdH,EAAApJ,EAAK+I,gBAAS,EAAdK,EAAgB5G,SAAU,GAAM,IAEtFwH,GAAiBpJ,IAAAA,QAAY4F,OAAUxG,EAAKiJ,YAAcjJ,EAAKgJ,aAAeF,GAAY9I,EAAKyH,iBAE/FwC,EACJjJ,EAAA,OAAKF,UAAU,UAAU,kBAAiByI,EAAOW,MAAK,wBAA0BJ,EAAK,KAClFE,GACChJ,EAAA,SAAOF,UAAU,gCACfE,EAAA,SAAOsB,SAAUpD,KAAKiL,WAAWhM,KAAKe,KAAMgH,GAAM5E,KAAK,WAAW8I,QAASb,EAAOhH,SAAUsH,IAC5F7I,EAAA,QAAMF,UAAU,eAIpBE,EAAA,OAAKF,UAAU,mBACbE,EAAA,QAAMF,UAAU,0BAA0BoF,EAAI3F,UAC7CgJ,IAAUS,GAAiBtI,IAAK,sBAAuB,CAAEZ,UAAW,qBACpE8I,GAAmB5I,EAAA,QAAMF,UAAW4E,IAAU,cAA2B,MAAZgE,GAAmB,wBAAyBA,EAAQ,MAGnHxD,EAAI1F,WAAaQ,EAAA,OAAKF,UAAU,mBAAmBuJ,IAAKnE,EAAI1F,WAAY8J,IAAKpE,EAAI3F,WAAe,MAIrG,OACES,EAAA,OACEF,UAAW4E,IAAU,aAAcoD,GAAY,YAAa9I,EAAKiJ,YAAc,YAAa/C,EAAI1F,YAAc,uBAC9G,UAAS0F,EAAIL,MAEZ+D,EACC5I,EAACqH,IAAO,CAACC,KAAM1H,IAAAA,WAAeC,MAAM,gCAAiC,CAAE0J,MAAOpE,IAAU6B,SAAU9I,KAAKsL,mBACpGP,GAGHA,EAIR,EAACnL,EAEDqL,WAAA,SAAW9J,EAAQoK,GAAK,IAAAC,EAAAC,EACtB,IAAK/J,IAAAA,QAAY4F,KAGf,OAFA5F,IAAAA,MAAUqE,KAAK2F,UACfH,EAAII,OAAOT,SAAU,GAIvB,IAAMU,EAAY5L,KAAKyI,gBAAkB,IAAIoD,IAAiC,OAA9BL,GAACC,EAAAzL,KAAKe,MAAMD,KAAK+I,WAAUnG,UAAG,EAA7B8H,EAAAjN,KAAAkN,GAAgC,SAACtE,GAAC,OAAKA,EAAEhG,SAASwF,IAAI,KACjGmF,EAAaF,EAAS,OAAQzK,EAAOwF,MAW3C,OAVuB3G,KAAKe,MAAMD,KAAKL,sBAGrCmL,EAAUG,QAGPD,GACHF,EAAUzJ,IAAIhB,EAAOwF,MAGnB3G,KAAKsI,aACPtI,KAAKyI,eAAiBmD,EAAUI,KAAOJ,EAAY,UACnD5L,KAAKwI,gBAAkBxI,KAAKyI,iBAIvBzI,KAAKiM,OAAOL,EAAW,MAAM,kBAAOL,EAAII,OAAOT,QAAUY,CAAU,GAC5E,EAAClM,EAED4E,SAAA,WAAW,IAAAzE,EAAA,KACT,OAAOC,KAAKiM,OAAOjM,KAAKyI,gBAAgB,WACtC1I,EAAK0I,eAAiB,KACtB1I,EAAKyI,eAAgB,CACvB,GACF,EAAC5I,EAEDqM,OAAA,SAAOL,EAAWM,EAAI/G,GAAS,IAAA3B,EAAA,KAI7B,OAHAxD,KAAKqI,gBAAiB,EACtBvG,EAAE+E,SAEKnF,IAAAA,QACI,CACPyK,OAAQ,QACRC,IAAQ1K,IAAAA,MAAUoC,UAAU,UAAS,cAAc9D,KAAKe,MAAMD,KAAK6F,KAAI,SACvEN,KAAM,CACJjC,KAAM,CACJwH,UAAW5K,MAAMqL,KAAKT,OAI3B9G,MAAK,SAACwH,GACL5K,IAAAA,MAAU6K,YAAYD,GACpB,MAAFJ,GAAAA,GACF,IAAE,OACK,SAAClH,GACC,MAAPG,GAAAA,EAAUH,EACZ,IAAE,SACO,WACPxB,EAAK6E,gBAAiB,EAEtBvG,EAAE+E,QACJ,GACJ,EAACjH,EAEDyJ,WAAA,WAEE3H,IAAAA,MAAUqE,KAAKU,EAAiB,CAC9B3F,KAAMd,KAAKe,MAAMD,KACjB0L,KAAMxM,KAAKe,MAAMyL,MAErB,EAAC5M,EAED4J,WAAA,WACMiD,QAAQ/K,IAAAA,WAAeC,MAAM,+CAC/B3B,KAAKe,MAAMD,KAAI,SAAUgE,MAAK,WAC5BhD,EAAE+E,OAAO6F,MACX,GAEJ,EAEA9M,EAKA0L,kBAAA,SAAkBxL,GAChBA,EAAMiB,MAAM4L,gBAAiB,EAC7B7M,EAAMqD,MAAMyJ,kBACd,EAEAhN,EAGA+I,aAAA,SAAalE,GACX,GAAIzE,KAAKyI,eAEP,OADAhE,EAAEE,kBACK,CAEX,EAACsD,CAAA,CA/Q0B,CAAS4E,KCZtC,MAAM,GAA+BlO,OAAOC,KAAKC,OAAO,mC,0HCAzC,SAASiO,KAYtB,OAXAA,GAAW/O,OAAOgP,OAAShP,OAAOgP,OAAO9N,OAAS,SAAU0M,GAC1D,IAAK,IAAI/H,EAAI,EAAGA,EAAIjE,UAAU2D,OAAQM,IAAK,CACzC,IAAIoJ,EAASrN,UAAUiE,GACvB,IAAK,IAAI/F,KAAOmP,EACVjP,OAAOM,UAAUC,eAAeC,KAAKyO,EAAQnP,KAC/C8N,EAAO9N,GAAOmP,EAAOnP,GAG3B,CACA,OAAO8N,CACT,EACOmB,GAASpN,MAAMM,KAAML,UAC9B,CCbA,MAAM,GAA+BhB,OAAOC,KAAKC,OAAO,4B,eCK3CoO,GAAa,CACxBzN,gBAAAA,EACAyI,SAAAA,GACAN,cAAAA,EACAlB,gBAAAA,GCTF,MAAM,GAA+B9H,OAAOC,KAAKC,OAAO,gB,eCEnCqO,GAAI,SAAAC,GAAA,SAAAD,IAAA,QAAAnN,EAAAqN,EAAAzN,UAAA2D,OAAA+J,EAAA,IAAArM,MAAAoM,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAAD,EAAAC,GAAA3N,UAAA2N,GAqBW,OArBXvN,EAAAoN,EAAA5O,KAAAmB,MAAAyN,EAAA,OAAAI,OAAAF,KAAA,MACvBjN,SAAWoN,KAAAA,UAAgB,YAAWzN,EACtCgK,SAAWyD,KAAAA,UAAgB,YAAWzN,EACtCM,QAAUmN,KAAAA,UAAgB,WAAUzN,EAEpCO,WAAakN,KAAAA,UAAgB,cAAazN,EAC1CQ,UAAYiN,KAAAA,UAAgB,aAAYzN,EACxCS,gBAAkBgN,KAAAA,UAAgB,mBAAkBzN,EACpDU,mBAAqB+M,KAAAA,UAAgB,sBAAqBzN,EAC1DW,SAAW8M,KAAAA,UAAgB,YAAWzN,EAEtCqK,UAAYoD,KAAAA,UAAgB,aAAYzN,EAExC+J,QAAU0D,KAAAA,UAAgB,WAAUzN,EACpCuJ,QAAUkE,KAAAA,UAAgB,WAAUzN,EACpCwJ,UAAYiE,KAAAA,UAAgB,aAAYzN,EACxCmJ,aAAesE,KAAAA,UAAgB,gBAAezN,EAC9CwI,cAAgBiF,KAAAA,UAAgB,iBAAgBzN,EAEhDE,QAAUuN,KAAAA,QAAc,WAAUzN,EAClCkH,MAAQuG,KAAAA,QAAc,SAAQzN,EAC9B8J,QAAU2D,KAAAA,QAAc,WAAUzN,CAAA,CAIjC,OAzBsBZ,EAAA+N,EAAAC,GAqBWD,EAAA7O,UAElCoP,YAAA,WACE,MAAO,cAAazN,KAAK0N,OAAS,IAAI1N,KAAKoE,KAAKuC,GAAO,GACzD,EAACuG,CAAA,CAzBsB,CAASM,MCAbG,GAAU,SAAAR,GAAA,SAAAQ,IAAA,QAAA5N,EAAAqN,EAAAzN,UAAA2D,OAAA+J,EAAA,IAAArM,MAAAoM,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAAD,EAAAC,GAAA3N,UAAA2N,GAMC,OANDvN,EAAAoN,EAAA5O,KAAAmB,MAAAyN,EAAA,OAAAI,OAAAF,KAAA,MAC7BhM,OAASmM,KAAAA,UAAgB,UAASzN,EAClCuB,SAAWkM,KAAAA,UAAgB,YAAWzN,EACtCqK,UAAYoD,KAAAA,UAAgB,aAAYzN,EAExCe,KAAO0M,KAAAA,OAAa,SAAQzN,EAC5BkH,MAAQuG,KAAAA,QAAc,SAAQzN,CAAA,CAI7B,OAV4BZ,EAAAwO,EAAAR,GAMCQ,EAAAtP,UAE9BoP,YAAA,WACE,MAAO,sBAAqBzN,KAAK0N,OAAS,IAAI1N,KAAKoE,KAAKuC,GAAO,GACjE,EAACgH,CAAA,CAV4B,CAASH,MCAnBI,GAAQ,SAAAT,GAAA,SAAAS,IAAA,QAAA7N,EAAAqN,EAAAzN,UAAA2D,OAAA+J,EAAA,IAAArM,MAAAoM,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAAD,EAAAC,GAAA3N,UAAA2N,GAMW,OANXvN,EAAAoN,EAAA5O,KAAAmB,MAAAyN,EAAA,OAAAI,OAAAF,KAAA,MAC3BvM,KAAO0M,KAAAA,OAAa,QAAOzN,EAC3BoB,OAASqM,KAAAA,OAAa,UAASzN,EAC/BuH,KAAOkG,KAAAA,OAAa,QAAOzN,EAE3B8N,OAASL,KAAAA,UAAgB,UAASzN,EAClC+N,SAAWN,KAAAA,UAAgB,YAAWzN,CAAA,CAIrC,OAV0BZ,EAAAyO,EAAAT,GAMWS,EAAAvP,UAEtCoP,YAAA,WACE,MAAO,cAAczN,KAAK6N,SAAQ,OACpC,EAACD,CAAA,CAV0B,CAASJ,MCEzBO,GAAS,CACpBb,KAAAA,GACAS,WAAAA,GACAC,SAAAA,ICPF,MAAM,GAA+BjP,OAAOC,KAAKC,OAAO,oB,eCAxD,MAAM,GAA+BF,OAAOC,KAAKC,OAAO,sB,eCAxD,MAAM,GAA+BF,OAAOC,KAAKC,OAAO,uB,eCQxD,WACE,IAAImP,KAAAA,QAAe7L,IAAI,QAAS+K,IAAM/K,IAAI,eAAgBwL,IAAYxL,IAAI,aAAcyL,IAExF,IAAII,KAAAA,OAAaC,MAAMC,QAAQ,SAASpK,UAAU,gBAElD,IAAIkK,KAAAA,OAAaG,MAAOrK,UAAU,iBAElC,IAAIkK,KAAAA,OAAaI,KAAYtK,UAAU,WAAWA,UAAU,iBCL9DpC,IAAAA,aAAiBS,IAAI,aAAa,WCHlC,IACQkM,GxCANrI,EAAAA,EAAAA,QAAOsI,IAAAA,UAA0B,iBAAiB,SAACC,GACjDA,EAAO3H,QAAQxF,KAAK,OACtB,KAEA4E,EAAAA,EAAAA,QAAOoI,IAAAA,UAAsB,UAAU,SAAUI,GAC3CxO,KAAKyO,WACPD,EAAOrM,IACL,OACAuM,IAAAA,UAAgB,CACdtM,KAAM,OACNuM,MAAOjN,IAAAA,WAAeC,MAAM,iCAC5Ba,KAAM,kBAER,EAGN,IamBAoD,EAAcgJ,KACdhJ,EAAciJ,M4BpCd7I,EAAAA,EAAAA,QAAO8I,IAAAA,UAAuB,WAAW,SAAUjN,GACjD,IAAM2K,EAAOxM,KAAKe,MAAMyL,KAExB,KAAMA,EAAKuC,YAAc/O,KAAKgP,gBAAkBxC,EAAKyC,QACnD,IAAK,IAA0BC,EAA/BC,E,4sBAAAC,CAAmB5C,EAAKyC,WAAOC,EAAAC,KAAAE,MAAE,KAAtBvO,EAAIoO,EAAAxQ,MACToC,GACFe,EAAQT,KAAKU,EAACmG,GAAQ,CAACuE,KAAMA,EAAM1L,KAAMA,IAE7C,CAEJ,KAEAkF,EAAAA,EAAAA,QAAO8I,IAAAA,UAAuB,UAAU,WAAY,IAAA/O,EAAA,KAClDC,KAAKsP,QAAQC,OAAM,WACjB,IAAMN,EAAQlP,EAAKgB,MAAMyL,KAAKyC,QAExBO,EAAc,MAALP,GAAU,MAAVA,EAAOvL,SAAF,EAALuL,EAAOvL,KACpB,SAAC5C,GAAI,IAAA2O,EAAAC,EAAAC,EAAAC,EAAAjG,EAAA,OACH7I,GAAQ,CACG,OADH2O,EACN3O,EAAKsD,WAAI,EAATqL,EAAW1H,WACO,OADG2H,GACrBC,EAAA7O,EAAKb,WAAUyD,UAAG,EAAlBgM,EAAAnR,KAAAoR,GAAqB,SAACxO,GAAM,IAAA0O,EAAA,OAAW,MAAN1O,GAAY,OAAN0O,EAAN1O,EAAQiD,WAAF,EAANyL,EAAc9H,UAAU,IACvC,OADwC6H,GAC1DjG,EAAA7I,EAAK+I,WAAUnG,UAAG,EAAlBkM,EAAArR,KAAAoL,GAAqB,SAACtC,GAAI,IAAAyI,EAAA,OAAkB,OAAlBA,EAAKzI,EAAKlG,eAAQ,EAAb2O,EAAenJ,IAAI,IACnD,IAGL,OAAOoJ,KAAKC,UAAUR,EACxB,GACF,KAEAxJ,EAAAA,EAAAA,QAAOiK,KAAAA,UAA0B,YAAY,WACvCvO,IAAAA,QACFA,IAAAA,OAAWoD,MAAK,SAACoL,GAGfA,EAAQC,SAASC,KAAKnR,KAAK,sBAAsB,SAACmF,GAChD,IAAMtD,EAAOY,IAAAA,MAAU2O,QAAQ,QAASjM,EAAa,QAEjDtD,GACFA,EAAKwP,eAAe,CAClBlG,UAAWhG,EAAoB,gBAMnC,IAAMmM,EAAiBnM,EAAc,QAErC,IAAK,IAAM0J,KAAYyC,EAAgB,CACrC,IAAMpP,EAASO,IAAAA,MAAU2O,QAAQ,eAAgBvC,GAE7C3M,QAAiCN,IAAvBM,EAAOiJ,aACnBjJ,EAAOmP,eAAe,CACpBlG,UAAWmG,EAAezC,IAGhC,CAEAhM,EAAE+E,QACJ,GACF,GAEJ,KAEAb,EAAAA,EAAAA,QAAOiK,KAAAA,UAA0B,YAAY,WACvCvO,IAAAA,QACFA,IAAAA,OAAWoD,MAAK,SAACoL,GACfA,EAAQC,SAASC,KAAKI,OAAO,qBAC/B,GAEJ,IDrEMnC,EAAa,SAAC7B,GAAI,OACtB9K,IAAAA,MAAUqE,KAAKvG,EAAiB,CAC9BgF,SAAU,SAACJ,GAAI,OACb1C,IAAAA,MACGoG,aAAa,SACbE,KAAI8E,GAAC,CAAD,EAEE1I,EAAI,CACPqM,cAAe,CACbjE,KAAAA,KAGJ,CACEpI,KAAM,CACJwC,QAAS,oCAId9B,MAAK,SAAChE,GAAS,IAAA4P,EAGd,OAF6B,OAA7BA,EAAAlE,EAAKmE,gBAAgB,WAAc,MAAnCD,EAA+BtP,MAA/BsP,EAA+BtP,KAAO,CAAEgB,KAAM,QAASuE,GAAI7F,EAAK6F,OAEzD7F,CACT,GAAE,GACN,GAEJkF,EAAAA,EAAAA,QAAO4K,KAAc,sBAAsB,SAAU3O,EAAOuK,IACrDA,EAAKuC,YAAcvC,EAAKlG,gBAC3BrE,EAAME,IACJ,UACAL,EAACS,IAAM,CAACC,KAAK,cAAcC,QAAS4L,EAAWpP,KAAKe,KAAMwM,IACvD9K,IAAAA,WAAeC,MAAM,mCAI9B,GD3BF,G","sources":["webpack://@fof/polls/webpack/bootstrap","webpack://@fof/polls/webpack/runtime/compat get default export","webpack://@fof/polls/webpack/runtime/define property getters","webpack://@fof/polls/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/polls/webpack/runtime/make namespace object","webpack://@fof/polls/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@fof/polls/./src/forum/addDiscussionBadge.js","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/ReplyComposer']\"","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/polls/./src/forum/components/CreatePollModal.js","webpack://@fof/polls/./src/forum/addComposerItems.js","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Link']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/polls/./src/forum/components/ListVotersModal.js","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@fof/polls/./src/forum/components/EditPollModal.js","webpack://@fof/polls/./src/forum/components/PostPoll.js","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/polls/external root \"flarum.core.compat['forum/utils/PostControls']\"","webpack://@fof/polls/./src/forum/components/index.js","webpack://@fof/polls/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/polls/./src/forum/models/Poll.js","webpack://@fof/polls/./src/forum/models/PollOption.js","webpack://@fof/polls/./src/forum/models/PollVote.js","webpack://@fof/polls/./src/forum/models/index.js","webpack://@fof/polls/external root \"flarum.core.compat['common/extenders']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Post']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Forum']\"","webpack://@fof/polls/./src/forum/extend.js","webpack://@fof/polls/./src/forum/index.js","webpack://@fof/polls/./src/forum/addPostControls.js","webpack://@fof/polls/./src/forum/addPollsToPost.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport Badge from 'flarum/common/components/Badge';\nimport DiscussionList from 'flarum/forum/components/DiscussionList';\nimport Discussion from 'flarum/common/models/Discussion';\n\nexport default () => {\n  extend(DiscussionList.prototype, 'requestParams', (params) => {\n    params.include.push('poll');\n  });\n\n  extend(Discussion.prototype, 'badges', function (badges) {\n    if (this.hasPoll()) {\n      badges.add(\n        'poll',\n        Badge.component({\n          type: 'poll',\n          label: app.translator.trans('fof-polls.forum.tooltip.badge'),\n          icon: 'fas fa-signal',\n        }),\n        5\n      );\n    }\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ReplyComposer'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import app from 'flarum/forum/app';\n\nimport Button from 'flarum/common/components/Button';\nimport Modal from 'flarum/common/components/Modal';\nimport Switch from 'flarum/common/components/Switch';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Stream from 'flarum/common/utils/Stream';\nimport extractText from 'flarum/common/utils/extractText';\n\nexport default class CreatePollModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.options = [Stream(''), Stream('')];\n    this.optionImageUrls = [Stream(''), Stream('')];\n\n    this.question = Stream('');\n\n    this.endDate = Stream();\n\n    this.publicPoll = Stream(false);\n    this.hideVotes = Stream(false);\n    this.allowChangeVote = Stream(true);\n    this.allowMultipleVotes = Stream(false);\n    this.maxVotes = Stream(0);\n\n    this.datepickerMinDate = this.formatDate(undefined);\n\n    const { poll } = this.attrs;\n\n    // When re-opening the modal for the same discussion composer where we already set poll attributes\n    if (poll && Array.isArray(poll.options)) {\n      this.options = [];\n      this.optionImageUrls = [];\n      poll.options.forEach((option) => {\n        this.options.push(Stream(option.answer));\n        this.optionImageUrls.push(Stream(option.imageUrl));\n      });\n\n      this.question(poll.question);\n      this.publicPoll(poll.publicPoll);\n      this.hideVotes(poll.hideVotes);\n      this.allowChangeVote(poll.allowChangeVote);\n      this.allowMultipleVotes(poll.allowMultipleVotes);\n      this.maxVotes(poll.maxVotes || 0);\n\n      this.endDate(this.formatDate(poll.endDate));\n\n      // Replace minimum of 'today' for poll end date only if the poll is not already closed\n      if (this.endDate() && dayjs(poll.endDate).isAfter(dayjs())) {\n        this.datepickerMinDate = this.formatDate(poll.endDate);\n      }\n    }\n  }\n\n  title() {\n    return app.translator.trans('fof-polls.forum.modal.add_title');\n  }\n\n  className() {\n    return 'PollDiscussionModal Modal--medium';\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n        <div className=\"PollDiscussionModal-form\">{this.fields().toArray()}</div>\n      </div>,\n    ];\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    items.add(\n      'question',\n      <div className=\"Form-group\">\n        <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.question_placeholder')}</label>\n\n        <input type=\"text\" name=\"question\" className=\"FormControl\" bidi={this.question} />\n      </div>,\n      100\n    );\n\n    items.add(\n      'answers',\n      <div className=\"PollModal--answers Form-group\">\n        <label className=\"label PollModal--answers-title\">\n          <span>{app.translator.trans('fof-polls.forum.modal.options_label')}</span>\n\n          {Button.component({\n            className: 'Button PollModal--button small',\n            icon: 'fas fa-plus',\n            onclick: this.addOption.bind(this),\n          })}\n        </label>\n\n        {this.displayOptions()}\n      </div>,\n      80\n    );\n\n    items.add(\n      'date',\n      <div className=\"Form-group\">\n        <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.date_placeholder')}</label>\n\n        <div className=\"PollModal--date\">\n          <input\n            className=\"FormControl\"\n            type=\"datetime-local\"\n            name=\"date\"\n            bidi={this.endDate}\n            min={this.datepickerMinDate}\n            max={this.formatDate('2038')}\n          />\n          {Button.component({\n            className: 'Button PollModal--button',\n            icon: 'fas fa-times',\n            onclick: this.endDate.bind(this, null),\n          })}\n        </div>\n\n        {this.endDate() && (\n          <p className=\"helpText\">\n            <i class=\"icon fas fa-clock\" />\n            &nbsp;\n            {dayjs(this.endDate()).isBefore(dayjs())\n              ? app.translator.trans('fof-polls.forum.poll_ended')\n              : app.translator.trans('fof-polls.forum.days_remaining', { time: dayjs(this.endDate()).fromNow() })}\n          </p>\n        )}\n      </div>,\n      40\n    );\n\n    items.add(\n      'public',\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: this.publicPoll() || false,\n            onchange: this.publicPoll,\n          },\n          app.translator.trans('fof-polls.forum.modal.public_poll_label')\n        )}\n      </div>,\n      20\n    );\n\n    items.add(\n      'hide-votes',\n      <div className=\"Form-group\">\n        <Switch state={this.endDate() && this.hideVotes()} onchange={this.hideVotes} disabled={!this.endDate()}>\n          {app.translator.trans('fof-polls.forum.modal.hide_votes_label')}\n        </Switch>\n      </div>,\n      20\n    );\n\n    items.add(\n      'allow-change-vote',\n      <div className=\"Form-group\">\n        <Switch state={this.allowChangeVote()} onchange={this.allowChangeVote}>\n          {app.translator.trans('fof-polls.forum.modal.allow_change_vote_label')}\n        </Switch>\n      </div>,\n      20\n    );\n\n    items.add(\n      'allow-multiple-votes',\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: this.allowMultipleVotes() || false,\n            onchange: this.allowMultipleVotes,\n          },\n          app.translator.trans('fof-polls.forum.modal.allow_multiple_votes_label')\n        )}\n      </div>,\n      15\n    );\n\n    if (this.allowMultipleVotes()) {\n      items.add(\n        'max-votes',\n        <div className=\"Form-group\">\n          <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.max_votes_label')}</label>\n\n          <input type=\"number\" min=\"0\" max={this.options.length} name=\"maxVotes\" className=\"FormControl\" bidi={this.maxVotes} />\n\n          <p className=\"helpText\">{app.translator.trans('fof-polls.forum.modal.max_votes_help')}</p>\n        </div>,\n        15\n      );\n    }\n\n    items.add(\n      'submit',\n      <div className=\"Form-group\">\n        {Button.component(\n          {\n            type: 'submit',\n            className: 'Button Button--primary PollModal-SubmitButton',\n            loading: this.loading,\n          },\n          app.translator.trans('fof-polls.forum.modal.submit')\n        )}\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  displayOptions() {\n    return Object.keys(this.options).map((el, i) => (\n      <div className=\"Form-group\">\n        <fieldset className=\"Poll-answer-input\">\n          <input\n            className=\"FormControl\"\n            type=\"text\"\n            name={'answer' + (i + 1)}\n            bidi={this.options[i]}\n            placeholder={app.translator.trans('fof-polls.forum.modal.option_placeholder') + ' #' + (i + 1)}\n          />\n          {app.forum.attribute('allowPollOptionImage') ? (\n            <input\n              className=\"FormControl\"\n              type=\"text\"\n              name={'answerImage' + (i + 1)}\n              bidi={this.optionImageUrls[i]}\n              placeholder={app.translator.trans('fof-polls.forum.modal.image_option_placeholder') + ' #' + (i + 1)}\n            />\n          ) : null}\n        </fieldset>\n        {i >= 2\n          ? Button.component({\n              type: 'button',\n              className: 'Button Button--warning PollModal--button',\n              icon: 'fas fa-minus',\n              onclick: i >= 2 ? this.removeOption.bind(this, i) : '',\n            })\n          : ''}\n      </div>\n    ));\n  }\n\n  addOption() {\n    const max = Math.max(app.forum.attribute('pollMaxOptions'), 2);\n\n    if (this.options.length < max) {\n      this.options.push(Stream(''));\n      this.optionImageUrls.push(Stream(''));\n    } else {\n      alert(extractText(app.translator.trans('fof-polls.forum.modal.max', { max })));\n    }\n  }\n\n  removeOption(option) {\n    this.options.splice(option, 1);\n    this.optionImageUrls.splice(option, 1);\n  }\n\n  data() {\n    const poll = {\n      question: this.question(),\n      endDate: this.dateToTimestamp(this.endDate()),\n      publicPoll: this.publicPoll(),\n      hideVotes: this.hideVotes(),\n      allowChangeVote: this.allowChangeVote(),\n      allowMultipleVotes: this.allowMultipleVotes(),\n      maxVotes: this.maxVotes(),\n      options: [],\n    };\n\n    this.options.forEach((answer, index) => {\n      if (answer()) {\n        poll.options.push({\n          answer: answer(),\n          imageUrl: this.optionImageUrls[index](),\n        });\n      }\n    });\n\n    if (this.question() === '') {\n      alert(app.translator.trans('fof-polls.forum.modal.include_question'));\n\n      return null;\n    }\n\n    if (poll.options.length < 2) {\n      alert(app.translator.trans('fof-polls.forum.modal.min'));\n\n      return null;\n    }\n\n    return poll;\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    const data = this.data();\n\n    if (data === null) {\n      return;\n    }\n\n    const promise = this.attrs.onsubmit(data);\n\n    if (promise instanceof Promise) {\n      this.loading = true;\n\n      promise.then(this.hide.bind(this), (err) => {\n        console.error(err);\n        this.onerror(err);\n        this.loaded();\n      });\n    } else {\n      app.modal.close();\n    }\n  }\n\n  formatDate(date, def = false) {\n    const dayjsDate = dayjs(date);\n\n    if (date === false || !dayjsDate.isValid()) return def !== false ? this.formatDate(def) : null;\n\n    return dayjsDate.format('YYYY-MM-DDTHH:mm');\n  }\n\n  dateToTimestamp(date) {\n    const dayjsDate = dayjs(date);\n\n    if (!date || !dayjsDate.isValid()) return false;\n\n    return dayjsDate.format();\n  }\n}\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport classList from 'flarum/common/utils/classList';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\nimport ReplyComposer from 'flarum/forum/components/ReplyComposer';\n\nimport CreatePollModal from './components/CreatePollModal';\n\nexport const addToComposer = (composer) => {\n  composer.prototype.addPoll = function () {\n    app.modal.show(CreatePollModal, {\n      poll: this.composer.fields.poll,\n      onsubmit: (poll) => (this.composer.fields.poll = poll),\n    });\n  };\n\n  // Add button to DiscussionComposer header\n  extend(composer.prototype, 'headerItems', function (items) {\n    const discussion = this.composer.body?.attrs?.discussion;\n    const canStartPoll = discussion?.canStartPoll() ?? app.forum.canStartPolls();\n\n    if (canStartPoll) {\n      items.add(\n        'polls',\n        <a className=\"ComposerBody-poll\" onclick={this.addPoll.bind(this)}>\n          <span className={classList('PollLabel', !this.composer.fields.poll && 'none')}>\n            {app.translator.trans(`fof-polls.forum.composer_discussion.${this.composer.fields.poll ? 'edit' : 'add'}_poll`)}\n          </span>\n        </a>,\n        1\n      );\n    }\n  });\n\n  extend(composer.prototype, 'data', function (data) {\n    if (this.composer.fields.poll) {\n      data.poll = this.composer.fields.poll;\n    }\n  });\n};\n\nexport default () => {\n  addToComposer(DiscussionComposer);\n  addToComposer(ReplyComposer);\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","import app from 'flarum/forum/app';\n\nimport Modal from 'flarum/common/components/Modal';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport Link from 'flarum/common/components/Link';\nimport Stream from 'flarum/common/utils/Stream';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\n\nexport default class ListVotersModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.loading = Stream(true);\n\n    app.store\n      .find('fof/polls', this.attrs.poll.id(), {\n        include: 'votes,votes.user,votes.option',\n      })\n      .then(() => this.loading(false))\n      .finally(() => m.redraw());\n  }\n\n  className() {\n    return 'Modal--medium VotesModal';\n  }\n\n  title() {\n    return app.translator.trans('fof-polls.forum.votes_modal.title');\n  }\n\n  content() {\n    return <div className=\"Modal-body\">{this.loading() ? <LoadingIndicator /> : this.attrs.poll.options().map(this.optionContent.bind(this))}</div>;\n  }\n\n  optionContent(opt) {\n    const votes = (this.attrs.poll.votes() || []).filter((v) => opt.id() === v.option().id());\n\n    return (\n      <div className=\"VotesModal-option\">\n        <h2>{opt.answer() + ':'}</h2>\n\n        {votes.length ? (\n          <div className=\"VotesModal-list\">{votes.map(this.voteContent.bind(this))}</div>\n        ) : (\n          <h4>{app.translator.trans('fof-polls.forum.modal.no_voters')}</h4>\n        )}\n      </div>\n    );\n  }\n\n  voteContent(vote) {\n    const user = vote.user();\n    const attrs = user && { href: app.route.user(user) };\n\n    return (\n      <Link {...attrs}>\n        {avatar(user)} {username(user)}\n      </Link>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import app from 'flarum/forum/app';\n\nimport Button from 'flarum/common/components/Button';\nimport Stream from 'flarum/common/utils/Stream';\nimport extractText from 'flarum/common/utils/extractText';\nimport CreatePollModal from './CreatePollModal';\n\nexport default class EditPollModal extends CreatePollModal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.poll = this.attrs.poll;\n\n    this.options = this.poll.options();\n    this.optionAnswers = this.options.map((o) => Stream(o.answer()));\n    this.optionImageUrls = this.options.map((o) => Stream(o.imageUrl()));\n    this.question = Stream(this.poll.question());\n    this.endDate = Stream(this.formatDate(this.poll.endDate()));\n    this.publicPoll = Stream(this.poll.publicPoll());\n    this.allowMultipleVotes = Stream(this.poll.allowMultipleVotes());\n    this.hideVotes = Stream(this.poll.hideVotes());\n    this.allowChangeVote = Stream(this.poll.allowChangeVote());\n    this.maxVotes = Stream(this.poll.maxVotes() || 0);\n\n    if (this.endDate() && dayjs(this.poll.endDate()).isAfter(dayjs())) {\n      this.datepickerMinDate = this.formatDate(this.endDate());\n    }\n  }\n\n  title() {\n    return app.translator.trans('fof-polls.forum.modal.edit_title');\n  }\n\n  displayOptions() {\n    return this.options.map((opt, i) => (\n      <div className=\"Form-group\">\n        <fieldset className=\"Poll-answer-input\">\n          <input\n            className=\"FormControl\"\n            type=\"text\"\n            name={'answer' + (i + 1)}\n            bidi={this.optionAnswers[i]}\n            placeholder={app.translator.trans('fof-polls.forum.modal.option_placeholder') + ' #' + (i + 1)}\n          />\n          {app.forum.attribute('allowPollOptionImage') ? (\n            <input\n              className=\"FormControl\"\n              type=\"text\"\n              name={'answerImage' + (i + 1)}\n              bidi={this.optionImageUrls[i]}\n              placeholder={app.translator.trans('fof-polls.forum.modal.image_option_placeholder') + ' #' + (i + 1)}\n            />\n          ) : null}\n        </fieldset>\n\n        {i >= 2\n          ? Button.component({\n              type: 'button',\n              className: 'Button PollModal--button',\n              icon: 'fas fa-minus',\n              onclick: i >= 2 ? this.removeOption.bind(this, i) : '',\n            })\n          : ''}\n      </div>\n    ));\n  }\n\n  addOption() {\n    const max = Math.max(app.forum.attribute('pollMaxOptions'), 2);\n\n    if (this.options.length < max) {\n      this.options.push(app.store.createRecord('poll_options'));\n      this.optionAnswers.push(Stream(''));\n      this.optionImageUrls.push(Stream(''));\n    } else {\n      alert(extractText(app.translator.trans('fof-polls.forum.modal.max', { max })));\n    }\n  }\n\n  removeOption(i) {\n    this.options.splice(i, 1);\n    this.optionAnswers.splice(i, 1);\n    this.optionImageUrls.splice(i, 1);\n  }\n\n  data() {\n    const options = this.options.map((o, i) => {\n      if (!o.data.attributes) o.data.attributes = {};\n\n      o.data.attributes.answer = this.optionAnswers[i]();\n      o.data.attributes.imageUrl = this.optionImageUrls[i]();\n\n      return o.data;\n    });\n\n    return {\n      question: this.question(),\n      endDate: this.dateToTimestamp(this.endDate()),\n      publicPoll: this.publicPoll(),\n      hideVotes: this.hideVotes(),\n      allowChangeVote: this.allowChangeVote(),\n      allowMultipleVotes: this.allowMultipleVotes(),\n      maxVotes: this.maxVotes(),\n      options,\n    };\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    if (this.loading) return;\n\n    this.loading = true;\n\n    return this.poll\n      .save(this.data())\n      .then(() => {\n        this.hide();\n        m.redraw();\n      })\n      .catch((e) => {\n        this.loaded();\n        this.onerror(e);\n      });\n  }\n}\n","import app from 'flarum/forum/app';\n\nimport Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport ListVotersModal from './ListVotersModal';\nimport classList from 'flarum/common/utils/classList';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport icon from 'flarum/common/helpers/icon';\nimport EditPollModal from './EditPollModal';\n\nexport default class PostPoll extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.loadingOptions = false;\n\n    this.useSubmitUI = !this.attrs.poll?.canChangeVote() && this.attrs.poll?.allowMultipleVotes();\n    this.pendingSubmit = false;\n    this.pendingOptions = null;\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.preventClose = this.preventClose.bind(this);\n    window.addEventListener('beforeunload', this.preventClose);\n  }\n\n  onremove(vnode) {\n    super.onremove(vnode);\n\n    window.removeEventListener('beforeunload', this.preventClose);\n  }\n\n  view() {\n    const poll = this.attrs.poll;\n    const options = poll.options() || [];\n    let maxVotes = poll.allowMultipleVotes() ? poll.maxVotes() : 1;\n\n    if (maxVotes === 0) maxVotes = options.length;\n\n    const infoItems = this.infoItems(maxVotes);\n\n    return (\n      <div className=\"Post-poll\" data-id={poll.id()}>\n        <div className=\"PollHeading\">\n          <h3 className=\"PollHeading-title\">{poll.question()}</h3>\n\n          {poll.canSeeVoters() && (\n            <Tooltip text={app.translator.trans('fof-polls.forum.public_poll')}>\n              <Button className=\"Button PollHeading-voters\" onclick={this.showVoters.bind(this)} icon=\"fas fa-poll\" />\n            </Tooltip>\n          )}\n\n          {poll.canEdit() && (\n            <Tooltip text={app.translator.trans('fof-polls.forum.moderation.edit')}>\n              <Button className=\"Button PollHeading-edit\" onclick={app.modal.show.bind(app.modal, EditPollModal, { poll })} icon=\"fas fa-pen\" />\n            </Tooltip>\n          )}\n          {poll.canDelete() && (\n            <Tooltip text={app.translator.trans('fof-polls.forum.moderation.delete')}>\n              <Button className=\"Button PollHeading-delete\" onclick={this.deletePoll.bind(this)} icon=\"fas fa-trash\" />\n            </Tooltip>\n          )}\n        </div>\n\n        <div>\n          <div className=\"PollOptions\">{options.map(this.viewOption.bind(this))}</div>\n\n          <div className=\"Poll-sticky\">\n            {!infoItems.isEmpty() && <div className=\"helpText PollInfoText\">{infoItems.toArray()}</div>}\n\n            {this.useSubmitUI && this.pendingSubmit && (\n              <Button className=\"Button Button--primary Poll-submit\" loading={this.loadingOptions} onclick={this.onsubmit.bind(this)}>\n                {app.translator.trans('fof-polls.forum.poll.submit_button')}\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  infoItems(maxVotes) {\n    const items = new ItemList();\n    const poll = this.attrs.poll;\n    const hasVoted = poll.myVotes()?.length > 0;\n\n    if (app.session.user && !poll.canVote() && !poll.hasEnded()) {\n      items.add(\n        'no-permission',\n        <span>\n          <i className=\"icon fas fa-times-circle fa-fw\" />\n          {app.translator.trans('fof-polls.forum.no_permission')}\n        </span>\n      );\n    }\n\n    if (poll.endDate()) {\n      items.add(\n        'end-date',\n        <span>\n          <i class=\"icon fas fa-clock fa-fw\" />\n          {poll.hasEnded()\n            ? app.translator.trans('fof-polls.forum.poll_ended')\n            : app.translator.trans('fof-polls.forum.days_remaining', { time: dayjs(poll.endDate()).fromNow() })}\n        </span>\n      );\n    }\n\n    if (poll.canVote()) {\n      items.add(\n        'max-votes',\n        <span>\n          <i className=\"icon fas fa-poll fa-fw\" />\n          {app.translator.trans('fof-polls.forum.max_votes_allowed', { max: maxVotes })}\n        </span>\n      );\n\n      if (!poll.canChangeVote()) {\n        items.add(\n          'cannot-change-vote',\n          <span>\n            <i className={`icon fas fa-${hasVoted ? 'times' : 'exclamation'}-circle fa-fw`} />\n            {app.translator.trans('fof-polls.forum.poll.cannot_change_vote')}\n          </span>\n        );\n      }\n    }\n\n    return items;\n  }\n\n  viewOption(opt) {\n    const poll = this.attrs.poll;\n    const hasVoted = poll.myVotes()?.length > 0;\n    const totalVotes = poll.voteCount();\n\n    const voted = this.pendingOptions ? this.pendingOptions.has(opt.id()) : poll.myVotes()?.some?.((vote) => vote.option() === opt);\n    const votes = opt.voteCount();\n    const percent = totalVotes > 0 ? Math.round((votes / totalVotes) * 100) : 0;\n\n    // isNaN(null) is false, so we have to check type directly now that API always returns the field\n    const canSeeVoteCount = typeof votes === 'number';\n    const isDisabled = this.loadingOptions || (hasVoted && !poll.canChangeVote());\n    const width = canSeeVoteCount ? percent : (Number(voted) / (poll.myVotes()?.length || 1)) * 100;\n\n    const showCheckmark = !app.session.user || (!poll.hasEnded() && poll.canVote() && (!hasVoted || poll.canChangeVote()));\n\n    const bar = (\n      <div className=\"PollBar\" data-selected={!!voted} style={`--poll-option-width: ${width}%`}>\n        {showCheckmark && (\n          <label className=\"PollAnswer-checkbox checkbox\">\n            <input onchange={this.changeVote.bind(this, opt)} type=\"checkbox\" checked={voted} disabled={isDisabled} />\n            <span className=\"checkmark\" />\n          </label>\n        )}\n\n        <div className=\"PollAnswer-text\">\n          <span className=\"PollAnswer-text-answer\">{opt.answer()}</span>\n          {voted && !showCheckmark && icon('fas fa-check-circle', { className: 'PollAnswer-check' })}\n          {canSeeVoteCount && <span className={classList('PollPercent', percent !== 100 && 'PollPercent--option')}>{percent}%</span>}\n        </div>\n\n        {opt.imageUrl() ? <img className=\"PollAnswer-image\" src={opt.imageUrl()} alt={opt.answer()} /> : null}\n      </div>\n    );\n\n    return (\n      <div\n        className={classList('PollOption', hasVoted && 'PollVoted', poll.hasEnded() && 'PollEnded', opt.imageUrl() && 'PollOption-hasImage')}\n        data-id={opt.id()}\n      >\n        {canSeeVoteCount ? (\n          <Tooltip text={app.translator.trans('fof-polls.forum.tooltip.votes', { count: votes })} onremove={this.hideOptionTooltip}>\n            {bar}\n          </Tooltip>\n        ) : (\n          bar\n        )}\n      </div>\n    );\n  }\n\n  changeVote(option, evt) {\n    if (!app.session.user) {\n      app.modal.show(LogInModal);\n      evt.target.checked = false;\n      return;\n    }\n\n    const optionIds = this.pendingOptions || new Set(this.attrs.poll.myVotes().map?.((v) => v.option().id()));\n    const isUnvoting = optionIds.delete(option.id());\n    const allowsMultiple = this.attrs.poll.allowMultipleVotes();\n\n    if (!allowsMultiple) {\n      optionIds.clear();\n    }\n\n    if (!isUnvoting) {\n      optionIds.add(option.id());\n    }\n\n    if (this.useSubmitUI) {\n      this.pendingOptions = optionIds.size ? optionIds : null;\n      this.pendingSubmit = !!this.pendingOptions;\n      return;\n    }\n\n    return this.submit(optionIds, null, () => (evt.target.checked = isUnvoting));\n  }\n\n  onsubmit() {\n    return this.submit(this.pendingOptions, () => {\n      this.pendingOptions = null;\n      this.pendingSubmit = false;\n    });\n  }\n\n  submit(optionIds, cb, onerror) {\n    this.loadingOptions = true;\n    m.redraw();\n\n    return app\n      .request({\n        method: 'PATCH',\n        url: `${app.forum.attribute('apiUrl')}/fof/polls/${this.attrs.poll.id()}/votes`,\n        body: {\n          data: {\n            optionIds: Array.from(optionIds),\n          },\n        },\n      })\n      .then((res) => {\n        app.store.pushPayload(res);\n        cb?.();\n      })\n      .catch((err) => {\n        onerror?.(err);\n      })\n      .finally(() => {\n        this.loadingOptions = false;\n\n        m.redraw();\n      });\n  }\n\n  showVoters() {\n    // Load all the votes only when opening the votes list\n    app.modal.show(ListVotersModal, {\n      poll: this.attrs.poll,\n      post: this.attrs.post,\n    });\n  }\n\n  deletePoll() {\n    if (confirm(app.translator.trans('fof-polls.forum.moderation.delete_confirm'))) {\n      this.attrs.poll.delete().then(() => {\n        m.redraw.sync();\n      });\n    }\n  }\n\n  /**\n   * Attempting to use the `tooltipVisible` attr on the Tooltip component set to 'false' when no vote count\n   * caused the tooltip to break on click. This is a workaround to hide the tooltip when no vote count is available,\n   * called on 'onremove' of the Tooltip component. It doesn't always work as intended either, but it does the job.\n   */\n  hideOptionTooltip(vnode) {\n    vnode.attrs.tooltipVisible = false;\n    vnode.state.updateVisibility();\n  }\n\n  /**\n   * Alert before navigating away using browser's 'beforeunload' event\n   */\n  preventClose(e) {\n    if (this.pendingOptions) {\n      e.preventDefault();\n      return true;\n    }\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/PostControls'];","import CreatePollModal from './CreatePollModal';\nimport PostPoll from './PostPoll';\nimport EditPollModal from './EditPollModal';\nimport ListVotersModal from './ListVotersModal';\n\nexport const components = {\n  CreatePollModal,\n  PostPoll,\n  EditPollModal,\n  ListVotersModal,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\n\nexport default class Poll extends Model {\n  question = Model.attribute('question');\n  hasEnded = Model.attribute('hasEnded');\n  endDate = Model.attribute('endDate');\n\n  publicPoll = Model.attribute('publicPoll');\n  hideVotes = Model.attribute('hideVotes');\n  allowChangeVote = Model.attribute('allowChangeVote');\n  allowMultipleVotes = Model.attribute('allowMultipleVotes');\n  maxVotes = Model.attribute('maxVotes');\n\n  voteCount = Model.attribute('voteCount');\n\n  canVote = Model.attribute('canVote');\n  canEdit = Model.attribute('canEdit');\n  canDelete = Model.attribute('canDelete');\n  canSeeVoters = Model.attribute('canSeeVoters');\n  canChangeVote = Model.attribute('canChangeVote');\n\n  options = Model.hasMany('options');\n  votes = Model.hasMany('votes');\n  myVotes = Model.hasMany('myVotes');\n\n  apiEndpoint() {\n    return `/fof/polls${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\n\nexport default class PollOption extends Model {\n  answer = Model.attribute('answer');\n  imageUrl = Model.attribute('imageUrl');\n  voteCount = Model.attribute('voteCount');\n\n  poll = Model.hasOne('polls');\n  votes = Model.hasMany('votes');\n\n  apiEndpoint() {\n    return `/fof/polls/answers${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\n\nexport default class PollVote extends Model {\n  poll = Model.hasOne('poll');\n  option = Model.hasOne('option');\n  user = Model.hasOne('user');\n\n  pollId = Model.attribute('pollId');\n  optionId = Model.attribute('optionId');\n\n  apiEndpoint() {\n    return `/fof/polls/${this.pollId()}/vote`;\n  }\n}\n","import Poll from './Poll';\nimport PollOption from './PollOption';\nimport PollVote from './PollVote';\n\nexport const models = {\n  Poll,\n  PollOption,\n  PollVote,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Forum'];","import Extend from 'flarum/common/extenders';\nimport Post from 'flarum/common/models/Post';\nimport Forum from 'flarum/common/models/Forum';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Poll from './models/Poll';\nimport PollOption from './models/PollOption';\nimport PollVote from './models/PollVote';\n\nexport default [\n  new Extend.Store().add('polls', Poll).add('poll_options', PollOption).add('poll_votes', PollVote),\n\n  new Extend.Model(Post).hasMany('polls').attribute('canStartPoll'),\n\n  new Extend.Model(Forum).attribute('canStartPolls'),\n\n  new Extend.Model(Discussion).attribute('hasPoll').attribute('canStartPoll'),\n];\n","import app from 'flarum/forum/app';\n\nimport addDiscussionBadge from './addDiscussionBadge';\nimport addComposerItems from './addComposerItems';\nimport addPollsToPost from './addPollsToPost';\nimport addPostControls from './addPostControls';\n\nexport * from './components';\nexport * from './models';\n\napp.initializers.add('fof/polls', () => {\n  addDiscussionBadge();\n  addComposerItems();\n  addPollsToPost();\n  addPostControls();\n});\n\nexport { default as extend } from './extend';\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport PostControls from 'flarum/forum/utils/PostControls';\nimport CreatePollModal from './components/CreatePollModal';\nimport Button from 'flarum/common/components/Button';\n\nexport default () => {\n  const createPoll = (post) =>\n    app.modal.show(CreatePollModal, {\n      onsubmit: (data) =>\n        app.store\n          .createRecord('polls')\n          .save(\n            {\n              ...data,\n              relationships: {\n                post,\n              },\n            },\n            {\n              data: {\n                include: 'options,myVotes,myVotes.option',\n              },\n            }\n          )\n          .then((poll) => {\n            post.rawRelationship('polls')?.push?.({ type: 'polls', id: poll.id() });\n\n            return poll;\n          }),\n    });\n\n  extend(PostControls, 'moderationControls', function (items, post) {\n    if (!post.isHidden() && post.canStartPoll()) {\n      items.add(\n        'addPoll',\n        <Button icon=\"fas fa-poll\" onclick={createPoll.bind(this, post)}>\n          {app.translator.trans('fof-polls.forum.moderation.add')}\n        </Button>\n      );\n    }\n  });\n};\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport PostPoll from './components/PostPoll';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\n\nexport default () => {\n  extend(CommentPost.prototype, 'content', function (content) {\n    const post = this.attrs.post;\n\n    if ((!post.isHidden() || this.revealContent) && post.polls()) {\n      for (const poll of post.polls()) {\n        if (poll) {\n          content.push(<PostPoll post={post} poll={poll} />);\n        }\n      }\n    }\n  });\n\n  extend(CommentPost.prototype, 'oninit', function () {\n    this.subtree.check(() => {\n      const polls = this.attrs.post.polls();\n\n      const checks = polls?.map?.(\n        (poll) =>\n          poll && [\n            poll.data?.attributes,\n            poll.options().map?.((option) => option?.data?.attributes),\n            poll.myVotes().map?.((vote) => vote.option()?.id()),\n          ]\n      );\n\n      return JSON.stringify(checks);\n    });\n  });\n\n  extend(DiscussionPage.prototype, 'oncreate', function () {\n    if (app.pusher) {\n      app.pusher.then((binding) => {\n        // We will listen for updates to all polls and options\n        // Even if that model is not in the current discussion, it doesn't really matter\n        binding.channels.main.bind('updatedPollOptions', (data) => {\n          const poll = app.store.getById('polls', data['pollId']);\n\n          if (poll) {\n            poll.pushAttributes({\n              voteCount: data['pollVoteCount'],\n            });\n\n            // Not redrawing here, as the option below should trigger the redraw already\n          }\n\n          const changedOptions = data['options'];\n\n          for (const optionId in changedOptions) {\n            const option = app.store.getById('poll_options', optionId);\n\n            if (option && option.voteCount() !== undefined) {\n              option.pushAttributes({\n                voteCount: changedOptions[optionId],\n              });\n            }\n          }\n\n          m.redraw();\n        });\n      });\n    }\n  });\n\n  extend(DiscussionPage.prototype, 'onremove', function () {\n    if (app.pusher) {\n      app.pusher.then((binding) => {\n        binding.channels.main.unbind('updatedPollOptions');\n      });\n    }\n  });\n};\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","CreatePollModal","_Modal","apply","arguments","_proto","oninit","vnode","_this","this","options","Stream","optionImageUrls","question","endDate","publicPoll","hideVotes","allowChangeVote","allowMultipleVotes","maxVotes","datepickerMinDate","formatDate","undefined","poll","attrs","Array","isArray","forEach","option","push","answer","imageUrl","dayjs","isAfter","title","app","trans","className","content","m","fields","toArray","items","ItemList","add","type","name","bidi","Button","icon","onclick","addOption","displayOptions","min","max","class","isBefore","time","fromNow","Switch","state","onchange","disabled","length","loading","_this2","keys","map","el","i","placeholder","attribute","removeOption","Math","alert","extractText","splice","data","_this3","dateToTimestamp","index","onsubmit","e","_this4","preventDefault","promise","Promise","then","hide","err","console","error","onerror","loaded","close","date","def","dayjsDate","isValid","format","Modal","addToComposer","composer","addPoll","show","extend","_this$composer$body","_this$composer$body$a","_discussion$canStartP","discussion","body","canStartPoll","canStartPolls","classList","ListVotersModal","find","id","include","redraw","LoadingIndicator","optionContent","opt","votes","filter","v","voteContent","vote","user","href","Link","avatar","username","EditPollModal","_CreatePollModal","optionAnswers","createRecord","attributes","save","PostPoll","_Component","_this$attrs$poll","_this$attrs$poll2","loadingOptions","useSubmitUI","canChangeVote","pendingSubmit","pendingOptions","oncreate","preventClose","window","addEventListener","onremove","removeEventListener","view","infoItems","canSeeVoters","Tooltip","text","showVoters","canEdit","canDelete","deletePoll","viewOption","isEmpty","_poll$myVotes","hasVoted","myVotes","canVote","hasEnded","_poll$myVotes2","_poll$myVotes3","_poll$myVotes4","totalVotes","voteCount","voted","has","some","percent","round","canSeeVoteCount","isDisabled","width","Number","showCheckmark","bar","style","changeVote","checked","src","alt","count","hideOptionTooltip","evt","_this$attrs$poll$myVo","_this$attrs$poll$myVo2","LogInModal","target","optionIds","Set","isUnvoting","clear","size","submit","cb","method","url","from","res","pushPayload","post","confirm","sync","tooltipVisible","updateVisibility","Component","_extends","assign","source","components","Poll","_Model","_len","args","_key","concat","Model","apiEndpoint","exists","PollOption","PollVote","pollId","optionId","models","Extend","Post","hasMany","Forum","Discussion","createPoll","DiscussionList","params","badges","hasPoll","Badge","label","DiscussionComposer","ReplyComposer","CommentPost","isHidden","revealContent","polls","_step","_iterator","_createForOfIteratorHelperLoose","done","subtree","check","checks","_poll$data","_poll$options$map","_poll$options","_poll$myVotes$map","_option$data","_vote$option","JSON","stringify","DiscussionPage","binding","channels","main","getById","pushAttributes","changedOptions","unbind","relationships","_post$rawRelationship","rawRelationship","PostControls"],"sourceRoot":""}