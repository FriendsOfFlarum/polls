{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/polls/webpack/bootstrap","webpack://@fof/polls/webpack/runtime/compat get default export","webpack://@fof/polls/webpack/runtime/define property getters","webpack://@fof/polls/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/polls/webpack/runtime/make namespace object","webpack://@fof/polls/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@fof/polls/./src/forum/addDiscussionBadge.js","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/ReplyComposer']\"","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/polls/./src/forum/components/CreatePollModal.js","webpack://@fof/polls/./src/forum/addComposerItems.js","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Link']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/polls/./src/forum/components/ListVotersModal.js","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@fof/polls/./src/forum/components/EditPollModal.js","webpack://@fof/polls/./src/forum/components/PostPoll.js","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/polls/external root \"flarum.core.compat['forum/utils/PostControls']\"","webpack://@fof/polls/./src/forum/components/index.js","webpack://@fof/polls/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/polls/./src/forum/models/Poll.js","webpack://@fof/polls/./src/forum/models/PollOption.js","webpack://@fof/polls/./src/forum/models/PollVote.js","webpack://@fof/polls/./src/forum/models/index.js","webpack://@fof/polls/external root \"flarum.core.compat['common/extenders']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Post']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Forum']\"","webpack://@fof/polls/./src/forum/extend.js","webpack://@fof/polls/./src/forum/index.js","webpack://@fof/polls/./src/forum/addPostControls.js","webpack://@fof/polls/./src/forum/addPollsToPost.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport Badge from 'flarum/common/components/Badge';\nimport DiscussionList from 'flarum/forum/components/DiscussionList';\nimport Discussion from 'flarum/common/models/Discussion';\n\nexport default () => {\n  extend(DiscussionList.prototype, 'requestParams', (params) => {\n    params.include.push('poll');\n  });\n\n  extend(Discussion.prototype, 'badges', function (badges) {\n    if (this.hasPoll()) {\n      badges.add(\n        'poll',\n        Badge.component({\n          type: 'poll',\n          label: app.translator.trans('fof-polls.forum.tooltip.badge'),\n          icon: 'fas fa-signal',\n        }),\n        5\n      );\n    }\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ReplyComposer'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import app from 'flarum/forum/app';\n\nimport Button from 'flarum/common/components/Button';\nimport Modal from 'flarum/common/components/Modal';\nimport Switch from 'flarum/common/components/Switch';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Stream from 'flarum/common/utils/Stream';\nimport extractText from 'flarum/common/utils/extractText';\n\nexport default class CreatePollModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.options = [Stream(''), Stream('')];\n    this.optionImageUrls = [Stream(''), Stream('')];\n\n    this.question = Stream('');\n\n    this.endDate = Stream();\n\n    this.publicPoll = Stream(false);\n    this.hideVotes = Stream(false);\n    this.allowMultipleVotes = Stream(false);\n    this.maxVotes = Stream(0);\n\n    this.datepickerMinDate = this.formatDate(undefined);\n\n    const { poll } = this.attrs;\n\n    // When re-opening the modal for the same discussion composer where we already set poll attributes\n    if (poll && Array.isArray(poll.options)) {\n      this.options = [];\n      this.optionImageUrls = [];\n      poll.options.forEach((option) => {\n        this.options.push(Stream(option.answer));\n        this.optionImageUrls.push(Stream(option.imageUrl));\n      });\n\n      this.question(poll.question);\n      this.publicPoll(poll.publicPoll);\n      this.hideVotes(poll.hideVotes);\n      this.allowMultipleVotes(poll.allowMultipleVotes);\n      this.maxVotes(poll.maxVotes || 0);\n\n      this.endDate(this.formatDate(poll.endDate));\n\n      // Replace minimum of 'today' for poll end date only if the poll is not already closed\n      if (this.endDate() && dayjs(poll.endDate).isAfter(dayjs())) {\n        this.datepickerMinDate = this.formatDate(poll.endDate);\n      }\n    }\n  }\n\n  title() {\n    return app.translator.trans('fof-polls.forum.modal.add_title');\n  }\n\n  className() {\n    return 'PollDiscussionModal Modal--medium';\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n        <div className=\"PollDiscussionModal-form\">{this.fields().toArray()}</div>\n      </div>,\n    ];\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    items.add(\n      'question',\n      <div className=\"Form-group\">\n        <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.question_placeholder')}</label>\n\n        <input type=\"text\" name=\"question\" className=\"FormControl\" bidi={this.question} />\n      </div>,\n      100\n    );\n\n    items.add(\n      'answers',\n      <div className=\"PollModal--answers Form-group\">\n        <label className=\"label PollModal--answers-title\">\n          <span>{app.translator.trans('fof-polls.forum.modal.options_label')}</span>\n\n          {Button.component({\n            className: 'Button PollModal--button small',\n            icon: 'fas fa-plus',\n            onclick: this.addOption.bind(this),\n          })}\n        </label>\n\n        {this.displayOptions()}\n      </div>,\n      80\n    );\n\n    items.add(\n      'date',\n      <div className=\"Form-group\">\n        <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.date_placeholder')}</label>\n\n        <div className=\"PollModal--date\">\n          <input\n            className=\"FormControl\"\n            type=\"datetime-local\"\n            name=\"date\"\n            bidi={this.endDate}\n            min={this.datepickerMinDate}\n            max={this.formatDate('2038')}\n          />\n          {Button.component({\n            className: 'Button PollModal--button',\n            icon: 'fas fa-times',\n            onclick: this.endDate.bind(this, null),\n          })}\n        </div>\n\n        {this.endDate() && (\n          <p className=\"helpText\">\n            <i class=\"icon fas fa-clock\" />\n            &nbsp;\n            {dayjs(this.endDate()).isBefore(dayjs())\n              ? app.translator.trans('fof-polls.forum.poll_ended')\n              : app.translator.trans('fof-polls.forum.days_remaining', { time: dayjs(this.endDate()).fromNow() })}\n          </p>\n        )}\n      </div>,\n      40\n    );\n\n    items.add(\n      'public',\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: this.publicPoll() || false,\n            onchange: this.publicPoll,\n          },\n          app.translator.trans('fof-polls.forum.modal.public_poll_label')\n        )}\n      </div>,\n      20\n    );\n\n    items.add(\n      'hide-votes',\n      <div className=\"Form-group\">\n        <Switch state={this.endDate() && this.hideVotes()} onchange={this.hideVotes} disabled={!this.endDate()}>\n          {app.translator.trans('fof-polls.forum.modal.hide_votes_label')}\n        </Switch>\n      </div>,\n      20\n    );\n\n    items.add(\n      'allow-multiple-votes',\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: this.allowMultipleVotes() || false,\n            onchange: this.allowMultipleVotes,\n          },\n          app.translator.trans('fof-polls.forum.modal.allow_multiple_votes_label')\n        )}\n      </div>,\n      15\n    );\n\n    if (this.allowMultipleVotes()) {\n      items.add(\n        'max-votes',\n        <div className=\"Form-group\">\n          <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.max_votes_label')}</label>\n\n          <input type=\"number\" min=\"0\" max={this.options.length} name=\"maxVotes\" className=\"FormControl\" bidi={this.maxVotes} />\n\n          <p className=\"helpText\">{app.translator.trans('fof-polls.forum.modal.max_votes_help')}</p>\n        </div>,\n        15\n      );\n    }\n\n    items.add(\n      'submit',\n      <div className=\"Form-group\">\n        {Button.component(\n          {\n            type: 'submit',\n            className: 'Button Button--primary PollModal-SubmitButton',\n            loading: this.loading,\n          },\n          app.translator.trans('fof-polls.forum.modal.submit')\n        )}\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  displayOptions() {\n    return Object.keys(this.options).map((el, i) => (\n      <div className=\"Form-group\">\n        <fieldset className=\"Poll-answer-input\">\n          <input\n            className=\"FormControl\"\n            type=\"text\"\n            name={'answer' + (i + 1)}\n            bidi={this.options[i]}\n            placeholder={app.translator.trans('fof-polls.forum.modal.option_placeholder') + ' #' + (i + 1)}\n          />\n          {app.forum.attribute('allowPollOptionImage') ? (\n            <input\n              className=\"FormControl\"\n              type=\"text\"\n              name={'answerImage' + (i + 1)}\n              bidi={this.optionImageUrls[i]}\n              placeholder={app.translator.trans('fof-polls.forum.modal.image_option_placeholder') + ' #' + (i + 1)}\n            />\n          ) : null}\n        </fieldset>\n        {i >= 2\n          ? Button.component({\n              type: 'button',\n              className: 'Button Button--warning PollModal--button',\n              icon: 'fas fa-minus',\n              onclick: i >= 2 ? this.removeOption.bind(this, i) : '',\n            })\n          : ''}\n      </div>\n    ));\n  }\n\n  addOption() {\n    const max = Math.max(app.forum.attribute('pollMaxOptions'), 2);\n\n    if (this.options.length < max) {\n      this.options.push(Stream(''));\n      this.optionImageUrls.push(Stream(''));\n    } else {\n      alert(extractText(app.translator.trans('fof-polls.forum.modal.max', { max })));\n    }\n  }\n\n  removeOption(option) {\n    this.options.splice(option, 1);\n    this.optionImageUrls.splice(option, 1);\n  }\n\n  data() {\n    const poll = {\n      question: this.question(),\n      endDate: this.dateToTimestamp(this.endDate()),\n      publicPoll: this.publicPoll(),\n      allowMultipleVotes: this.allowMultipleVotes(),\n      maxVotes: this.maxVotes(),\n      options: [],\n    };\n\n    this.options.forEach((answer, index) => {\n      if (answer()) {\n        poll.options.push({\n          answer: answer(),\n          imageUrl: this.optionImageUrls[index](),\n        });\n      }\n    });\n\n    if (this.question() === '') {\n      alert(app.translator.trans('fof-polls.forum.modal.include_question'));\n\n      return null;\n    }\n\n    if (poll.options.length < 2) {\n      alert(app.translator.trans('fof-polls.forum.modal.min'));\n\n      return null;\n    }\n\n    return poll;\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    const data = this.data();\n\n    if (data === null) {\n      return;\n    }\n\n    const promise = this.attrs.onsubmit(data);\n\n    if (promise instanceof Promise) {\n      this.loading = true;\n\n      promise.then(this.hide.bind(this), (err) => {\n        console.error(err);\n        this.loaded();\n      });\n    } else {\n      app.modal.close();\n    }\n  }\n\n  formatDate(date, def = false) {\n    const dayjsDate = dayjs(date);\n\n    if (date === false || !dayjsDate.isValid()) return def !== false ? this.formatDate(def) : null;\n\n    return dayjsDate.format('YYYY-MM-DDTHH:mm');\n  }\n\n  dateToTimestamp(date) {\n    const dayjsDate = dayjs(date);\n\n    if (!date || !dayjsDate.isValid()) return false;\n\n    return dayjsDate.format();\n  }\n}\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport classList from 'flarum/common/utils/classList';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\nimport ReplyComposer from 'flarum/forum/components/ReplyComposer';\n\nimport CreatePollModal from './components/CreatePollModal';\n\nexport const addToComposer = (composer) => {\n  composer.prototype.addPoll = function () {\n    app.modal.show(CreatePollModal, {\n      poll: this.composer.fields.poll,\n      onsubmit: (poll) => (this.composer.fields.poll = poll),\n    });\n  };\n\n  // Add button to DiscussionComposer header\n  extend(composer.prototype, 'headerItems', function (items) {\n    const discussion = this.composer.body?.attrs?.discussion;\n    const canStartPoll = discussion?.canStartPoll() ?? app.forum.canStartPolls();\n\n    if (canStartPoll) {\n      items.add(\n        'polls',\n        <a className=\"ComposerBody-poll\" onclick={this.addPoll.bind(this)}>\n          <span className={classList('PollLabel', !this.composer.fields.poll && 'none')}>\n            {app.translator.trans(`fof-polls.forum.composer_discussion.${this.composer.fields.poll ? 'edit' : 'add'}_poll`)}\n          </span>\n        </a>,\n        1\n      );\n    }\n  });\n\n  extend(composer.prototype, 'data', function (data) {\n    if (this.composer.fields.poll) {\n      data.poll = this.composer.fields.poll;\n    }\n  });\n};\n\nexport default () => {\n  addToComposer(DiscussionComposer);\n  addToComposer(ReplyComposer);\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","import app from 'flarum/forum/app';\n\nimport Modal from 'flarum/common/components/Modal';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport Link from 'flarum/common/components/Link';\nimport Stream from 'flarum/common/utils/Stream';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\n\nexport default class ListVotersModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.loading = Stream(true);\n\n    app.store\n      .find('fof/polls', this.attrs.poll.id(), {\n        include: 'votes,votes.user,votes.option',\n      })\n      .then(() => this.loading(false))\n      .finally(() => m.redraw());\n  }\n\n  className() {\n    return 'Modal--medium VotesModal';\n  }\n\n  title() {\n    return app.translator.trans('fof-polls.forum.votes_modal.title');\n  }\n\n  content() {\n    return <div className=\"Modal-body\">{this.loading() ? <LoadingIndicator /> : this.attrs.poll.options().map(this.optionContent.bind(this))}</div>;\n  }\n\n  optionContent(opt) {\n    const votes = (this.attrs.poll.votes() || []).filter((v) => opt.id() === v.option().id());\n\n    return (\n      <div className=\"VotesModal-option\">\n        <h2>{opt.answer() + ':'}</h2>\n\n        {votes.length ? (\n          <div className=\"VotesModal-list\">{votes.map(this.voteContent.bind(this))}</div>\n        ) : (\n          <h4>{app.translator.trans('fof-polls.forum.modal.no_voters')}</h4>\n        )}\n      </div>\n    );\n  }\n\n  voteContent(vote) {\n    const user = vote.user();\n    const attrs = user && { href: app.route.user(user) };\n\n    return (\n      <Link {...attrs}>\n        {avatar(user)} {username(user)}\n      </Link>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","import app from 'flarum/forum/app';\n\nimport Button from 'flarum/common/components/Button';\nimport Stream from 'flarum/common/utils/Stream';\nimport extractText from 'flarum/common/utils/extractText';\nimport CreatePollModal from './CreatePollModal';\n\nexport default class EditPollModal extends CreatePollModal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.poll = this.attrs.poll;\n\n    this.options = this.poll.options();\n    this.optionAnswers = this.options.map((o) => Stream(o.answer()));\n    this.optionImageUrls = this.options.map((o) => Stream(o.imageUrl()));\n    this.question = Stream(this.poll.question());\n    this.endDate = Stream(this.formatDate(this.poll.endDate()));\n    this.publicPoll = Stream(this.poll.publicPoll());\n    this.allowMultipleVotes = Stream(this.poll.allowMultipleVotes());\n    this.hideVotes = Stream(this.poll.hideVotes());\n    this.maxVotes = Stream(this.poll.maxVotes() || 0);\n\n    if (this.endDate() && dayjs(this.poll.endDate()).isAfter(dayjs())) {\n      this.datepickerMinDate = this.formatDate(this.endDate());\n    }\n  }\n\n  title() {\n    return app.translator.trans('fof-polls.forum.modal.edit_title');\n  }\n\n  displayOptions() {\n    return this.options.map((opt, i) => (\n      <div className=\"Form-group\">\n        <fieldset className=\"Poll-answer-input\">\n          <input\n            className=\"FormControl\"\n            type=\"text\"\n            name={'answer' + (i + 1)}\n            bidi={this.optionAnswers[i]}\n            placeholder={app.translator.trans('fof-polls.forum.modal.option_placeholder') + ' #' + (i + 1)}\n          />\n          {app.forum.attribute('allowPollOptionImage') ? (\n            <input\n              className=\"FormControl\"\n              type=\"text\"\n              name={'answerImage' + (i + 1)}\n              bidi={this.optionImageUrls[i]}\n              placeholder={app.translator.trans('fof-polls.forum.modal.image_option_placeholder') + ' #' + (i + 1)}\n            />\n          ) : null}\n        </fieldset>\n\n        {i >= 2\n          ? Button.component({\n              type: 'button',\n              className: 'Button PollModal--button',\n              icon: 'fas fa-minus',\n              onclick: i >= 2 ? this.removeOption.bind(this, i) : '',\n            })\n          : ''}\n      </div>\n    ));\n  }\n\n  addOption() {\n    const max = Math.max(app.forum.attribute('pollMaxOptions'), 2);\n\n    if (this.options.length < max) {\n      this.options.push(app.store.createRecord('poll_options'));\n      this.optionAnswers.push(Stream(''));\n      this.optionImageUrls.push(Stream(''));\n    } else {\n      alert(extractText(app.translator.trans('fof-polls.forum.modal.max', { max })));\n    }\n  }\n\n  removeOption(i) {\n    this.options.splice(i, 1);\n    this.optionAnswers.splice(i, 1);\n    this.optionImageUrls.splice(i, 1);\n  }\n\n  data() {\n    const options = this.options.map((o, i) => {\n      if (!o.data.attributes) o.data.attributes = {};\n\n      o.data.attributes.answer = this.optionAnswers[i]();\n      o.data.attributes.imageUrl = this.optionImageUrls[i]();\n\n      return o.data;\n    });\n\n    return {\n      question: this.question(),\n      endDate: this.dateToTimestamp(this.endDate()),\n      publicPoll: this.publicPoll(),\n      hideVotes: this.hideVotes(),\n      allowMultipleVotes: this.allowMultipleVotes(),\n      maxVotes: this.maxVotes(),\n      options,\n    };\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    if (this.loading) return;\n\n    this.loading = true;\n\n    return this.poll\n      .save(this.data())\n      .then(() => {\n        this.hide();\n        m.redraw();\n      })\n      .catch((e) => {\n        this.loaded();\n        this.onerror(e);\n      });\n  }\n}\n","import app from 'flarum/forum/app';\n\nimport Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport ListVotersModal from './ListVotersModal';\nimport classList from 'flarum/common/utils/classList';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport EditPollModal from './EditPollModal';\n\nexport default class PostPoll extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.loadingOptions = false;\n  }\n\n  view() {\n    const poll = this.attrs.poll;\n    const options = poll.options() || [];\n    let maxVotes = poll.allowMultipleVotes() ? poll.maxVotes() : 1;\n\n    if (maxVotes === 0) maxVotes = options.length;\n\n    return (\n      <div className=\"Post-poll\" data-id={poll.id()}>\n        <div className=\"PollHeading\">\n          <h3 className=\"PollHeading-title\">{poll.question()}</h3>\n\n          {poll.canSeeVoters() && (\n            <Tooltip text={app.translator.trans('fof-polls.forum.public_poll')}>\n              <Button className=\"Button PollHeading-voters\" onclick={this.showVoters.bind(this)} icon=\"fas fa-poll\" />\n            </Tooltip>\n          )}\n\n          {poll.canEdit() && (\n            <Tooltip text={app.translator.trans('fof-polls.forum.moderation.edit')}>\n              <Button className=\"Button PollHeading-edit\" onclick={app.modal.show.bind(app.modal, EditPollModal, { poll })} icon=\"fas fa-pen\" />\n            </Tooltip>\n          )}\n          {poll.canDelete() && (\n            <Tooltip text={app.translator.trans('fof-polls.forum.moderation.delete')}>\n              <Button className=\"Button PollHeading-delete\" onclick={this.deletePoll.bind(this)} icon=\"fas fa-trash\" />\n            </Tooltip>\n          )}\n        </div>\n\n        <div className=\"PollOptions\">{options.map(this.viewOption.bind(this))}</div>\n\n        <div className=\"helpText PollInfoText\">\n          {app.session.user && !poll.canVote() && !poll.hasEnded() && (\n            <span>\n              <i className=\"icon fas fa-times-circle\" />\n              {app.translator.trans('fof-polls.forum.no_permission')}\n            </span>\n          )}\n          {poll.endDate() && (\n            <span>\n              <i class=\"icon fas fa-clock\" />\n              {poll.hasEnded()\n                ? app.translator.trans('fof-polls.forum.poll_ended')\n                : app.translator.trans('fof-polls.forum.days_remaining', { time: dayjs(poll.endDate()).fromNow() })}\n            </span>\n          )}\n\n          {poll.canVote() && (\n            <span>\n              <i className=\"icon fas fa-poll\" />\n              {app.translator.trans('fof-polls.forum.max_votes_allowed', { max: maxVotes })}\n            </span>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  viewOption(opt) {\n    const poll = this.attrs.poll;\n    const hasVoted = poll.myVotes()?.length > 0;\n    const totalVotes = poll.voteCount();\n\n    const voted = poll.myVotes()?.some?.((vote) => vote.option() === opt);\n    const votes = opt.voteCount();\n    const percent = totalVotes > 0 ? Math.round((votes / totalVotes) * 100) : 0;\n\n    // isNaN(null) is false, so we have to check type directly now that API always returns the field\n    const canSeeVoteCount = typeof votes === 'number';\n    const isDisabled = this.loadingOptions || (hasVoted && !poll.canChangeVote());\n    const width = canSeeVoteCount ? percent : (Number(voted) / (poll.myVotes()?.length || 1)) * 100;\n\n    const bar = (\n      <div className=\"PollBar\" data-selected={voted}>\n        {((!poll.hasEnded() && poll.canVote()) || !app.session.user) && (\n          <label className=\"checkbox\">\n            <input onchange={this.changeVote.bind(this, opt)} type=\"checkbox\" checked={voted} disabled={isDisabled} />\n            <span className=\"checkmark\" />\n          </label>\n        )}\n\n        <div style={`--width: ${width}%`} className=\"PollOption-active\" />\n        <label className=\"PollAnswer\">\n          <span>{opt.answer()}</span>\n          {opt.imageUrl() ? <img className=\"PollAnswerImage\" src={opt.imageUrl()} alt={opt.answer()} /> : null}\n        </label>\n        {canSeeVoteCount && (\n          <label>\n            <span className={classList('PollPercent', percent !== 100 && 'PollPercent--option')}>{percent}%</span>\n          </label>\n        )}\n      </div>\n    );\n\n    return (\n      <div\n        className={classList('PollOption', hasVoted && 'PollVoted', poll.hasEnded() && 'PollEnded', opt.imageUrl() && 'PollOption-hasImage')}\n        data-id={opt.id()}\n      >\n        {canSeeVoteCount ? (\n          <Tooltip text={app.translator.trans('fof-polls.forum.tooltip.votes', { count: votes })} onremove={this.hideOptionTooltip}>\n            {bar}\n          </Tooltip>\n        ) : (\n          bar\n        )}\n      </div>\n    );\n  }\n\n  changeVote(option, evt) {\n    if (!app.session.user) {\n      app.modal.show(LogInModal);\n      evt.target.checked = false;\n      return;\n    }\n\n    const optionIds = new Set(this.attrs.poll.myVotes().map?.((v) => v.option().id()));\n    const isUnvoting = optionIds.delete(option.id());\n    const allowsMultiple = this.attrs.poll.allowMultipleVotes();\n\n    if (!allowsMultiple) {\n      optionIds.clear();\n    }\n\n    if (!isUnvoting) {\n      optionIds.add(option.id());\n    }\n\n    this.loadingOptions = true;\n    m.redraw();\n\n    return app\n      .request({\n        method: 'PATCH',\n        url: `${app.forum.attribute('apiUrl')}/fof/polls/${this.attrs.poll.id()}/votes`,\n        body: {\n          data: {\n            optionIds: Array.from(optionIds),\n          },\n        },\n      })\n      .then((res) => {\n        app.store.pushPayload(res);\n\n        // m.redraw();\n      })\n      .catch(() => {\n        evt.target.checked = isUnvoting;\n      })\n      .finally(() => {\n        this.loadingOptions = false;\n\n        m.redraw();\n      });\n  }\n\n  showVoters() {\n    // Load all the votes only when opening the votes list\n    app.modal.show(ListVotersModal, {\n      poll: this.attrs.poll,\n      post: this.attrs.post,\n    });\n  }\n\n  deletePoll() {\n    if (confirm(app.translator.trans('fof-polls.forum.moderation.delete_confirm'))) {\n      this.attrs.poll.delete().then(() => {\n        m.redraw.sync();\n      });\n    }\n  }\n\n  /**\n   * Attempting to use the `tooltipVisible` attr on the Tooltip component set to 'false' when no vote count\n   * caused the tooltip to break on click. This is a workaround to hide the tooltip when no vote count is available,\n   * called on 'onremove' of the Tooltip component. It doesn't always work as intended either, but it does the job.\n   */\n  hideOptionTooltip(vnode) {\n    vnode.attrs.tooltipVisible = false;\n    vnode.state.updateVisibility();\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/PostControls'];","import CreatePollModal from './CreatePollModal';\nimport PostPoll from './PostPoll';\nimport EditPollModal from './EditPollModal';\nimport ListVotersModal from './ListVotersModal';\n\nexport const components = {\n  CreatePollModal,\n  PostPoll,\n  EditPollModal,\n  ListVotersModal,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\n\nexport default class Poll extends Model {\n  question = Model.attribute('question');\n  hasEnded = Model.attribute('hasEnded');\n  endDate = Model.attribute('endDate');\n\n  publicPoll = Model.attribute('publicPoll');\n  hideVotes = Model.attribute('hideVotes');\n  allowMultipleVotes = Model.attribute('allowMultipleVotes');\n  maxVotes = Model.attribute('maxVotes');\n\n  voteCount = Model.attribute('voteCount');\n\n  canVote = Model.attribute('canVote');\n  canEdit = Model.attribute('canEdit');\n  canDelete = Model.attribute('canDelete');\n  canSeeVoters = Model.attribute('canSeeVoters');\n  canChangeVote = Model.attribute('canChangeVote');\n\n  options = Model.hasMany('options');\n  votes = Model.hasMany('votes');\n  myVotes = Model.hasMany('myVotes');\n\n  apiEndpoint() {\n    return `/fof/polls${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\n\nexport default class PollOption extends Model {\n  answer = Model.attribute('answer');\n  imageUrl = Model.attribute('imageUrl');\n  voteCount = Model.attribute('voteCount');\n\n  poll = Model.hasOne('polls');\n  votes = Model.hasMany('votes');\n\n  apiEndpoint() {\n    return `/fof/polls/answers${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\n\nexport default class PollVote extends Model {\n  poll = Model.hasOne('poll');\n  option = Model.hasOne('option');\n  user = Model.hasOne('user');\n\n  pollId = Model.attribute('pollId');\n  optionId = Model.attribute('optionId');\n\n  apiEndpoint() {\n    return `/fof/polls/${this.pollId()}/vote`;\n  }\n}\n","import Poll from './Poll';\nimport PollOption from './PollOption';\nimport PollVote from './PollVote';\n\nexport const models = {\n  Poll,\n  PollOption,\n  PollVote,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Forum'];","import Extend from 'flarum/common/extenders';\nimport Post from 'flarum/common/models/Post';\nimport Forum from 'flarum/common/models/Forum';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Poll from './models/Poll';\nimport PollOption from './models/PollOption';\nimport PollVote from './models/PollVote';\n\nexport default [\n  new Extend.Store().add('polls', Poll).add('poll_options', PollOption).add('poll_votes', PollVote),\n\n  new Extend.Model(Post).hasMany('polls').attribute('canStartPoll'),\n\n  new Extend.Model(Forum).attribute('canStartPolls'),\n\n  new Extend.Model(Discussion).attribute('hasPoll').attribute('canStartPoll'),\n];\n","import app from 'flarum/forum/app';\n\nimport addDiscussionBadge from './addDiscussionBadge';\nimport addComposerItems from './addComposerItems';\nimport addPollsToPost from './addPollsToPost';\nimport addPostControls from './addPostControls';\n\nexport * from './components';\nexport * from './models';\n\napp.initializers.add('fof/polls', () => {\n  addDiscussionBadge();\n  addComposerItems();\n  addPollsToPost();\n  addPostControls();\n});\n\nexport { default as extend } from './extend';\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport PostControls from 'flarum/forum/utils/PostControls';\nimport CreatePollModal from './components/CreatePollModal';\nimport Button from 'flarum/common/components/Button';\n\nexport default () => {\n  const createPoll = (post) =>\n    app.modal.show(CreatePollModal, {\n      onsubmit: (data) =>\n        app.store\n          .createRecord('polls')\n          .save(\n            {\n              ...data,\n              relationships: {\n                post,\n              },\n            },\n            {\n              data: {\n                include: 'options,myVotes,myVotes.option',\n              },\n            }\n          )\n          .then((poll) => {\n            post.rawRelationship('polls')?.push?.({ type: 'polls', id: poll.id() });\n\n            return poll;\n          }),\n    });\n\n  extend(PostControls, 'moderationControls', function (items, post) {\n    if (!post.isHidden() && post.canStartPoll()) {\n      items.add(\n        'addPoll',\n        <Button icon=\"fas fa-poll\" onclick={createPoll.bind(this, post)}>\n          {app.translator.trans('fof-polls.forum.moderation.add')}\n        </Button>\n      );\n    }\n  });\n};\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport PostPoll from './components/PostPoll';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\n\nexport default () => {\n  extend(CommentPost.prototype, 'content', function (content) {\n    const post = this.attrs.post;\n\n    if ((!post.isHidden() || this.revealContent) && post.polls()) {\n      for (const poll of post.polls()) {\n        if (poll) {\n          content.push(<PostPoll post={post} poll={poll} />);\n        }\n      }\n    }\n  });\n\n  extend(CommentPost.prototype, 'oninit', function () {\n    this.subtree.check(() => {\n      const polls = this.attrs.post.polls();\n\n      const checks = polls?.map?.(\n        (poll) =>\n          poll && [\n            poll.data?.attributes,\n            poll.options().map?.((option) => option?.data?.attributes),\n            poll.myVotes().map?.((vote) => vote.option()?.id()),\n          ]\n      );\n\n      return JSON.stringify(checks);\n    });\n  });\n\n  extend(DiscussionPage.prototype, 'oncreate', function () {\n    if (app.pusher) {\n      app.pusher.then((binding) => {\n        // We will listen for updates to all polls and options\n        // Even if that model is not in the current discussion, it doesn't really matter\n        binding.channels.main.bind('updatedPollOptions', (data) => {\n          const poll = app.store.getById('polls', data['pollId']);\n\n          if (poll) {\n            poll.pushAttributes({\n              voteCount: data['pollVoteCount'],\n            });\n\n            // Not redrawing here, as the option below should trigger the redraw already\n          }\n\n          const changedOptions = data['options'];\n\n          for (const optionId in changedOptions) {\n            const option = app.store.getById('poll_options', optionId);\n\n            if (option && option.voteCount() !== undefined) {\n              option.pushAttributes({\n                voteCount: changedOptions[optionId],\n              });\n            }\n          }\n\n          m.redraw();\n        });\n      });\n    }\n  });\n\n  extend(DiscussionPage.prototype, 'onremove', function () {\n    if (app.pusher) {\n      app.pusher.then((binding) => {\n        binding.channels.main.unbind('updatedPollOptions');\n      });\n    }\n  });\n};\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","CreatePollModal","oninit","vnode","this","options","Stream","optionImageUrls","question","endDate","publicPoll","hideVotes","allowMultipleVotes","maxVotes","datepickerMinDate","formatDate","undefined","poll","attrs","Array","isArray","forEach","option","push","answer","imageUrl","dayjs","isAfter","title","app","trans","className","content","fields","toArray","items","ItemList","add","type","name","bidi","Button","icon","onclick","addOption","displayOptions","min","max","class","isBefore","time","fromNow","Switch","state","onchange","disabled","length","loading","keys","map","el","i","placeholder","attribute","removeOption","Math","alert","extractText","splice","data","dateToTimestamp","index","onsubmit","e","preventDefault","promise","Promise","then","hide","err","console","error","loaded","close","date","def","dayjsDate","isValid","format","Modal","addToComposer","composer","addPoll","show","extend","discussion","body","canStartPoll","canStartPolls","classList","ListVotersModal","find","id","include","m","redraw","optionContent","opt","votes","filter","v","voteContent","vote","user","href","avatar","username","EditPollModal","optionAnswers","createRecord","attributes","save","onerror","PostPoll","loadingOptions","view","canSeeVoters","text","showVoters","canEdit","canDelete","deletePoll","viewOption","canVote","hasEnded","hasVoted","myVotes","totalVotes","voteCount","voted","some","percent","round","canSeeVoteCount","isDisabled","canChangeVote","width","Number","bar","changeVote","checked","style","src","alt","count","onremove","hideOptionTooltip","evt","LogInModal","target","optionIds","Set","isUnvoting","clear","method","url","from","res","pushPayload","post","confirm","sync","tooltipVisible","updateVisibility","Component","_extends","assign","arguments","source","apply","components","Poll","Model","apiEndpoint","exists","PollOption","PollVote","pollId","optionId","models","Extend","Post","hasMany","Forum","Discussion","createPoll","DiscussionList","params","badges","hasPoll","Badge","label","DiscussionComposer","ReplyComposer","CommentPost","isHidden","revealContent","polls","subtree","check","checks","JSON","stringify","DiscussionPage","binding","channels","main","getById","pushAttributes","changedOptions","unbind","relationships","rawRelationship","PostControls"],"sourceRoot":""}