{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/polls/webpack/bootstrap","webpack://@fof/polls/webpack/runtime/compat get default export","webpack://@fof/polls/webpack/runtime/define property getters","webpack://@fof/polls/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/polls/webpack/runtime/make namespace object","webpack://@fof/polls/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@fof/polls/./src/forum/addDiscussionBadge.js","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/ReplyComposer']\"","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/polls/./src/forum/components/CreatePollModal.js","webpack://@fof/polls/./src/forum/addComposerItems.js","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Link']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/polls/./src/forum/components/ListVotersModal.js","webpack://@fof/polls/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@fof/polls/./src/forum/components/EditPollModal.js","webpack://@fof/polls/./src/forum/components/PostPoll.js","webpack://@fof/polls/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@fof/polls/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/polls/external root \"flarum.core.compat['forum/utils/PostControls']\"","webpack://@fof/polls/./src/forum/components/index.js","webpack://@fof/polls/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/polls/./src/forum/models/Poll.js","webpack://@fof/polls/./src/forum/models/PollOption.js","webpack://@fof/polls/./src/forum/models/PollVote.js","webpack://@fof/polls/./src/forum/models/index.js","webpack://@fof/polls/external root \"flarum.core.compat['common/extenders']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Post']\"","webpack://@fof/polls/external root \"flarum.core.compat['common/models/Forum']\"","webpack://@fof/polls/./src/forum/extend.js","webpack://@fof/polls/./src/forum/index.js","webpack://@fof/polls/./src/forum/addPostControls.js","webpack://@fof/polls/./src/forum/addPollsToPost.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport Badge from 'flarum/common/components/Badge';\nimport DiscussionList from 'flarum/forum/components/DiscussionList';\nimport Discussion from 'flarum/common/models/Discussion';\n\nexport default () => {\n  extend(DiscussionList.prototype, 'requestParams', (params) => {\n    params.include.push('poll');\n  });\n\n  extend(Discussion.prototype, 'badges', function (badges) {\n    if (this.hasPoll()) {\n      badges.add(\n        'poll',\n        Badge.component({\n          type: 'poll',\n          label: app.translator.trans('fof-polls.forum.tooltip.badge'),\n          icon: 'fas fa-signal',\n        }),\n        5\n      );\n    }\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ReplyComposer'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import app from 'flarum/forum/app';\n\nimport Button from 'flarum/common/components/Button';\nimport Modal from 'flarum/common/components/Modal';\nimport Switch from 'flarum/common/components/Switch';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Stream from 'flarum/common/utils/Stream';\nimport extractText from 'flarum/common/utils/extractText';\n\nexport default class CreatePollModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.options = [Stream(''), Stream('')];\n    this.optionImageUrls = [Stream(''), Stream('')];\n\n    this.question = Stream('');\n\n    this.endDate = Stream();\n\n    this.publicPoll = Stream(false);\n    this.hideVotes = Stream(false);\n    this.allowChangeVote = Stream(true);\n    this.allowMultipleVotes = Stream(false);\n    this.maxVotes = Stream(0);\n\n    this.datepickerMinDate = this.formatDate(undefined);\n\n    const { poll } = this.attrs;\n\n    // When re-opening the modal for the same discussion composer where we already set poll attributes\n    if (poll && Array.isArray(poll.options)) {\n      this.options = [];\n      this.optionImageUrls = [];\n      poll.options.forEach((option) => {\n        this.options.push(Stream(option.answer));\n        this.optionImageUrls.push(Stream(option.imageUrl));\n      });\n\n      this.question(poll.question);\n      this.publicPoll(poll.publicPoll);\n      this.hideVotes(poll.hideVotes);\n      this.allowChangeVote(poll.allowChangeVote);\n      this.allowMultipleVotes(poll.allowMultipleVotes);\n      this.maxVotes(poll.maxVotes || 0);\n\n      this.endDate(this.formatDate(poll.endDate));\n\n      // Replace minimum of 'today' for poll end date only if the poll is not already closed\n      if (this.endDate() && dayjs(poll.endDate).isAfter(dayjs())) {\n        this.datepickerMinDate = this.formatDate(poll.endDate);\n      }\n    }\n  }\n\n  title() {\n    return app.translator.trans('fof-polls.forum.modal.add_title');\n  }\n\n  className() {\n    return 'PollDiscussionModal Modal--medium';\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n        <div className=\"PollDiscussionModal-form\">{this.fields().toArray()}</div>\n      </div>,\n    ];\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    items.add(\n      'question',\n      <div className=\"Form-group\">\n        <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.question_placeholder')}</label>\n\n        <input type=\"text\" name=\"question\" className=\"FormControl\" bidi={this.question} />\n      </div>,\n      100\n    );\n\n    items.add(\n      'answers',\n      <div className=\"PollModal--answers Form-group\">\n        <label className=\"label PollModal--answers-title\">\n          <span>{app.translator.trans('fof-polls.forum.modal.options_label')}</span>\n\n          {Button.component({\n            className: 'Button PollModal--button small',\n            icon: 'fas fa-plus',\n            onclick: this.addOption.bind(this),\n          })}\n        </label>\n\n        {this.displayOptions()}\n      </div>,\n      80\n    );\n\n    items.add(\n      'date',\n      <div className=\"Form-group\">\n        <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.date_placeholder')}</label>\n\n        <div className=\"PollModal--date\">\n          <input\n            className=\"FormControl\"\n            type=\"datetime-local\"\n            name=\"date\"\n            bidi={this.endDate}\n            min={this.datepickerMinDate}\n            max={this.formatDate('2038')}\n          />\n          {Button.component({\n            className: 'Button PollModal--button',\n            icon: 'fas fa-times',\n            onclick: this.endDate.bind(this, null),\n          })}\n        </div>\n\n        {this.endDate() && (\n          <p className=\"helpText\">\n            <i class=\"icon fas fa-clock\" />\n            &nbsp;\n            {dayjs(this.endDate()).isBefore(dayjs())\n              ? app.translator.trans('fof-polls.forum.poll_ended')\n              : app.translator.trans('fof-polls.forum.days_remaining', { time: dayjs(this.endDate()).fromNow() })}\n          </p>\n        )}\n      </div>,\n      40\n    );\n\n    items.add(\n      'public',\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: this.publicPoll() || false,\n            onchange: this.publicPoll,\n          },\n          app.translator.trans('fof-polls.forum.modal.public_poll_label')\n        )}\n      </div>,\n      20\n    );\n\n    items.add(\n      'hide-votes',\n      <div className=\"Form-group\">\n        <Switch state={this.endDate() && this.hideVotes()} onchange={this.hideVotes} disabled={!this.endDate()}>\n          {app.translator.trans('fof-polls.forum.modal.hide_votes_label')}\n        </Switch>\n      </div>,\n      20\n    );\n\n    items.add(\n      'allow-change-vote',\n      <div className=\"Form-group\">\n        <Switch state={this.allowChangeVote()} onchange={this.allowChangeVote}>\n          {app.translator.trans('fof-polls.forum.modal.allow_change_vote_label')}\n        </Switch>\n      </div>,\n      20\n    );\n\n    items.add(\n      'allow-multiple-votes',\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: this.allowMultipleVotes() || false,\n            onchange: this.allowMultipleVotes,\n          },\n          app.translator.trans('fof-polls.forum.modal.allow_multiple_votes_label')\n        )}\n      </div>,\n      15\n    );\n\n    if (this.allowMultipleVotes()) {\n      items.add(\n        'max-votes',\n        <div className=\"Form-group\">\n          <label className=\"label\">{app.translator.trans('fof-polls.forum.modal.max_votes_label')}</label>\n\n          <input type=\"number\" min=\"0\" max={this.options.length} name=\"maxVotes\" className=\"FormControl\" bidi={this.maxVotes} />\n\n          <p className=\"helpText\">{app.translator.trans('fof-polls.forum.modal.max_votes_help')}</p>\n        </div>,\n        15\n      );\n    }\n\n    items.add(\n      'submit',\n      <div className=\"Form-group\">\n        {Button.component(\n          {\n            type: 'submit',\n            className: 'Button Button--primary PollModal-SubmitButton',\n            loading: this.loading,\n          },\n          app.translator.trans('fof-polls.forum.modal.submit')\n        )}\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  displayOptions() {\n    return Object.keys(this.options).map((el, i) => (\n      <div className=\"Form-group\">\n        <fieldset className=\"Poll-answer-input\">\n          <input\n            className=\"FormControl\"\n            type=\"text\"\n            name={'answer' + (i + 1)}\n            bidi={this.options[i]}\n            placeholder={app.translator.trans('fof-polls.forum.modal.option_placeholder') + ' #' + (i + 1)}\n          />\n          {app.forum.attribute('allowPollOptionImage') ? (\n            <input\n              className=\"FormControl\"\n              type=\"text\"\n              name={'answerImage' + (i + 1)}\n              bidi={this.optionImageUrls[i]}\n              placeholder={app.translator.trans('fof-polls.forum.modal.image_option_placeholder') + ' #' + (i + 1)}\n            />\n          ) : null}\n        </fieldset>\n        {i >= 2\n          ? Button.component({\n              type: 'button',\n              className: 'Button Button--warning PollModal--button',\n              icon: 'fas fa-minus',\n              onclick: i >= 2 ? this.removeOption.bind(this, i) : '',\n            })\n          : ''}\n      </div>\n    ));\n  }\n\n  addOption() {\n    const max = Math.max(app.forum.attribute('pollMaxOptions'), 2);\n\n    if (this.options.length < max) {\n      this.options.push(Stream(''));\n      this.optionImageUrls.push(Stream(''));\n    } else {\n      alert(extractText(app.translator.trans('fof-polls.forum.modal.max', { max })));\n    }\n  }\n\n  removeOption(option) {\n    this.options.splice(option, 1);\n    this.optionImageUrls.splice(option, 1);\n  }\n\n  data() {\n    const poll = {\n      question: this.question(),\n      endDate: this.dateToTimestamp(this.endDate()),\n      publicPoll: this.publicPoll(),\n      hideVotes: this.hideVotes(),\n      allowChangeVote: this.allowChangeVote(),\n      allowMultipleVotes: this.allowMultipleVotes(),\n      maxVotes: this.maxVotes(),\n      options: [],\n    };\n\n    this.options.forEach((answer, index) => {\n      if (answer()) {\n        poll.options.push({\n          answer: answer(),\n          imageUrl: this.optionImageUrls[index](),\n        });\n      }\n    });\n\n    if (this.question() === '') {\n      alert(app.translator.trans('fof-polls.forum.modal.include_question'));\n\n      return null;\n    }\n\n    if (poll.options.length < 2) {\n      alert(app.translator.trans('fof-polls.forum.modal.min'));\n\n      return null;\n    }\n\n    return poll;\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    const data = this.data();\n\n    if (data === null) {\n      return;\n    }\n\n    const promise = this.attrs.onsubmit(data);\n\n    if (promise instanceof Promise) {\n      this.loading = true;\n\n      promise.then(this.hide.bind(this), (err) => {\n        console.error(err);\n        this.onerror(err);\n        this.loaded();\n      });\n    } else {\n      app.modal.close();\n    }\n  }\n\n  formatDate(date, def = false) {\n    const dayjsDate = dayjs(date);\n\n    if (date === false || !dayjsDate.isValid()) return def !== false ? this.formatDate(def) : null;\n\n    return dayjsDate.format('YYYY-MM-DDTHH:mm');\n  }\n\n  dateToTimestamp(date) {\n    const dayjsDate = dayjs(date);\n\n    if (!date || !dayjsDate.isValid()) return false;\n\n    return dayjsDate.format();\n  }\n}\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport classList from 'flarum/common/utils/classList';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\nimport ReplyComposer from 'flarum/forum/components/ReplyComposer';\n\nimport CreatePollModal from './components/CreatePollModal';\n\nexport const addToComposer = (composer) => {\n  composer.prototype.addPoll = function () {\n    app.modal.show(CreatePollModal, {\n      poll: this.composer.fields.poll,\n      onsubmit: (poll) => (this.composer.fields.poll = poll),\n    });\n  };\n\n  // Add button to DiscussionComposer header\n  extend(composer.prototype, 'headerItems', function (items) {\n    const discussion = this.composer.body?.attrs?.discussion;\n    const canStartPoll = discussion?.canStartPoll() ?? app.forum.canStartPolls();\n\n    if (canStartPoll) {\n      items.add(\n        'polls',\n        <a className=\"ComposerBody-poll\" onclick={this.addPoll.bind(this)}>\n          <span className={classList('PollLabel', !this.composer.fields.poll && 'none')}>\n            {app.translator.trans(`fof-polls.forum.composer_discussion.${this.composer.fields.poll ? 'edit' : 'add'}_poll`)}\n          </span>\n        </a>,\n        1\n      );\n    }\n  });\n\n  extend(composer.prototype, 'data', function (data) {\n    if (this.composer.fields.poll) {\n      data.poll = this.composer.fields.poll;\n    }\n  });\n};\n\nexport default () => {\n  addToComposer(DiscussionComposer);\n  addToComposer(ReplyComposer);\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","import app from 'flarum/forum/app';\n\nimport Modal from 'flarum/common/components/Modal';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport Link from 'flarum/common/components/Link';\nimport Stream from 'flarum/common/utils/Stream';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\n\nexport default class ListVotersModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.loading = Stream(true);\n\n    app.store\n      .find('fof/polls', this.attrs.poll.id(), {\n        include: 'votes,votes.user,votes.option',\n      })\n      .then(() => this.loading(false))\n      .finally(() => m.redraw());\n  }\n\n  className() {\n    return 'Modal--medium VotesModal';\n  }\n\n  title() {\n    return app.translator.trans('fof-polls.forum.votes_modal.title');\n  }\n\n  content() {\n    return <div className=\"Modal-body\">{this.loading() ? <LoadingIndicator /> : this.attrs.poll.options().map(this.optionContent.bind(this))}</div>;\n  }\n\n  optionContent(opt) {\n    const votes = (this.attrs.poll.votes() || []).filter((v) => opt.id() === v.option().id());\n\n    return (\n      <div className=\"VotesModal-option\">\n        <h2>{opt.answer() + ':'}</h2>\n\n        {votes.length ? (\n          <div className=\"VotesModal-list\">{votes.map(this.voteContent.bind(this))}</div>\n        ) : (\n          <h4>{app.translator.trans('fof-polls.forum.modal.no_voters')}</h4>\n        )}\n      </div>\n    );\n  }\n\n  voteContent(vote) {\n    const user = vote.user();\n    const attrs = user && { href: app.route.user(user) };\n\n    return (\n      <Link {...attrs}>\n        {avatar(user)} {username(user)}\n      </Link>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import app from 'flarum/forum/app';\n\nimport Button from 'flarum/common/components/Button';\nimport Stream from 'flarum/common/utils/Stream';\nimport extractText from 'flarum/common/utils/extractText';\nimport CreatePollModal from './CreatePollModal';\n\nexport default class EditPollModal extends CreatePollModal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.poll = this.attrs.poll;\n\n    this.options = this.poll.options();\n    this.optionAnswers = this.options.map((o) => Stream(o.answer()));\n    this.optionImageUrls = this.options.map((o) => Stream(o.imageUrl()));\n    this.question = Stream(this.poll.question());\n    this.endDate = Stream(this.formatDate(this.poll.endDate()));\n    this.publicPoll = Stream(this.poll.publicPoll());\n    this.allowMultipleVotes = Stream(this.poll.allowMultipleVotes());\n    this.hideVotes = Stream(this.poll.hideVotes());\n    this.allowChangeVote = Stream(this.poll.allowChangeVote());\n    this.maxVotes = Stream(this.poll.maxVotes() || 0);\n\n    if (this.endDate() && dayjs(this.poll.endDate()).isAfter(dayjs())) {\n      this.datepickerMinDate = this.formatDate(this.endDate());\n    }\n  }\n\n  title() {\n    return app.translator.trans('fof-polls.forum.modal.edit_title');\n  }\n\n  displayOptions() {\n    return this.options.map((opt, i) => (\n      <div className=\"Form-group\">\n        <fieldset className=\"Poll-answer-input\">\n          <input\n            className=\"FormControl\"\n            type=\"text\"\n            name={'answer' + (i + 1)}\n            bidi={this.optionAnswers[i]}\n            placeholder={app.translator.trans('fof-polls.forum.modal.option_placeholder') + ' #' + (i + 1)}\n          />\n          {app.forum.attribute('allowPollOptionImage') ? (\n            <input\n              className=\"FormControl\"\n              type=\"text\"\n              name={'answerImage' + (i + 1)}\n              bidi={this.optionImageUrls[i]}\n              placeholder={app.translator.trans('fof-polls.forum.modal.image_option_placeholder') + ' #' + (i + 1)}\n            />\n          ) : null}\n        </fieldset>\n\n        {i >= 2\n          ? Button.component({\n              type: 'button',\n              className: 'Button PollModal--button',\n              icon: 'fas fa-minus',\n              onclick: i >= 2 ? this.removeOption.bind(this, i) : '',\n            })\n          : ''}\n      </div>\n    ));\n  }\n\n  addOption() {\n    const max = Math.max(app.forum.attribute('pollMaxOptions'), 2);\n\n    if (this.options.length < max) {\n      this.options.push(app.store.createRecord('poll_options'));\n      this.optionAnswers.push(Stream(''));\n      this.optionImageUrls.push(Stream(''));\n    } else {\n      alert(extractText(app.translator.trans('fof-polls.forum.modal.max', { max })));\n    }\n  }\n\n  removeOption(i) {\n    this.options.splice(i, 1);\n    this.optionAnswers.splice(i, 1);\n    this.optionImageUrls.splice(i, 1);\n  }\n\n  data() {\n    const options = this.options.map((o, i) => {\n      if (!o.data.attributes) o.data.attributes = {};\n\n      o.data.attributes.answer = this.optionAnswers[i]();\n      o.data.attributes.imageUrl = this.optionImageUrls[i]();\n\n      return o.data;\n    });\n\n    return {\n      question: this.question(),\n      endDate: this.dateToTimestamp(this.endDate()),\n      publicPoll: this.publicPoll(),\n      hideVotes: this.hideVotes(),\n      allowChangeVote: this.allowChangeVote(),\n      allowMultipleVotes: this.allowMultipleVotes(),\n      maxVotes: this.maxVotes(),\n      options,\n    };\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    if (this.loading) return;\n\n    this.loading = true;\n\n    return this.poll\n      .save(this.data())\n      .then(() => {\n        this.hide();\n        m.redraw();\n      })\n      .catch((e) => {\n        this.loaded();\n        this.onerror(e);\n      });\n  }\n}\n","import app from 'flarum/forum/app';\n\nimport Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport ListVotersModal from './ListVotersModal';\nimport classList from 'flarum/common/utils/classList';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Tooltip from 'flarum/common/components/Tooltip';\nimport icon from 'flarum/common/helpers/icon';\nimport EditPollModal from './EditPollModal';\n\nexport default class PostPoll extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.loadingOptions = false;\n\n    this.useSubmitUI = !this.attrs.poll?.canChangeVote() && this.attrs.poll?.allowMultipleVotes();\n    this.pendingSubmit = false;\n    this.pendingOptions = null;\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.preventClose = this.preventClose.bind(this);\n    window.addEventListener('beforeunload', this.preventClose);\n  }\n\n  onremove(vnode) {\n    super.onremove(vnode);\n\n    window.removeEventListener('beforeunload', this.preventClose);\n  }\n\n  view() {\n    const poll = this.attrs.poll;\n    const options = poll.options() || [];\n    let maxVotes = poll.allowMultipleVotes() ? poll.maxVotes() : 1;\n\n    if (maxVotes === 0) maxVotes = options.length;\n\n    const infoItems = this.infoItems(maxVotes);\n\n    return (\n      <div className=\"Post-poll\" data-id={poll.id()}>\n        <div className=\"PollHeading\">\n          <h3 className=\"PollHeading-title\">{poll.question()}</h3>\n\n          {poll.canSeeVoters() && (\n            <Tooltip text={app.translator.trans('fof-polls.forum.public_poll')}>\n              <Button className=\"Button PollHeading-voters\" onclick={this.showVoters.bind(this)} icon=\"fas fa-poll\" />\n            </Tooltip>\n          )}\n\n          {poll.canEdit() && (\n            <Tooltip text={app.translator.trans('fof-polls.forum.moderation.edit')}>\n              <Button className=\"Button PollHeading-edit\" onclick={app.modal.show.bind(app.modal, EditPollModal, { poll })} icon=\"fas fa-pen\" />\n            </Tooltip>\n          )}\n          {poll.canDelete() && (\n            <Tooltip text={app.translator.trans('fof-polls.forum.moderation.delete')}>\n              <Button className=\"Button PollHeading-delete\" onclick={this.deletePoll.bind(this)} icon=\"fas fa-trash\" />\n            </Tooltip>\n          )}\n        </div>\n\n        <div>\n          <div className=\"PollOptions\">{options.map(this.viewOption.bind(this))}</div>\n\n          <div className=\"Poll-sticky\">\n            {!infoItems.isEmpty() && <div className=\"helpText PollInfoText\">{infoItems.toArray()}</div>}\n\n            {this.useSubmitUI && this.pendingSubmit && (\n              <Button className=\"Button Button--primary Poll-submit\" loading={this.loadingOptions} onclick={this.onsubmit.bind(this)}>\n                {app.translator.trans('fof-polls.forum.poll.submit_button')}\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  infoItems(maxVotes) {\n    const items = new ItemList();\n    const poll = this.attrs.poll;\n    const hasVoted = poll.myVotes()?.length > 0;\n\n    if (app.session.user && !poll.canVote() && !poll.hasEnded()) {\n      items.add(\n        'no-permission',\n        <span>\n          <i className=\"icon fas fa-times-circle fa-fw\" />\n          {app.translator.trans('fof-polls.forum.no_permission')}\n        </span>\n      );\n    }\n\n    if (poll.endDate()) {\n      items.add(\n        'end-date',\n        <span>\n          <i class=\"icon fas fa-clock fa-fw\" />\n          {poll.hasEnded()\n            ? app.translator.trans('fof-polls.forum.poll_ended')\n            : app.translator.trans('fof-polls.forum.days_remaining', { time: dayjs(poll.endDate()).fromNow() })}\n        </span>\n      );\n    }\n\n    if (poll.canVote()) {\n      items.add(\n        'max-votes',\n        <span>\n          <i className=\"icon fas fa-poll fa-fw\" />\n          {app.translator.trans('fof-polls.forum.max_votes_allowed', { max: maxVotes })}\n        </span>\n      );\n\n      if (!poll.canChangeVote()) {\n        items.add(\n          'cannot-change-vote',\n          <span>\n            <i className={`icon fas fa-${hasVoted ? 'times' : 'exclamation'}-circle fa-fw`} />\n            {app.translator.trans('fof-polls.forum.poll.cannot_change_vote')}\n          </span>\n        );\n      }\n    }\n\n    return items;\n  }\n\n  viewOption(opt) {\n    const poll = this.attrs.poll;\n    const hasVoted = poll.myVotes()?.length > 0;\n    const totalVotes = poll.voteCount();\n\n    const voted = this.pendingOptions ? this.pendingOptions.has(opt.id()) : poll.myVotes()?.some?.((vote) => vote.option() === opt);\n    const votes = opt.voteCount();\n    const percent = totalVotes > 0 ? Math.round((votes / totalVotes) * 100) : 0;\n\n    // isNaN(null) is false, so we have to check type directly now that API always returns the field\n    const canSeeVoteCount = typeof votes === 'number';\n    const isDisabled = this.loadingOptions || (hasVoted && !poll.canChangeVote());\n    const width = canSeeVoteCount ? percent : (Number(voted) / (poll.myVotes()?.length || 1)) * 100;\n\n    const showCheckmark = !app.session.user || (!poll.hasEnded() && poll.canVote() && (!hasVoted || poll.canChangeVote()));\n\n    const bar = (\n      <div className=\"PollBar\" data-selected={!!voted} style={`--poll-option-width: ${width}%`}>\n        {showCheckmark && (\n          <label className=\"PollAnswer-checkbox checkbox\">\n            <input onchange={this.changeVote.bind(this, opt)} type=\"checkbox\" checked={voted} disabled={isDisabled} />\n            <span className=\"checkmark\" />\n          </label>\n        )}\n\n        <div className=\"PollAnswer-text\">\n          <span className=\"PollAnswer-text-answer\">{opt.answer()}</span>\n          {voted && !showCheckmark && icon('fas fa-check-circle', { className: 'PollAnswer-check' })}\n          {canSeeVoteCount && <span className={classList('PollPercent', percent !== 100 && 'PollPercent--option')}>{percent}%</span>}\n        </div>\n\n        {opt.imageUrl() ? <img className=\"PollAnswer-image\" src={opt.imageUrl()} alt={opt.answer()} /> : null}\n      </div>\n    );\n\n    return (\n      <div\n        className={classList('PollOption', hasVoted && 'PollVoted', poll.hasEnded() && 'PollEnded', opt.imageUrl() && 'PollOption-hasImage')}\n        data-id={opt.id()}\n      >\n        {canSeeVoteCount ? (\n          <Tooltip text={app.translator.trans('fof-polls.forum.tooltip.votes', { count: votes })} onremove={this.hideOptionTooltip}>\n            {bar}\n          </Tooltip>\n        ) : (\n          bar\n        )}\n      </div>\n    );\n  }\n\n  changeVote(option, evt) {\n    if (!app.session.user) {\n      app.modal.show(LogInModal);\n      evt.target.checked = false;\n      return;\n    }\n\n    const optionIds = this.pendingOptions || new Set(this.attrs.poll.myVotes().map?.((v) => v.option().id()));\n    const isUnvoting = optionIds.delete(option.id());\n    const allowsMultiple = this.attrs.poll.allowMultipleVotes();\n\n    if (!allowsMultiple) {\n      optionIds.clear();\n    }\n\n    if (!isUnvoting) {\n      optionIds.add(option.id());\n    }\n\n    if (this.useSubmitUI) {\n      this.pendingOptions = optionIds.size ? optionIds : null;\n      this.pendingSubmit = !!this.pendingOptions;\n      return;\n    }\n\n    return this.submit(optionIds, null, () => (evt.target.checked = isUnvoting));\n  }\n\n  onsubmit() {\n    return this.submit(this.pendingOptions, () => {\n      this.pendingOptions = null;\n      this.pendingSubmit = false;\n    });\n  }\n\n  submit(optionIds, cb, onerror) {\n    this.loadingOptions = true;\n    m.redraw();\n\n    return app\n      .request({\n        method: 'PATCH',\n        url: `${app.forum.attribute('apiUrl')}/fof/polls/${this.attrs.poll.id()}/votes`,\n        body: {\n          data: {\n            optionIds: Array.from(optionIds),\n          },\n        },\n      })\n      .then((res) => {\n        app.store.pushPayload(res);\n        cb?.();\n      })\n      .catch((err) => {\n        onerror?.(err);\n      })\n      .finally(() => {\n        this.loadingOptions = false;\n\n        m.redraw();\n      });\n  }\n\n  showVoters() {\n    // Load all the votes only when opening the votes list\n    app.modal.show(ListVotersModal, {\n      poll: this.attrs.poll,\n      post: this.attrs.post,\n    });\n  }\n\n  deletePoll() {\n    if (confirm(app.translator.trans('fof-polls.forum.moderation.delete_confirm'))) {\n      this.attrs.poll.delete().then(() => {\n        m.redraw.sync();\n      });\n    }\n  }\n\n  /**\n   * Attempting to use the `tooltipVisible` attr on the Tooltip component set to 'false' when no vote count\n   * caused the tooltip to break on click. This is a workaround to hide the tooltip when no vote count is available,\n   * called on 'onremove' of the Tooltip component. It doesn't always work as intended either, but it does the job.\n   */\n  hideOptionTooltip(vnode) {\n    vnode.attrs.tooltipVisible = false;\n    vnode.state.updateVisibility();\n  }\n\n  /**\n   * Alert before navigating away using browser's 'beforeunload' event\n   */\n  preventClose(e) {\n    if (this.pendingOptions) {\n      e.preventDefault();\n      return true;\n    }\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/PostControls'];","import CreatePollModal from './CreatePollModal';\nimport PostPoll from './PostPoll';\nimport EditPollModal from './EditPollModal';\nimport ListVotersModal from './ListVotersModal';\n\nexport const components = {\n  CreatePollModal,\n  PostPoll,\n  EditPollModal,\n  ListVotersModal,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\n\nexport default class Poll extends Model {\n  question = Model.attribute('question');\n  hasEnded = Model.attribute('hasEnded');\n  endDate = Model.attribute('endDate');\n\n  publicPoll = Model.attribute('publicPoll');\n  hideVotes = Model.attribute('hideVotes');\n  allowChangeVote = Model.attribute('allowChangeVote');\n  allowMultipleVotes = Model.attribute('allowMultipleVotes');\n  maxVotes = Model.attribute('maxVotes');\n\n  voteCount = Model.attribute('voteCount');\n\n  canVote = Model.attribute('canVote');\n  canEdit = Model.attribute('canEdit');\n  canDelete = Model.attribute('canDelete');\n  canSeeVoters = Model.attribute('canSeeVoters');\n  canChangeVote = Model.attribute('canChangeVote');\n\n  options = Model.hasMany('options');\n  votes = Model.hasMany('votes');\n  myVotes = Model.hasMany('myVotes');\n\n  apiEndpoint() {\n    return `/fof/polls${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\n\nexport default class PollOption extends Model {\n  answer = Model.attribute('answer');\n  imageUrl = Model.attribute('imageUrl');\n  voteCount = Model.attribute('voteCount');\n\n  poll = Model.hasOne('polls');\n  votes = Model.hasMany('votes');\n\n  apiEndpoint() {\n    return `/fof/polls/answers${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\n\nexport default class PollVote extends Model {\n  poll = Model.hasOne('poll');\n  option = Model.hasOne('option');\n  user = Model.hasOne('user');\n\n  pollId = Model.attribute('pollId');\n  optionId = Model.attribute('optionId');\n\n  apiEndpoint() {\n    return `/fof/polls/${this.pollId()}/vote`;\n  }\n}\n","import Poll from './Poll';\nimport PollOption from './PollOption';\nimport PollVote from './PollVote';\n\nexport const models = {\n  Poll,\n  PollOption,\n  PollVote,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Forum'];","import Extend from 'flarum/common/extenders';\nimport Post from 'flarum/common/models/Post';\nimport Forum from 'flarum/common/models/Forum';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Poll from './models/Poll';\nimport PollOption from './models/PollOption';\nimport PollVote from './models/PollVote';\n\nexport default [\n  new Extend.Store().add('polls', Poll).add('poll_options', PollOption).add('poll_votes', PollVote),\n\n  new Extend.Model(Post).hasMany('polls').attribute('canStartPoll'),\n\n  new Extend.Model(Forum).attribute('canStartPolls'),\n\n  new Extend.Model(Discussion).attribute('hasPoll').attribute('canStartPoll'),\n];\n","import app from 'flarum/forum/app';\n\nimport addDiscussionBadge from './addDiscussionBadge';\nimport addComposerItems from './addComposerItems';\nimport addPollsToPost from './addPollsToPost';\nimport addPostControls from './addPostControls';\n\nexport * from './components';\nexport * from './models';\n\napp.initializers.add('fof/polls', () => {\n  addDiscussionBadge();\n  addComposerItems();\n  addPollsToPost();\n  addPostControls();\n});\n\nexport { default as extend } from './extend';\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport PostControls from 'flarum/forum/utils/PostControls';\nimport CreatePollModal from './components/CreatePollModal';\nimport Button from 'flarum/common/components/Button';\n\nexport default () => {\n  const createPoll = (post) =>\n    app.modal.show(CreatePollModal, {\n      onsubmit: (data) =>\n        app.store\n          .createRecord('polls')\n          .save(\n            {\n              ...data,\n              relationships: {\n                post,\n              },\n            },\n            {\n              data: {\n                include: 'options,myVotes,myVotes.option',\n              },\n            }\n          )\n          .then((poll) => {\n            post.rawRelationship('polls')?.push?.({ type: 'polls', id: poll.id() });\n\n            return poll;\n          }),\n    });\n\n  extend(PostControls, 'moderationControls', function (items, post) {\n    if (!post.isHidden() && post.canStartPoll()) {\n      items.add(\n        'addPoll',\n        <Button icon=\"fas fa-poll\" onclick={createPoll.bind(this, post)}>\n          {app.translator.trans('fof-polls.forum.moderation.add')}\n        </Button>\n      );\n    }\n  });\n};\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport PostPoll from './components/PostPoll';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\n\nexport default () => {\n  extend(CommentPost.prototype, 'content', function (content) {\n    const post = this.attrs.post;\n\n    if ((!post.isHidden() || this.revealContent) && post.polls()) {\n      for (const poll of post.polls()) {\n        if (poll) {\n          content.push(<PostPoll post={post} poll={poll} />);\n        }\n      }\n    }\n  });\n\n  extend(CommentPost.prototype, 'oninit', function () {\n    this.subtree.check(() => {\n      const polls = this.attrs.post.polls();\n\n      const checks = polls?.map?.(\n        (poll) =>\n          poll && [\n            poll.data?.attributes,\n            poll.options().map?.((option) => option?.data?.attributes),\n            poll.myVotes().map?.((vote) => vote.option()?.id()),\n          ]\n      );\n\n      return JSON.stringify(checks);\n    });\n  });\n\n  extend(DiscussionPage.prototype, 'oncreate', function () {\n    if (app.pusher) {\n      app.pusher.then((binding) => {\n        // We will listen for updates to all polls and options\n        // Even if that model is not in the current discussion, it doesn't really matter\n        binding.channels.main.bind('updatedPollOptions', (data) => {\n          const poll = app.store.getById('polls', data['pollId']);\n\n          if (poll) {\n            poll.pushAttributes({\n              voteCount: data['pollVoteCount'],\n            });\n\n            // Not redrawing here, as the option below should trigger the redraw already\n          }\n\n          const changedOptions = data['options'];\n\n          for (const optionId in changedOptions) {\n            const option = app.store.getById('poll_options', optionId);\n\n            if (option && option.voteCount() !== undefined) {\n              option.pushAttributes({\n                voteCount: changedOptions[optionId],\n              });\n            }\n          }\n\n          m.redraw();\n        });\n      });\n    }\n  });\n\n  extend(DiscussionPage.prototype, 'onremove', function () {\n    if (app.pusher) {\n      app.pusher.then((binding) => {\n        binding.channels.main.unbind('updatedPollOptions');\n      });\n    }\n  });\n};\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","CreatePollModal","oninit","vnode","this","options","Stream","optionImageUrls","question","endDate","publicPoll","hideVotes","allowChangeVote","allowMultipleVotes","maxVotes","datepickerMinDate","formatDate","undefined","poll","attrs","Array","isArray","forEach","option","push","answer","imageUrl","dayjs","isAfter","title","app","trans","className","content","fields","toArray","items","ItemList","add","type","name","bidi","Button","icon","onclick","addOption","displayOptions","min","max","class","isBefore","time","fromNow","Switch","state","onchange","disabled","length","loading","keys","map","el","i","placeholder","attribute","removeOption","Math","alert","extractText","splice","data","dateToTimestamp","index","onsubmit","e","preventDefault","promise","Promise","then","hide","err","console","error","onerror","loaded","close","date","def","dayjsDate","isValid","format","Modal","addToComposer","composer","addPoll","show","extend","discussion","body","canStartPoll","canStartPolls","classList","ListVotersModal","find","id","include","m","redraw","optionContent","opt","votes","filter","v","voteContent","vote","user","href","avatar","username","EditPollModal","optionAnswers","createRecord","attributes","save","PostPoll","loadingOptions","useSubmitUI","canChangeVote","pendingSubmit","pendingOptions","oncreate","preventClose","window","addEventListener","onremove","removeEventListener","view","infoItems","canSeeVoters","text","showVoters","canEdit","canDelete","deletePoll","viewOption","isEmpty","hasVoted","myVotes","canVote","hasEnded","totalVotes","voteCount","voted","has","some","percent","round","canSeeVoteCount","isDisabled","width","Number","showCheckmark","bar","style","changeVote","checked","src","alt","count","hideOptionTooltip","evt","LogInModal","target","optionIds","Set","isUnvoting","clear","size","submit","cb","method","url","from","res","pushPayload","post","confirm","sync","tooltipVisible","updateVisibility","Component","_extends","assign","arguments","source","apply","components","Poll","Model","apiEndpoint","exists","PollOption","PollVote","pollId","optionId","models","Extend","Post","hasMany","Forum","Discussion","createPoll","DiscussionList","params","badges","hasPoll","Badge","label","DiscussionComposer","ReplyComposer","CommentPost","isHidden","revealContent","polls","subtree","check","checks","JSON","stringify","DiscussionPage","binding","channels","main","getById","pushAttributes","changedOptions","unbind","relationships","rawRelationship","PostControls"],"sourceRoot":""}